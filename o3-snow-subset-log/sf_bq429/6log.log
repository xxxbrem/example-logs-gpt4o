2025-05-07 02:19:53 - Thread-239 (execute) - INFO - [Exploration]
```sql
--Description: Preview ZIP-code–level median income and employment counts for the 2015 ACS 5-Year estimates
SELECT *
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR"
LIMIT 20;
```

```sql
--Description: Preview ZIP-code–level median income and employment counts for the 2018 ACS 5-Year estimates
SELECT *
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR"
LIMIT 20;
```

```sql
--Description: Preview ZIP-code–level employment by industry and median income for the 2017 ACS 5-Year estimates
SELECT *
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR"
LIMIT 20;
```

```sql
--Description: Check whether the 2017 ZIP-code table contains an explicit state identifier
SELECT DISTINCT "state"
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR"
LIMIT 20;
```

```sql
--Description: Check whether a postal-code / state abbreviation column exists in the 2015 ZIP-code table
SELECT DISTINCT "postal_code"
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR"
LIMIT 20;
```

```sql
--Description: Compute the median-income difference (2018 – 2015) for each ZIP code where both years are present
SELECT
    z15."geo_id",
    z15."state",
    z15."median_income" AS "median_income_2015",
    z18."median_income" AS "median_income_2018",
    z18."median_income" - z15."median_income" AS "income_diff"
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR"  z15
JOIN "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR"  z18
      ON z15."geo_id" = z18."geo_id"
LIMIT 20;
```

```sql
--Description: Calculate the weighted number of vulnerable employees for every ZIP code in 2017
SELECT
    z17."geo_id",
    z17."state",
    z17."employed_wholesale_trade" * 0.38423645320197042 +
    z17."employed_construction"    * 0.48071410777129553 +
    z17."employed_arts_entertainment_recreation_accommodation_food" * 0.89455676291236841 +
    z17."employed_information"     * 0.31315240083507306 +
    z17."employed_retail_trade"    * 0.51 AS "vulnerable_employees_2017"
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR" z17
LIMIT 20;
```

```sql
--Description: Aggregate ZIP-level income differences to an average by state (largest 20 shown)
WITH income_diff AS (
    SELECT
        z15."state",
        z18."median_income" - z15."median_income" AS "income_diff"
    FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR" z15
    JOIN "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR" z18
          ON z15."geo_id" = z18."geo_id"
    WHERE z15."state" IS NOT NULL
)
SELECT
    "state",
    AVG("income_diff") AS "avg_income_diff_2015_2018"
FROM income_diff
GROUP BY "state"
ORDER BY "avg_income_diff_2015_2018" DESC
LIMIT 20;
```

```sql
--Description: Aggregate weighted vulnerable employees to an average by state (largest 20 shown)
WITH vuln AS (
    SELECT
        "state",
        "employed_wholesale_trade" * 0.38423645320197042 +
        "employed_construction"    * 0.48071410777129553 +
        "employed_arts_entertainment_recreation_accommodation_food" * 0.89455676291236841 +
        "employed_information"     * 0.31315240083507306 +
        "employed_retail_trade"    * 0.51 AS "vulnerable_employees"
    FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR"
    WHERE "state" IS NOT NULL
)
SELECT
    "state",
    AVG("vulnerable_employees") AS "avg_vulnerable_employees_2017"
FROM vuln
GROUP BY "state"
ORDER BY "avg_vulnerable_employees_2017" DESC
LIMIT 20;
```

```sql
--Description: Combine average income change (2015–2018) with average vulnerable employees (2017) and return the top five states with the greatest income gains
WITH income_diff AS (
    SELECT
        z15."state",
        z18."median_income" - z15."median_income" AS "income_diff"
    FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR" z15
    JOIN "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR" z18
          ON z15."geo_id" = z18."geo_id"
    WHERE z15."state" IS NOT NULL
),
state_income AS (
    SELECT
        "state",
        AVG("income_diff") AS "avg_income_diff_2015_2018"
    FROM income_diff
    GROUP BY "state"
),
state_vuln AS (
    SELECT
        "state",
        AVG(
            "employed_wholesale_trade" * 0.38423645320197042 +
            "employed_construction"    * 0.48071410777129553 +
            "employed_arts_entertainment_recreation_accommodation_food" * 0.89455676291236841 +
            "employed_information"     * 0.31315240083507306 +
            "employed_retail_trade"    * 0.51
        ) AS "avg_vulnerable_employees_2017"
    FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR"
    WHERE "state" IS NOT NULL
    GROUP BY "state"
)
SELECT
    i."state",
    i."avg_income_diff_2015_2018",
    v."avg_vulnerable_employees_2017"
FROM state_income i
JOIN state_vuln  v ON i."state" = v."state"
ORDER BY i."avg_income_diff_2015_2018" DESC
LIMIT 5;
```
[Exploration]
2025-05-07 02:19:53 - Thread-239 (execute) - INFO - [Try to execute]
--Description: Preview ZIP-code–level median income and employment counts for the 2015 ACS 5-Year estimates
SELECT *
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR"
LIMIT 20;
[Try to execute]
2025-05-07 02:19:55 - Thread-239 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: Preview ZIP-code–level median income and employment counts for the 2015 ACS 5-Year estimates
SELECT *
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR"
LIMIT 20;
Results:
geo_id,nonfamily_households,family_households,median_year_structure_built,rent_burden_not_computed,rent_over_50_percent,rent_40_to_50_percent,rent_35_to_40_percent,rent_30_to_35_percent,rent_25_to_30_percent,rent_20_to_25_percent,rent_15_to_20_percent,rent_10_to_15_percent,rent_under_10_percent,total_pop,male_pop,female_pop,median_age,white_pop,black_pop,asian_pop,hispanic_pop,amerindian_pop,other_race_pop,two_or_more_races_pop,not_hispanic_pop,commuters_by_public_transportation,households,media

[Successfully executed]
2025-05-07 02:19:55 - Thread-239 (execute) - INFO - [Try to execute]
--Description: Preview ZIP-code–level median income and employment counts for the 2018 ACS 5-Year estimates
SELECT *
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR"
LIMIT 20;
[Try to execute]
2025-05-07 02:19:56 - Thread-239 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: Preview ZIP-code–level median income and employment counts for the 2018 ACS 5-Year estimates
SELECT *
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR"
LIMIT 20;
Results:
geo_id,do_date,total_pop,households,male_pop,female_pop,median_age,male_under_5,male_5_to_9,male_10_to_14,male_15_to_17,male_18_to_19,male_20,male_21,male_22_to_24,male_25_to_29,male_30_to_34,male_35_to_39,male_40_to_44,male_45_to_49,male_50_to_54,male_55_to_59,male_65_to_66,male_67_to_69,male_70_to_74,male_75_to_79,male_80_to_84,male_85_and_over,female_under_5,female_5_to_9,female_10_to_14,female_15_to_17,female_18_to_19,female_20,female_21,female_22_to_24,female_25_to_29,female_30_to_34,female

[Successfully executed]
2025-05-07 02:19:56 - Thread-239 (execute) - INFO - [Try to execute]
--Description: Preview ZIP-code–level employment by industry and median income for the 2017 ACS 5-Year estimates
SELECT *
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR"
LIMIT 20;
[Try to execute]
2025-05-07 02:19:57 - Thread-239 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: Preview ZIP-code–level employment by industry and median income for the 2017 ACS 5-Year estimates
SELECT *
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR"
LIMIT 20;
Results:
geo_id,nonfamily_households,family_households,median_year_structure_built,rent_burden_not_computed,rent_over_50_percent,rent_40_to_50_percent,rent_35_to_40_percent,rent_30_to_35_percent,rent_25_to_30_percent,rent_20_to_25_percent,rent_15_to_20_percent,rent_10_to_15_percent,rent_under_10_percent,total_pop,male_pop,female_pop,median_age,white_pop,black_pop,asian_pop,hispanic_pop,amerindian_pop,other_race_pop,two_or_more_races_pop,not_hispanic_pop,commuters_by_public_transportation,households,media

[Successfully executed]
2025-05-07 02:19:57 - Thread-239 (execute) - INFO - [Try to execute]
--Description: Check whether the 2017 ZIP-code table contains an explicit state identifier
SELECT DISTINCT "state"
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR"
LIMIT 20;
[Try to execute]
2025-05-07 02:19:57 - Thread-239 (execute) - INFO - [Error occurred]
{'status': 'error', 'error_msg': '##ERROR##000904 (42000): SQL compilation error: error line 1 at position 16\ninvalid identifier \'"state"\''}
[Error occurred]
2025-05-07 02:24:23 - Thread-239 (execute) - INFO - [Corrected SQL]
```sql
--Description:  To find the states with the largest average ZIP-code-level median-income 
--change (2015→2018) and their corresponding average number of vulnerable employees (2017):
--  1.  Join ZIP_CODES_2015_5YR and ZIP_CODES_2018_5YR on the common "geo_id" to get the 
--      income difference per ZIP code.  Derive a 2-digit ZIP prefix from "geo_id", map it 
--      to the true state via CYCLISTIC.STATE_FIPS (LPAD-matching on FIPS code), then take 
--      the state-level average income change.
--  2.  In the 2017 ZIP table, calculate the vulnerability-weighted employment for each ZIP 
--      code (using the five given weights), map ZIP prefixes to states the same way, and 
--      obtain the state-level average vulnerable-employee count.
--  3.  Combine the two state aggregates and return the five states with the greatest
--      average income increase.
WITH income_diff AS (          -- step 1
    SELECT
        sf."state",
        (z18."median_income"::FLOAT - z15."median_income"::FLOAT) AS income_delta
    FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR"  z15
    JOIN "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR"  z18
          ON z15."geo_id" = z18."geo_id"
    JOIN "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
          ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z15."geo_id", 1, 2)
    WHERE z15."median_income" IS NOT NULL
      AND z18."median_income" IS NOT NULL
),
state_income AS (
    SELECT
        "state",
        AVG(income_delta) AS avg_income_delta
    FROM income_diff
    GROUP BY "state"
),                               -- step 2
state_vuln AS (
    SELECT
        sf."state",
        AVG(
            COALESCE(z17."employed_wholesale_trade", 0) * 0.38423645320197042 +
            COALESCE(z17."employed_construction", 0)    * 0.48071410777129553 +
            COALESCE(z17."employed_arts_entertainment_recreation_accommodation_food", 0)
                                                     * 0.89455676291236841 +
            COALESCE(z17."employed_information", 0)     * 0.31315240083507306 +
            COALESCE(z17."employed_retail_trade", 0)    * 0.51
        ) AS avg_vulnerable_employees_2017
    FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR" z17
    JOIN "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
          ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z17."geo_id", 1, 2)
    GROUP BY sf."state"
)                               -- step 3
SELECT
    i."state",
    i.avg_income_delta,
    v.avg_vulnerable_employees_2017
FROM state_income i
JOIN state_vuln   v ON i."state" = v."state"
ORDER BY i.avg_income_delta DESC
LIMIT 5;
```
[Corrected SQL]
2025-05-07 02:25:00 - Thread-239 (execute) - INFO - [Results for corrected sql]
state,AVG_INCOME_DELTA,AVG_VULNERABLE_EMPLOYEES_2017
Alaska,10241.975694444445,1389.6315630148472
Delaware,9507.951923076924,1831.5372550555835
Louisiana,9055.584905660377,1014.5205260097938
Kansas,7886.549295774648,1340.8264802778347
Alabama,7522.180272108843,950.3457820720455

[Results for corrected sql]
2025-05-07 02:28:21 - Thread-239 (execute) - INFO - [Corrected other sqls]
```sql
--Description: Preview whether a “postal_code” field exists in the 2015 ZIP table by simply
--returning the first 20 ZIP codes (geo_id) and their two-digit prefixes (possible FIPS);
--no “postal_code” column is referenced to avoid compilation errors.
SELECT 
       "geo_id",
       SUBSTR("geo_id", 1, 2) AS "zip_prefix"
FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR"
LIMIT 20;
```

```sql
--Description: Compute the median-income difference (2018 – 2015) for each ZIP code that
--appears in both years; do not reference a nonexistent “state” column.
SELECT
       z15."geo_id",
       z15."median_income"::FLOAT AS "median_income_2015",
       z18."median_income"::FLOAT AS "median_income_2018",
       (z18."median_income"::FLOAT - z15."median_income"::FLOAT) AS "income_diff"
FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR" z15
JOIN   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR" z18
       ON z15."geo_id" = z18."geo_id"
LIMIT 20;
```

```sql
--Description: Calculate the weighted number of vulnerable employees for every ZIP code in
--2017; the table lacks a “state” field, so only geo_id and the computed value are returned.
SELECT
       "geo_id",
       COALESCE("employed_wholesale_trade", 0) *
           0.38423645320197042 +
       COALESCE("employed_construction", 0) *
           0.48071410777129553 +
       COALESCE("employed_arts_entertainment_recreation_accommodation_food", 0) *
           0.89455676291236841 +
       COALESCE("employed_information", 0) *
           0.31315240083507306 +
       COALESCE("employed_retail_trade", 0) *
           0.51 AS "vulnerable_employees_2017"
FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR"
LIMIT 20;
```

```sql
--Description: Aggregate ZIP-level income differences to an average by state.  State names
--are recovered by mapping the ZIP’s two-digit prefix to the CYCLISTIC.STATE_FIPS table.
WITH income_deltas AS (
    SELECT
           LPAD(sf."fips"::STRING, 2, '0')                AS "fips_prefix",
           sf."state",
           (z18."median_income"::FLOAT - z15."median_income"::FLOAT) AS "delta"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR" z15
    JOIN   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR" z18
           ON z15."geo_id" = z18."geo_id"
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z15."geo_id", 1, 2)
    WHERE  z15."median_income" IS NOT NULL
       AND z18."median_income" IS NOT NULL
)
SELECT
       "state",
       AVG("delta") AS "avg_income_diff_2015_2018"
FROM   income_deltas
GROUP  BY "state"
ORDER  BY "avg_income_diff_2015_2018" DESC
LIMIT 20;
```

```sql
--Description: Aggregate weighted vulnerable-employee counts (2017) to an average by state,
--again mapping ZIP prefixes to CYCLISTIC.STATE_FIPS to obtain state names.
WITH vuln_zip AS (
    SELECT
           LPAD(sf."fips"::STRING, 2, '0') AS "fips_prefix",
           sf."state",
           COALESCE(z."employed_wholesale_trade", 0) *
               0.38423645320197042 +
           COALESCE(z."employed_construction", 0) *
               0.48071410777129553 +
           COALESCE(z."employed_arts_entertainment_recreation_accommodation_food", 0) *
               0.89455676291236841 +
           COALESCE(z."employed_information", 0) *
               0.31315240083507306 +
           COALESCE(z."employed_retail_trade", 0) *
               0.51 AS "vuln_emp"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR" z
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z."geo_id", 1, 2)
)
SELECT
       "state",
       AVG("vuln_emp") AS "avg_vulnerable_employees_2017"
FROM   vuln_zip
GROUP  BY "state"
ORDER  BY "avg_vulnerable_employees_2017" DESC
LIMIT 20;
```

```sql
--Description: Combine the state-level average income change (2015–2018) with the
--state-level average number of vulnerable employees (2017) and list the five states
--with the greatest income increases.
WITH income_deltas AS (
    SELECT
           sf."state",
           (z18."median_income"::FLOAT - z15."median_income"::FLOAT) AS "delta"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR" z15
    JOIN   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR" z18
           ON z15."geo_id" = z18."geo_id"
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z15."geo_id", 1, 2)
    WHERE  z15."median_income" IS NOT NULL
       AND z18."median_income" IS NOT NULL
),
state_income AS (
    SELECT  "state", AVG("delta") AS "avg_income_diff_2015_2018"
    FROM    income_deltas
    GROUP   BY "state"
),
state_vuln AS (
    SELECT
           sf."state",
           AVG(
               COALESCE(z."employed_wholesale_trade", 0) * 0.38423645320197042 +
               COALESCE(z."employed_construction", 0)    * 0.48071410777129553 +
               COALESCE(z."employed_arts_entertainment_recreation_accommodation_food", 0)
                                                     * 0.89455676291236841 +
               COALESCE(z."employed_information", 0)     * 0.31315240083507306 +
               COALESCE(z."employed_retail_trade", 0)    * 0.51
           ) AS "avg_vulnerable_employees_2017"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR" z
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z."geo_id", 1, 2)
    GROUP  BY sf."state"
)
SELECT
       i."state",
       i."avg_income_diff_2015_2018",
       v."avg_vulnerable_employees_2017"
FROM   state_income i
JOIN   state_vuln   v ON i."state" = v."state"
ORDER  BY i."avg_income_diff_2015_2018" DESC
LIMIT 5;
```
[Corrected other sqls]
2025-05-07 02:28:21 - Thread-239 (execute) - INFO - [Successfully corrected]
Successfully corrected. SQL:
--Description:  To find the states with the largest average ZIP-code-level median-income 
--change (2015→2018) and their corresponding average number of vulnerable employees (2017):
--  1.  Join ZIP_CODES_2015_5YR and ZIP_CODES_2018_5YR on the common "geo_id" to get the 
--      income difference per ZIP code.  Derive a 2-digit ZIP prefix from "geo_id", map it 
--      to the true state via CYCLISTIC.STATE_FIPS (LPAD-matching on FIPS code), then take 
--      the state-level average income change.
--  2.  In the 2017 ZIP table, calculate the vulnerability-weighted employment for each ZIP 
--      code (using the five given weights), map ZIP prefixes to states the same way, and 
--      obtain the state-level average vulnerable-employee count.
--  3.  Combine the two state aggregates and return the five states with the greatest
--      average income increase.
WITH income_diff AS (          -- step 1
    SELECT
        sf."state",
        (z18."median_income"::FLOAT - z15."median_income"::FLOAT) AS income_delta
    FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR"  z15
    JOIN "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR"  z18
          ON z15."geo_id" = z18."geo_id"
    JOIN "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
          ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z15."geo_id", 1, 2)
    WHERE z15."median_income" IS NOT NULL
      AND z18."median_income" IS NOT NULL
),
state_income AS (
    SELECT
        "state",
        AVG(income_delta) AS avg_income_delta
    FROM income_diff
    GROUP BY "state"
),                               -- step 2
state_vuln AS (
    SELECT
        sf."state",
        AVG(
            COALESCE(z17."employed_wholesale_trade", 0) * 0.38423645320197042 +
            COALESCE(z17."employed_construction", 0)    * 0.48071410777129553 +
            COALESCE(z17."employed_arts_entertainment_recreation_accommodation_food", 0)
                                                     * 0.89455676291236841 +
            COALESCE(z17."employed_information", 0)     * 0.31315240083507306 +
            COALESCE(z17."employed_retail_trade", 0)    * 0.51
        ) AS avg_vulnerable_employees_2017
    FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR" z17
    JOIN "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
          ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z17."geo_id", 1, 2)
    GROUP BY sf."state"
)                               -- step 3
SELECT
    i."state",
    i.avg_income_delta,
    v.avg_vulnerable_employees_2017
FROM state_income i
JOIN state_vuln   v ON i."state" = v."state"
ORDER BY i.avg_income_delta DESC
LIMIT 5;
Results:
state,AVG_INCOME_DELTA,AVG_VULNERABLE_EMPLOYEES_2017
Alaska,10241.975694444445,1389.6315630148472
Delaware,9507.951923076924,1831.5372550555835
Louisiana,9055.584905660377,1014.5205260097938
Kansas,7886.549295774648,1340.8264802778347
Alabama,7522.180272108843,950.3457820720455

[Successfully corrected]
2025-05-07 02:28:21 - Thread-239 (execute) - INFO - [Try to execute]
--Description: Preview whether a “postal_code” field exists in the 2015 ZIP table by simply
--returning the first 20 ZIP codes (geo_id) and their two-digit prefixes (possible FIPS);
--no “postal_code” column is referenced to avoid compilation errors.
SELECT 
       "geo_id",
       SUBSTR("geo_id", 1, 2) AS "zip_prefix"
FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR"
LIMIT 20
[Try to execute]
2025-05-07 02:28:24 - Thread-239 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: Preview whether a “postal_code” field exists in the 2015 ZIP table by simply
--returning the first 20 ZIP codes (geo_id) and their two-digit prefixes (possible FIPS);
--no “postal_code” column is referenced to avoid compilation errors.
SELECT 
       "geo_id",
       SUBSTR("geo_id", 1, 2) AS "zip_prefix"
FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR"
LIMIT 20
Results:
geo_id,zip_prefix
98304,98
22714,22
69128,69
97908,97
37228,37
97486,97
04491,04
11005,11
04936,04
12195,12
63102,63
06793,06
44669,44
96109,96
15638,15
36263,36
16853,16
08352,08
72536,72
59926,59

[Successfully executed]
2025-05-07 02:28:24 - Thread-239 (execute) - INFO - [Try to execute]
--Description: Compute the median-income difference (2018 – 2015) for each ZIP code that
--appears in both years; do not reference a nonexistent “state” column.
SELECT
       z15."geo_id",
       z15."median_income"::FLOAT AS "median_income_2015",
       z18."median_income"::FLOAT AS "median_income_2018",
       (z18."median_income"::FLOAT - z15."median_income"::FLOAT) AS "income_diff"
FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR" z15
JOIN   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR" z18
       ON z15."geo_id" = z18."geo_id"
LIMIT 20
[Try to execute]
2025-05-07 02:30:43 - Thread-239 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: Compute the median-income difference (2018 – 2015) for each ZIP code that
--appears in both years; do not reference a nonexistent “state” column.
SELECT
       z15."geo_id",
       z15."median_income"::FLOAT AS "median_income_2015",
       z18."median_income"::FLOAT AS "median_income_2018",
       (z18."median_income"::FLOAT - z15."median_income"::FLOAT) AS "income_diff"
FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR" z15
JOIN   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR" z18
       ON z15."geo_id" = z18."geo_id"
LIMIT 20
Results:
geo_id,median_income_2015,median_income_2018,income_diff
98304,36746.0,37759.0,1013.0
22714,74625.0,92917.0,18292.0
69128,56471.0,38125.0,-18346.0
97908,22321.0,23750.0,1429.0
37228,15540.0,29119.0,13579.0
97486,62083.0,53393.0,-8690.0
04491,27500.0,37500.0,10000.0
11005,58894.0,62993.0,4099.0
04936,40469.0,,
12195,,35625.0,
63102,39855.0,55053.0,15198.0
06793,81711.0,99861.0,18150.0
44669,67981.0,55313.0,-12668.0
96109,29958.0,42202.0,12244.0
15638,51304.0,44667.0,-6637.0

[Successfully executed]
2025-05-07 02:30:43 - Thread-239 (execute) - INFO - [Try to execute]
--Description: Calculate the weighted number of vulnerable employees for every ZIP code in
--2017; the table lacks a “state” field, so only geo_id and the computed value are returned.
SELECT
       "geo_id",
       COALESCE("employed_wholesale_trade", 0) *
           0.38423645320197042 +
       COALESCE("employed_construction", 0) *
           0.48071410777129553 +
       COALESCE("employed_arts_entertainment_recreation_accommodation_food", 0) *
           0.89455676291236841 +
       COALESCE("employed_information", 0) *
           0.31315240083507306 +
       COALESCE("employed_retail_trade", 0) *
           0.51 AS "vulnerable_employees_2017"
FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR"
LIMIT 20
[Try to execute]
2025-05-07 02:30:44 - Thread-239 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: Calculate the weighted number of vulnerable employees for every ZIP code in
--2017; the table lacks a “state” field, so only geo_id and the computed value are returned.
SELECT
       "geo_id",
       COALESCE("employed_wholesale_trade", 0) *
           0.38423645320197042 +
       COALESCE("employed_construction", 0) *
           0.48071410777129553 +
       COALESCE("employed_arts_entertainment_recreation_accommodation_food", 0) *
           0.89455676291236841 +
       COALESCE("employed_information", 0) *
           0.31315240083507306 +
       COALESCE("employed_retail_trade", 0) *
           0.51 AS "vulnerable_employees_2017"
FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR"
LIMIT 20
Results:
geo_id,vulnerable_employees_2017
14521,194.26996984282385
43942,113.9395984484031
56097,265.6251111405002
14837,410.81500174453197
35218,425.16607130239015
12721,677.8945229428296
80924,436.26812955337164
85607,791.3528440863986
40210,926.3829464803935
46040,878.1674582724338
70525,881.8014158525334
29582,2273.0158460090074
32534,1328.8433115700848
01569,1193.7781146418592
41001,1491.1253017337822
14217,2133.313247650402
48040,799.9760055429774
77836,810.5155001214457

[Successfully executed]
2025-05-07 02:30:44 - Thread-239 (execute) - INFO - [Try to execute]
--Description: Aggregate ZIP-level income differences to an average by state.  State names
--are recovered by mapping the ZIP’s two-digit prefix to the CYCLISTIC.STATE_FIPS table.
WITH income_deltas AS (
    SELECT
           LPAD(sf."fips"::STRING, 2, '0')                AS "fips_prefix",
           sf."state",
           (z18."median_income"::FLOAT - z15."median_income"::FLOAT) AS "delta"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR" z15
    JOIN   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR" z18
           ON z15."geo_id" = z18."geo_id"
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z15."geo_id", 1, 2)
    WHERE  z15."median_income" IS NOT NULL
       AND z18."median_income" IS NOT NULL
)
SELECT
       "state",
       AVG("delta") AS "avg_income_diff_2015_2018"
FROM   income_deltas
GROUP  BY "state"
ORDER  BY "avg_income_diff_2015_2018" DESC
LIMIT 20
[Try to execute]
2025-05-07 02:31:55 - Thread-239 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: Aggregate ZIP-level income differences to an average by state.  State names
--are recovered by mapping the ZIP’s two-digit prefix to the CYCLISTIC.STATE_FIPS table.
WITH income_deltas AS (
    SELECT
           LPAD(sf."fips"::STRING, 2, '0')                AS "fips_prefix",
           sf."state",
           (z18."median_income"::FLOAT - z15."median_income"::FLOAT) AS "delta"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR" z15
    JOIN   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR" z18
           ON z15."geo_id" = z18."geo_id"
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z15."geo_id", 1, 2)
    WHERE  z15."median_income" IS NOT NULL
       AND z18."median_income" IS NOT NULL
)
SELECT
       "state",
       AVG("delta") AS "avg_income_diff_2015_2018"
FROM   income_deltas
GROUP  BY "state"
ORDER  BY "avg_income_diff_2015_2018" DESC
LIMIT 20
Results:
state,avg_income_diff_2015_2018
Alaska,10241.975694444445
Delaware,9507.951923076924
Louisiana,9055.584905660377
Kansas,7886.549295774648
Alabama,7522.180272108843
Wisconsin,7439.635897435897
Colorado,7429.307692307692
American Samoa,7414.787012987013
California,6897.409961685824
Kentucky,6818.007168458781
Iowa,6313.1021897810215
Washington,6309.990445859873
New Hampshire,6183.737113402062
Montana,6179.283887468031
North Carolina,5894.4049586776855
Indiana,5884.674911660777

[Successfully executed]
2025-05-07 02:31:55 - Thread-239 (execute) - INFO - [Try to execute]
--Description: Aggregate weighted vulnerable-employee counts (2017) to an average by state,
--again mapping ZIP prefixes to CYCLISTIC.STATE_FIPS to obtain state names.
WITH vuln_zip AS (
    SELECT
           LPAD(sf."fips"::STRING, 2, '0') AS "fips_prefix",
           sf."state",
           COALESCE(z."employed_wholesale_trade", 0) *
               0.38423645320197042 +
           COALESCE(z."employed_construction", 0) *
               0.48071410777129553 +
           COALESCE(z."employed_arts_entertainment_recreation_accommodation_food", 0) *
               0.89455676291236841 +
           COALESCE(z."employed_information", 0) *
               0.31315240083507306 +
           COALESCE(z."employed_retail_trade", 0) *
               0.51 AS "vuln_emp"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR" z
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z."geo_id", 1, 2)
)
SELECT
       "state",
       AVG("vuln_emp") AS "avg_vulnerable_employees_2017"
FROM   vuln_zip
GROUP  BY "state"
ORDER  BY "avg_vulnerable_employees_2017" DESC
LIMIT 20
[Try to execute]
2025-05-07 02:31:56 - Thread-239 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: Aggregate weighted vulnerable-employee counts (2017) to an average by state,
--again mapping ZIP prefixes to CYCLISTIC.STATE_FIPS to obtain state names.
WITH vuln_zip AS (
    SELECT
           LPAD(sf."fips"::STRING, 2, '0') AS "fips_prefix",
           sf."state",
           COALESCE(z."employed_wholesale_trade", 0) *
               0.38423645320197042 +
           COALESCE(z."employed_construction", 0) *
               0.48071410777129553 +
           COALESCE(z."employed_arts_entertainment_recreation_accommodation_food", 0) *
               0.89455676291236841 +
           COALESCE(z."employed_information", 0) *
               0.31315240083507306 +
           COALESCE(z."employed_retail_trade", 0) *
               0.51 AS "vuln_emp"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR" z
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z."geo_id", 1, 2)
)
SELECT
       "state",
       AVG("vuln_emp") AS "avg_vulnerable_employees_2017"
FROM   vuln_zip
GROUP  BY "state"
ORDER  BY "avg_vulnerable_employees_2017" DESC
LIMIT 20
Results:
state,avg_vulnerable_employees_2017
New Hampshire,2557.129458753234
American Samoa,2009.4722086309102
New Jersey,1931.7790239678752
Delaware,1831.5372550555835
Montana,1690.5247324636239
Nevada,1688.399973233335
Virgin Islands,1469.7009412901843
Alaska,1389.6315630148472
Iowa,1386.1996594931964
Kansas,1340.8264802778347
Colorado,1223.8984976743168
Minnesota,1136.205379376585
California,1118.0191358471723
North Carolina,1115.333450086069
Texas,1096.5610256983405
Mississippi,1067.8

[Successfully executed]
2025-05-07 02:31:56 - Thread-239 (execute) - INFO - [Try to execute]
--Description: Combine the state-level average income change (2015–2018) with the
--state-level average number of vulnerable employees (2017) and list the five states
--with the greatest income increases.
WITH income_deltas AS (
    SELECT
           sf."state",
           (z18."median_income"::FLOAT - z15."median_income"::FLOAT) AS "delta"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR" z15
    JOIN   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR" z18
           ON z15."geo_id" = z18."geo_id"
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z15."geo_id", 1, 2)
    WHERE  z15."median_income" IS NOT NULL
       AND z18."median_income" IS NOT NULL
),
state_income AS (
    SELECT  "state", AVG("delta") AS "avg_income_diff_2015_2018"
    FROM    income_deltas
    GROUP   BY "state"
),
state_vuln AS (
    SELECT
           sf."state",
           AVG(
               COALESCE(z."employed_wholesale_trade", 0) * 0.38423645320197042 +
               COALESCE(z."employed_construction", 0)    * 0.48071410777129553 +
               COALESCE(z."employed_arts_entertainment_recreation_accommodation_food", 0)
                                                     * 0.89455676291236841 +
               COALESCE(z."employed_information", 0)     * 0.31315240083507306 +
               COALESCE(z."employed_retail_trade", 0)    * 0.51
           ) AS "avg_vulnerable_employees_2017"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR" z
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z."geo_id", 1, 2)
    GROUP  BY sf."state"
)
SELECT
       i."state",
       i."avg_income_diff_2015_2018",
       v."avg_vulnerable_employees_2017"
FROM   state_income i
JOIN   state_vuln   v ON i."state" = v."state"
ORDER  BY i."avg_income_diff_2015_2018" DESC
LIMIT 5
[Try to execute]
2025-05-07 02:33:25 - Thread-239 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: Combine the state-level average income change (2015–2018) with the
--state-level average number of vulnerable employees (2017) and list the five states
--with the greatest income increases.
WITH income_deltas AS (
    SELECT
           sf."state",
           (z18."median_income"::FLOAT - z15."median_income"::FLOAT) AS "delta"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR" z15
    JOIN   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR" z18
           ON z15."geo_id" = z18."geo_id"
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z15."geo_id", 1, 2)
    WHERE  z15."median_income" IS NOT NULL
       AND z18."median_income" IS NOT NULL
),
state_income AS (
    SELECT  "state", AVG("delta") AS "avg_income_diff_2015_2018"
    FROM    income_deltas
    GROUP   BY "state"
),
state_vuln AS (
    SELECT
           sf."state",
           AVG(
               COALESCE(z."employed_wholesale_trade", 0) * 0.38423645320197042 +
               COALESCE(z."employed_construction", 0)    * 0.48071410777129553 +
               COALESCE(z."employed_arts_entertainment_recreation_accommodation_food", 0)
                                                     * 0.89455676291236841 +
               COALESCE(z."employed_information", 0)     * 0.31315240083507306 +
               COALESCE(z."employed_retail_trade", 0)    * 0.51
           ) AS "avg_vulnerable_employees_2017"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR" z
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z."geo_id", 1, 2)
    GROUP  BY sf."state"
)
SELECT
       i."state",
       i."avg_income_diff_2015_2018",
       v."avg_vulnerable_employees_2017"
FROM   state_income i
JOIN   state_vuln   v ON i."state" = v."state"
ORDER  BY i."avg_income_diff_2015_2018" DESC
LIMIT 5
Results:
state,avg_income_diff_2015_2018,avg_vulnerable_employees_2017
Alaska,10241.975694444445,1389.6315630148472
Delaware,9507.951923076924,1831.5372550555835
Louisiana,9055.584905660377,1014.5205260097938
Kansas,7886.549295774648,1340.8264802778347
Alabama,7522.180272108843,950.3457820720455

[Successfully executed]
2025-05-07 02:33:25 - Thread-239 (execute) - INFO - itercount: 0
2025-05-07 02:33:25 - Thread-239 (execute) - INFO - [Self-refine]
Table full name: CENSUS_BUREAU_ACS_2.CENSUS_BUREAU_ACS.BLOCKGROUP_2014_5YR
Column name: unemployed_pop Type: FLOAT
Column name: employed_pop Type: FLOAT Description: Employed Population. The number of civilians 16 years old and over in each geography who either (1) were "at work," that is, those who did any work at all during the reference week as paid employees, worked in their own business or profession, worked on their own farm, or worked 15 hours or more as unpaid workers on a family farm or in a family business; or (2) were "with a job but not at work," that is, those who did not work during the reference week but had jobs or businesses from which they were temporarily absent due to illness, bad weather, industrial dispute, vacation, or other personal reasons. Excluded from the employed are people whose only activity consisted of work around the house or unpaid volunteer work for religious, charitable, and similar organizations; also excluded are all institutionalized people and people on active duty in the United States Armed Forces.
Column name: median_income Type: FLOAT Description: Median Household Income in the past 12 Months. Within a geographic area, the median income received by every household on a regular basis before payments for personal income taxes, social security, union dues, medicare deductions, etc.  It includes income received from wages, salary, commissions, bonuses, and tips; self-employment income from own nonfarm or farm businesses, including proprietorships and partnerships; interest, dividends, net rental income, royalty income, or income from estates and trusts; Social Security or Railroad Retirement income; Supplemental Security Income (SSI); any cash public assistance or welfare payments from the state or local welfare office; retirement, survivor, or disability benefits; and any other sources of income received regularly such as Veterans' (VA) payments, unemployment and/or worker's compensation, child support, and alimony.
Column name: civilian_labor_force Type: FLOAT Description: Population in Civilian Labor Force. The number of civilians 16 years and over in each geography who can be classified as either "employed" or "unemployed" below.
Sample rows:
[{'median_income': 71016.0, 'civilian_labor_force': 411.0, 'employed_pop': 350.0, 'unemployed_pop': 61.0}, {'median_income': 86806.0, 'civilian_labor_force': 662.0, 'employed_pop': 609.0, 'unemployed_pop': 53.0}, {'median_income': 86742.0, 'civilian_labor_force': 790.0, 'employed_pop': 772.0, 'unemployed_pop': 18.0}, {'median_income': 100481.0, 'civilian_labor_force': 950.0, 'employed_pop': 907.0, 'unemployed_pop': 43.0}, {'median_income': 67778.0, 'civilian_labor_force': 823.0, 'employed_pop': 750.0, 'unemployed_pop': 73.0}]

--------------------------------------------------
Table full name: CENSUS_BUREAU_ACS_2.CENSUS_BUREAU_ACS.CBSA_2007_1YR
Column name: employed_arts_entertainment_recreation_accommodation_food Type: FLOAT Description: Workers employed in firms in arts, entertainment, recreation, accommodation and food services. The Arts, Entertainment, and Recreation sector includes a wide range of establishments that operate facilities or provide services to meet varied cultural, entertainment, and recreational interests of their patrons. This sector comprises (1) establishments that are involved in producing, promoting, or participating in live performances, events, or exhibits intended for public viewing; (2) establishments that preserve and exhibit objects and sites of historical, cultural, or educational interest; and (3) establishments that operate facilities or provide services that enable patrons to participate in recreational activities or pursue amusement, hobby, and leisure-time interests.
Column name: employed_construction Type: FLOAT Description: Workers employed in firms in construction. The Construction sector comprises establishments primarily engaged in the construction of buildings or engineering projects (e.g., highways and utility systems). Construction work done may include new work, additions, alterations, or maintenance and repairs.
Column name: employed_information Type: FLOAT Description: Workers employed in firms in information. The Information sector comprises establishments engaged in the following processes: (a) producing and distributing information and cultural products, (b) providing the means to transmit or distribute these products as well as data or communications, and (c) processing data. Included are the publishing industries, the motion picture and sound recording industries; the broadcasting industries, the telecommunications industries; Web search portals, data processing industries, and the information services industries.
Column name: employed_wholesale_trade Type: FLOAT Description: Workers employed in firms in wholesale trade. The Wholesale Trade sector comprises establishments engaged in wholesaling merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The wholesaling process is an intermediate step in the distribution of merchandise. Wholesalers are organized to sell or arrange the purchase or sale of (a) goods for resale (i.e., goods sold to other wholesalers or retailers), (b) capital or durable nonconsumer goods, and (c) raw and intermediate materials and supplies used in production.
Column name: employed_retail_trade Type: FLOAT Description: Workers employed in firms in retail trade. The Retail Trade sector comprises establishments engaged in retailing merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The retailing process is the final step in the distribution of merchandise; retailers are, therefore, organized to sell merchandise in small quantities to the general public.
Column name: median_income Type: FLOAT Description: Median Household Income in the past 12 Months. Within a geographic area, the median income received by every household on a regular basis before payments for personal income taxes, social security, union dues, medicare deductions, etc.  It includes income received from wages, salary, commissions, bonuses, and tips; self-employment income from own nonfarm or farm businesses, including proprietorships and partnerships; interest, dividends, net rental income, royalty income, or income from estates and trusts; Social Security or Railroad Retirement income; Supplemental Security Income (SSI); any cash public assistance or welfare payments from the state or local welfare office; retirement, survivor, or disability benefits; and any other sources of income received regularly such as Veterans' (VA) payments, unemployment and/or worker's compensation, child support, and alimony.
Sample rows:
[{'median_income': 48227.0, 'employed_arts_entertainment_recreation_accommodation_food': 81283.0, 'employed_construction': 48146.0, 'employed_information': 20114.0, 'employed_retail_trade': 108764.0, 'employed_wholesale_trade': 33960.0}, {'median_income': 57294.0, 'employed_arts_entertainment_recreation_accommodation_food': 47664.0, 'employed_construction': 51048.0, 'employed_information': 15814.0, 'employed_retail_trade': 67323.0, 'employed_wholesale_trade': 19438.0}, {'median_income': 52542.0, 'employed_arts_entertainment_recreation_accommodation_food': 185493.0, 'employed_construction': 105256.0, 'employed_information': 43210.0, 'employed_retail_trade': 221535.0, 'employed_wholesale_trade': 59389.0}, {'median_income': 59694.0, 'employed_arts_entertainment_recreation_accommodation_food': 85186.0, 'employed_construction': 87345.0, 'employed_information': 26020.0, 'employed_retail_trade': 115276.0, 'employed_wholesale_trade': 28851.0}, {'median_income': 54824.0, 'employed_arts_entertainment_recreation_accommodation_food': 66007.0, 'employed_construction': 61228.0, 'employed_information': 17187.0, 'employed_retail_trade': 92836.0, 'employed_wholesale_trade': 17573.0}]

--------------------------------------------------
Table full name: CENSUS_BUREAU_ACS_2.CENSUS_BUREAU_ACS.CENSUSTRACT_2011_5YR
Column name: employed_arts_entertainment_recreation_accommodation_food Type: FLOAT Description: Workers employed in firms in arts, entertainment, recreation, accommodation and food services. The Arts, Entertainment, and Recreation sector includes a wide range of establishments that operate facilities or provide services to meet varied cultural, entertainment, and recreational interests of their patrons. This sector comprises (1) establishments that are involved in producing, promoting, or participating in live performances, events, or exhibits intended for public viewing; (2) establishments that preserve and exhibit objects and sites of historical, cultural, or educational interest; and (3) establishments that operate facilities or provide services that enable patrons to participate in recreational activities or pursue amusement, hobby, and leisure-time interests.
Column name: employed_agriculture_forestry_fishing_hunting_mining Type: FLOAT Description: Workers employed in firms in agriculture, forestry, fishing, hunting, or mining. The Agriculture, Forestry, Fishing and Hunting sector comprises establishments primarily engaged in growing crops, raising animals, harvesting timber, and harvesting fish and other animals from a farm, ranch, or their natural habitats.
Column name: median_income Type: FLOAT Description: Median Household Income in the past 12 Months. Within a geographic area, the median income received by every household on a regular basis before payments for personal income taxes, social security, union dues, medicare deductions, etc.  It includes income received from wages, salary, commissions, bonuses, and tips; self-employment income from own nonfarm or farm businesses, including proprietorships and partnerships; interest, dividends, net rental income, royalty income, or income from estates and trusts; Social Security or Railroad Retirement income; Supplemental Security Income (SSI); any cash public assistance or welfare payments from the state or local welfare office; retirement, survivor, or disability benefits; and any other sources of income received regularly such as Veterans' (VA) payments, unemployment and/or worker's compensation, child support, and alimony.
Column name: employed_wholesale_trade Type: FLOAT Description: Workers employed in firms in wholesale trade. The Wholesale Trade sector comprises establishments engaged in wholesaling merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The wholesaling process is an intermediate step in the distribution of merchandise. Wholesalers are organized to sell or arrange the purchase or sale of (a) goods for resale (i.e., goods sold to other wholesalers or retailers), (b) capital or durable nonconsumer goods, and (c) raw and intermediate materials and supplies used in production.
Column name: employed_retail_trade Type: FLOAT Description: Workers employed in firms in retail trade. The Retail Trade sector comprises establishments engaged in retailing merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The retailing process is the final step in the distribution of merchandise; retailers are, therefore, organized to sell merchandise in small quantities to the general public.
Column name: employed_information Type: FLOAT Description: Workers employed in firms in information. The Information sector comprises establishments engaged in the following processes: (a) producing and distributing information and cultural products, (b) providing the means to transmit or distribute these products as well as data or communications, and (c) processing data. Included are the publishing industries, the motion picture and sound recording industries; the broadcasting industries, the telecommunications industries; Web search portals, data processing industries, and the information services industries.
Sample rows:
[{'median_income': 22351.0, 'employed_agriculture_forestry_fishing_hunting_mining': 2.0, 'employed_arts_entertainment_recreation_accommodation_food': 79.0, 'employed_information': 0.0, 'employed_retail_trade': 183.0, 'employed_wholesale_trade': 0.0}, {'median_income': 19332.0, 'employed_agriculture_forestry_fishing_hunting_mining': 23.0, 'employed_arts_entertainment_recreation_accommodation_food': 249.0, 'employed_information': 0.0, 'employed_retail_trade': 206.0, 'employed_wholesale_trade': 37.0}, {'median_income': 61742.0, 'employed_agriculture_forestry_fishing_hunting_mining': 0.0, 'employed_arts_entertainment_recreation_accommodation_food': 77.0, 'employed_information': 35.0, 'employed_retail_trade': 92.0, 'employed_wholesale_trade': 25.0}, {'median_income': 36327.0, 'employed_agriculture_forestry_fishing_hunting_mining': 0.0, 'employed_arts_entertainment_recreation_accommodation_food': 203.0, 'employed_information': 0.0, 'employed_retail_trade': 163.0, 'employed_wholesale_trade': 20.0}, {'median_income': 86534.0, 'employed_agriculture_forestry_fishing_hunting_mining': 62.0, 'employed_arts_entertainment_recreation_accommodation_food': 47.0, 'employed_information': 69.0, 'employed_retail_trade': 90.0, 'employed_wholesale_trade': 10.0}]

--------------------------------------------------
Table full name: CENSUS_BUREAU_ACS_2.CENSUS_BUREAU_ACS.CONGRESSIONALDISTRICT_2010_5YR
Column name: employed_retail_trade Type: FLOAT Description: Workers employed in firms in retail trade. The Retail Trade sector comprises establishments engaged in retailing merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The retailing process is the final step in the distribution of merchandise; retailers are, therefore, organized to sell merchandise in small quantities to the general public.
Column name: employed_construction Type: FLOAT Description: Workers employed in firms in construction. The Construction sector comprises establishments primarily engaged in the construction of buildings or engineering projects (e.g., highways and utility systems). Construction work done may include new work, additions, alterations, or maintenance and repairs.
Column name: employed_wholesale_trade Type: FLOAT Description: Workers employed in firms in wholesale trade. The Wholesale Trade sector comprises establishments engaged in wholesaling merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The wholesaling process is an intermediate step in the distribution of merchandise. Wholesalers are organized to sell or arrange the purchase or sale of (a) goods for resale (i.e., goods sold to other wholesalers or retailers), (b) capital or durable nonconsumer goods, and (c) raw and intermediate materials and supplies used in production.
Column name: median_income Type: FLOAT Description: Median Household Income in the past 12 Months. Within a geographic area, the median income received by every household on a regular basis before payments for personal income taxes, social security, union dues, medicare deductions, etc.  It includes income received from wages, salary, commissions, bonuses, and tips; self-employment income from own nonfarm or farm businesses, including proprietorships and partnerships; interest, dividends, net rental income, royalty income, or income from estates and trusts; Social Security or Railroad Retirement income; Supplemental Security Income (SSI); any cash public assistance or welfare payments from the state or local welfare office; retirement, survivor, or disability benefits; and any other sources of income received regularly such as Veterans' (VA) payments, unemployment and/or worker's compensation, child support, and alimony.
Column name: employed_information Type: FLOAT Description: Workers employed in firms in information. The Information sector comprises establishments engaged in the following processes: (a) producing and distributing information and cultural products, (b) providing the means to transmit or distribute these products as well as data or communications, and (c) processing data. Included are the publishing industries, the motion picture and sound recording industries; the broadcasting industries, the telecommunications industries; Web search portals, data processing industries, and the information services industries.
Column name: employed_arts_entertainment_recreation_accommodation_food Type: FLOAT Description: Workers employed in firms in arts, entertainment, recreation, accommodation and food services. The Arts, Entertainment, and Recreation sector includes a wide range of establishments that operate facilities or provide services to meet varied cultural, entertainment, and recreational interests of their patrons. This sector comprises (1) establishments that are involved in producing, promoting, or participating in live performances, events, or exhibits intended for public viewing; (2) establishments that preserve and exhibit objects and sites of historical, cultural, or educational interest; and (3) establishments that operate facilities or provide services that enable patrons to participate in recreational activities or pursue amusement, hobby, and leisure-time interests.
Sample rows:
[{'median_income': 47110.0, 'employed_arts_entertainment_recreation_accommodation_food': 33730.0, 'employed_construction': 20001.0, 'employed_information': 7777.0, 'employed_retail_trade': 30443.0, 'employed_wholesale_trade': 8670.0}, {'median_income': 41298.0, 'employed_arts_entertainment_recreation_accommodation_food': 18965.0, 'employed_construction': 12333.0, 'employed_information': 9989.0, 'employed_retail_trade': 25543.0, 'employed_wholesale_trade': 5242.0}, {'median_income': 52833.0, 'employed_arts_entertainment_recreation_accommodation_food': 39455.0, 'employed_construction': 33219.0, 'employed_information': 7158.0, 'employed_retail_trade': 53364.0, 'employed_wholesale_trade': 9496.0}, {'median_income': 57797.0, 'employed_arts_entertainment_recreation_accommodation_food': 23059.0, 'employed_construction': 29602.0, 'employed_information': 10608.0, 'employed_retail_trade': 41158.0, 'employed_wholesale_trade': 15831.0}, {'median_income': 42650.0, 'employed_arts_entertainment_recreation_accommodation_food': 29897.0, 'employed_construction': 24178.0, 'employed_information': 5566.0, 'employed_retail_trade': 36403.0, 'employed_wholesale_trade': 9115.0}]

--------------------------------------------------
Table full name: CENSUS_BUREAU_ACS_2.CENSUS_BUREAU_ACS.PLACE_2011_3YR
Column name: employed_wholesale_trade Type: FLOAT Description: Workers employed in firms in wholesale trade. The Wholesale Trade sector comprises establishments engaged in wholesaling merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The wholesaling process is an intermediate step in the distribution of merchandise. Wholesalers are organized to sell or arrange the purchase or sale of (a) goods for resale (i.e., goods sold to other wholesalers or retailers), (b) capital or durable nonconsumer goods, and (c) raw and intermediate materials and supplies used in production.
Column name: median_income Type: FLOAT Description: Median Household Income in the past 12 Months. Within a geographic area, the median income received by every household on a regular basis before payments for personal income taxes, social security, union dues, medicare deductions, etc.  It includes income received from wages, salary, commissions, bonuses, and tips; self-employment income from own nonfarm or farm businesses, including proprietorships and partnerships; interest, dividends, net rental income, royalty income, or income from estates and trusts; Social Security or Railroad Retirement income; Supplemental Security Income (SSI); any cash public assistance or welfare payments from the state or local welfare office; retirement, survivor, or disability benefits; and any other sources of income received regularly such as Veterans' (VA) payments, unemployment and/or worker's compensation, child support, and alimony.
Column name: employed_arts_entertainment_recreation_accommodation_food Type: FLOAT Description: Workers employed in firms in arts, entertainment, recreation, accommodation and food services. The Arts, Entertainment, and Recreation sector includes a wide range of establishments that operate facilities or provide services to meet varied cultural, entertainment, and recreational interests of their patrons. This sector comprises (1) establishments that are involved in producing, promoting, or participating in live performances, events, or exhibits intended for public viewing; (2) establishments that preserve and exhibit objects and sites of historical, cultural, or educational interest; and (3) establishments that operate facilities or provide services that enable patrons to participate in recreational activities or pursue amusement, hobby, and leisure-time interests.
Column name: employed_information Type: FLOAT Description: Workers employed in firms in information. The Information sector comprises establishments engaged in the following processes: (a) producing and distributing information and cultural products, (b) providing the means to transmit or distribute these products as well as data or communications, and (c) processing data. Included are the publishing industries, the motion picture and sound recording industries; the broadcasting industries, the telecommunications industries; Web search portals, data processing industries, and the information services industries.
Column name: employed_retail_trade Type: FLOAT Description: Workers employed in firms in retail trade. The Retail Trade sector comprises establishments engaged in retailing merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The retailing process is the final step in the distribution of merchandise; retailers are, therefore, organized to sell merchandise in small quantities to the general public.
Column name: employed_construction Type: FLOAT Description: Workers employed in firms in construction. The Construction sector comprises establishments primarily engaged in the construction of buildings or engineering projects (e.g., highways and utility systems). Construction work done may include new work, additions, alterations, or maintenance and repairs.
Sample rows:
[{'median_income': 78384.0, 'employed_arts_entertainment_recreation_accommodation_food': 2123.0, 'employed_construction': 485.0, 'employed_information': 1198.0, 'employed_retail_trade': 1916.0, 'employed_wholesale_trade': 735.0}, {'median_income': 57830.0, 'employed_arts_entertainment_recreation_accommodation_food': 9657.0, 'employed_construction': 3812.0, 'employed_information': 4655.0, 'employed_retail_trade': 12732.0, 'employed_wholesale_trade': 3906.0}, {'median_income': 38009.0, 'employed_arts_entertainment_recreation_accommodation_food': 5100.0, 'employed_construction': 1434.0, 'employed_information': 1218.0, 'employed_retail_trade': 5148.0, 'employed_wholesale_trade': 666.0}, {'median_income': 34844.0, 'employed_arts_entertainment_recreation_accommodation_food': 8840.0, 'employed_construction': 2654.0, 'employed_information': 768.0, 'employed_retail_trade': 7710.0, 'employed_wholesale_trade': 1139.0}, {'median_income': 35823.0, 'employed_arts_entertainment_recreation_accommodation_food': 5932.0, 'employed_construction': 2045.0, 'employed_information': 1055.0, 'employed_retail_trade': 6551.0, 'employed_wholesale_trade': 862.0}]

--------------------------------------------------
Table full name: CENSUS_BUREAU_ACS_2.CENSUS_BUREAU_ACS.SCHOOLDISTRICTSECONDARY_2010_5YR
Column name: employed_information Type: FLOAT Description: Workers employed in firms in information. The Information sector comprises establishments engaged in the following processes: (a) producing and distributing information and cultural products, (b) providing the means to transmit or distribute these products as well as data or communications, and (c) processing data. Included are the publishing industries, the motion picture and sound recording industries; the broadcasting industries, the telecommunications industries; Web search portals, data processing industries, and the information services industries.
Column name: employed_arts_entertainment_recreation_accommodation_food Type: FLOAT Description: Workers employed in firms in arts, entertainment, recreation, accommodation and food services. The Arts, Entertainment, and Recreation sector includes a wide range of establishments that operate facilities or provide services to meet varied cultural, entertainment, and recreational interests of their patrons. This sector comprises (1) establishments that are involved in producing, promoting, or participating in live performances, events, or exhibits intended for public viewing; (2) establishments that preserve and exhibit objects and sites of historical, cultural, or educational interest; and (3) establishments that operate facilities or provide services that enable patrons to participate in recreational activities or pursue amusement, hobby, and leisure-time interests.
Column name: employed_agriculture_forestry_fishing_hunting_mining Type: FLOAT Description: Workers employed in firms in agriculture, forestry, fishing, hunting, or mining. The Agriculture, Forestry, Fishing and Hunting sector comprises establishments primarily engaged in growing crops, raising animals, harvesting timber, and harvesting fish and other animals from a farm, ranch, or their natural habitats.
Column name: employed_wholesale_trade Type: FLOAT Description: Workers employed in firms in wholesale trade. The Wholesale Trade sector comprises establishments engaged in wholesaling merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The wholesaling process is an intermediate step in the distribution of merchandise. Wholesalers are organized to sell or arrange the purchase or sale of (a) goods for resale (i.e., goods sold to other wholesalers or retailers), (b) capital or durable nonconsumer goods, and (c) raw and intermediate materials and supplies used in production.
Column name: median_income Type: FLOAT Description: Median Household Income in the past 12 Months. Within a geographic area, the median income received by every household on a regular basis before payments for personal income taxes, social security, union dues, medicare deductions, etc.  It includes income received from wages, salary, commissions, bonuses, and tips; self-employment income from own nonfarm or farm businesses, including proprietorships and partnerships; interest, dividends, net rental income, royalty income, or income from estates and trusts; Social Security or Railroad Retirement income; Supplemental Security Income (SSI); any cash public assistance or welfare payments from the state or local welfare office; retirement, survivor, or disability benefits; and any other sources of income received regularly such as Veterans' (VA) payments, unemployment and/or worker's compensation, child support, and alimony.
Column name: employed_retail_trade Type: FLOAT Description: Workers employed in firms in retail trade. The Retail Trade sector comprises establishments engaged in retailing merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The retailing process is the final step in the distribution of merchandise; retailers are, therefore, organized to sell merchandise in small quantities to the general public.
Column name: employed_construction Type: FLOAT Description: Workers employed in firms in construction. The Construction sector comprises establishments primarily engaged in the construction of buildings or engineering projects (e.g., highways and utility systems). Construction work done may include new work, additions, alterations, or maintenance and repairs.
Sample rows:
[{'median_income': 158221.0, 'employed_agriculture_forestry_fishing_hunting_mining': 26.0, 'employed_arts_entertainment_recreation_accommodation_food': 214.0, 'employed_construction': 184.0, 'employed_information': 144.0, 'employed_retail_trade': 324.0, 'employed_wholesale_trade': 153.0}, {'median_income': 73032.0, 'employed_agriculture_forestry_fishing_hunting_mining': 37.0, 'employed_arts_entertainment_recreation_accommodation_food': 1729.0, 'employed_construction': 1134.0, 'employed_information': 384.0, 'employed_retail_trade': 2610.0, 'employed_wholesale_trade': 1098.0}, {'median_income': 53187.0, 'employed_agriculture_forestry_fishing_hunting_mining': 2962.0, 'employed_arts_entertainment_recreation_accommodation_food': 2196.0, 'employed_construction': 1290.0, 'employed_information': 182.0, 'employed_retail_trade': 3150.0, 'employed_wholesale_trade': 756.0}, {'median_income': 108578.0, 'employed_agriculture_forestry_fishing_hunting_mining': 99.0, 'employed_arts_entertainment_recreation_accommodation_food': 2201.0, 'employed_construction': 1335.0, 'employed_information': 813.0, 'employed_retail_trade': 3241.0, 'employed_wholesale_trade': 1805.0}, {'median_income': 68119.0, 'employed_agriculture_forestry_fishing_hunting_mining': 1147.0, 'employed_arts_entertainment_recreation_accommodation_food': 14285.0, 'employed_construction': 14164.0, 'employed_information': 3137.0, 'employed_retail_trade': 23499.0, 'employed_wholesale_trade': 8686.0}]

--------------------------------------------------
Table full name: CENSUS_BUREAU_ACS_2.CENSUS_BUREAU_ACS.PUMA_2008_3YR
Column name: employed_information Type: FLOAT Description: Workers employed in firms in information. The Information sector comprises establishments engaged in the following processes: (a) producing and distributing information and cultural products, (b) providing the means to transmit or distribute these products as well as data or communications, and (c) processing data. Included are the publishing industries, the motion picture and sound recording industries; the broadcasting industries, the telecommunications industries; Web search portals, data processing industries, and the information services industries.
Column name: employed_retail_trade Type: FLOAT Description: Workers employed in firms in retail trade. The Retail Trade sector comprises establishments engaged in retailing merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The retailing process is the final step in the distribution of merchandise; retailers are, therefore, organized to sell merchandise in small quantities to the general public.
Column name: median_income Type: FLOAT Description: Median Household Income in the past 12 Months. Within a geographic area, the median income received by every household on a regular basis before payments for personal income taxes, social security, union dues, medicare deductions, etc.  It includes income received from wages, salary, commissions, bonuses, and tips; self-employment income from own nonfarm or farm businesses, including proprietorships and partnerships; interest, dividends, net rental income, royalty income, or income from estates and trusts; Social Security or Railroad Retirement income; Supplemental Security Income (SSI); any cash public assistance or welfare payments from the state or local welfare office; retirement, survivor, or disability benefits; and any other sources of income received regularly such as Veterans' (VA) payments, unemployment and/or worker's compensation, child support, and alimony.
Column name: employed_agriculture_forestry_fishing_hunting_mining Type: FLOAT Description: Workers employed in firms in agriculture, forestry, fishing, hunting, or mining. The Agriculture, Forestry, Fishing and Hunting sector comprises establishments primarily engaged in growing crops, raising animals, harvesting timber, and harvesting fish and other animals from a farm, ranch, or their natural habitats.
Column name: employed_arts_entertainment_recreation_accommodation_food Type: FLOAT Description: Workers employed in firms in arts, entertainment, recreation, accommodation and food services. The Arts, Entertainment, and Recreation sector includes a wide range of establishments that operate facilities or provide services to meet varied cultural, entertainment, and recreational interests of their patrons. This sector comprises (1) establishments that are involved in producing, promoting, or participating in live performances, events, or exhibits intended for public viewing; (2) establishments that preserve and exhibit objects and sites of historical, cultural, or educational interest; and (3) establishments that operate facilities or provide services that enable patrons to participate in recreational activities or pursue amusement, hobby, and leisure-time interests.
Column name: employed_wholesale_trade Type: FLOAT Description: Workers employed in firms in wholesale trade. The Wholesale Trade sector comprises establishments engaged in wholesaling merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The wholesaling process is an intermediate step in the distribution of merchandise. Wholesalers are organized to sell or arrange the purchase or sale of (a) goods for resale (i.e., goods sold to other wholesalers or retailers), (b) capital or durable nonconsumer goods, and (c) raw and intermediate materials and supplies used in production.
Sample rows:
[{'median_income': 78016.0, 'employed_agriculture_forestry_fishing_hunting_mining': 324.0, 'employed_arts_entertainment_recreation_accommodation_food': 8043.0, 'employed_information': 5058.0, 'employed_retail_trade': 15476.0, 'employed_wholesale_trade': 6613.0}, {'median_income': 54432.0, 'employed_agriculture_forestry_fishing_hunting_mining': 87.0, 'employed_arts_entertainment_recreation_accommodation_food': 6744.0, 'employed_information': 2538.0, 'employed_retail_trade': 9986.0, 'employed_wholesale_trade': 2526.0}, {'median_income': 80355.0, 'employed_agriculture_forestry_fishing_hunting_mining': 80.0, 'employed_arts_entertainment_recreation_accommodation_food': 8594.0, 'employed_information': 3176.0, 'employed_retail_trade': 11385.0, 'employed_wholesale_trade': 2967.0}, {'median_income': 79820.0, 'employed_agriculture_forestry_fishing_hunting_mining': 817.0, 'employed_arts_entertainment_recreation_accommodation_food': 8110.0, 'employed_information': 7382.0, 'employed_retail_trade': 14393.0, 'employed_wholesale_trade': 5034.0}, {'median_income': 89400.0, 'employed_agriculture_forestry_fishing_hunting_mining': 101.0, 'employed_arts_entertainment_recreation_accommodation_food': 5374.0, 'employed_information': 3790.0, 'employed_retail_trade': 9585.0, 'employed_wholesale_trade': 3212.0}]

--------------------------------------------------
Table full name: CENSUS_BUREAU_ACS_2.CENSUS_BUREAU_ACS.SCHOOLDISTRICTELEMENTARY_2010_1YR
Column name: median_income Type: NUMBER Description: Median Household Income in the past 12 Months. Within a geographic area, the median income received by every household on a regular basis before payments for personal income taxes, social security, union dues, medicare deductions, etc.  It includes income received from wages, salary, commissions, bonuses, and tips; self-employment income from own nonfarm or farm businesses, including proprietorships and partnerships; interest, dividends, net rental income, royalty income, or income from estates and trusts; Social Security or Railroad Retirement income; Supplemental Security Income (SSI); any cash public assistance or welfare payments from the state or local welfare office; retirement, survivor, or disability benefits; and any other sources of income received regularly such as Veterans' (VA) payments, unemployment and/or worker's compensation, child support, and alimony.
Column name: employed_arts_entertainment_recreation_accommodation_food Type: NUMBER Description: Workers employed in firms in arts, entertainment, recreation, accommodation and food services. The Arts, Entertainment, and Recreation sector includes a wide range of establishments that operate facilities or provide services to meet varied cultural, entertainment, and recreational interests of their patrons. This sector comprises (1) establishments that are involved in producing, promoting, or participating in live performances, events, or exhibits intended for public viewing; (2) establishments that preserve and exhibit objects and sites of historical, cultural, or educational interest; and (3) establishments that operate facilities or provide services that enable patrons to participate in recreational activities or pursue amusement, hobby, and leisure-time interests.
Column name: employed_retail_trade Type: NUMBER Description: Workers employed in firms in retail trade. The Retail Trade sector comprises establishments engaged in retailing merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The retailing process is the final step in the distribution of merchandise; retailers are, therefore, organized to sell merchandise in small quantities to the general public.
Column name: employed_construction Type: NUMBER Description: Workers employed in firms in construction. The Construction sector comprises establishments primarily engaged in the construction of buildings or engineering projects (e.g., highways and utility systems). Construction work done may include new work, additions, alterations, or maintenance and repairs.
Column name: employed_wholesale_trade Type: NUMBER Description: Workers employed in firms in wholesale trade. The Wholesale Trade sector comprises establishments engaged in wholesaling merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The wholesaling process is an intermediate step in the distribution of merchandise. Wholesalers are organized to sell or arrange the purchase or sale of (a) goods for resale (i.e., goods sold to other wholesalers or retailers), (b) capital or durable nonconsumer goods, and (c) raw and intermediate materials and supplies used in production.
Column name: employed_information Type: NUMBER Description: Workers employed in firms in information. The Information sector comprises establishments engaged in the following processes: (a) producing and distributing information and cultural products, (b) providing the means to transmit or distribute these products as well as data or communications, and (c) processing data. Included are the publishing industries, the motion picture and sound recording industries; the broadcasting industries, the telecommunications industries; Web search portals, data processing industries, and the information services industries.
Sample rows:
[{'median_income': '96099.000000000', 'employed_arts_entertainment_recreation_accommodation_food': None, 'employed_construction': None, 'employed_information': None, 'employed_retail_trade': None, 'employed_wholesale_trade': None}, {'median_income': '63681.000000000', 'employed_arts_entertainment_recreation_accommodation_food': None, 'employed_construction': None, 'employed_information': None, 'employed_retail_trade': None, 'employed_wholesale_trade': None}, {'median_income': '47930.000000000', 'employed_arts_entertainment_recreation_accommodation_food': None, 'employed_construction': None, 'employed_information': None, 'employed_retail_trade': None, 'employed_wholesale_trade': None}, {'median_income': '43068.000000000', 'employed_arts_entertainment_recreation_accommodation_food': None, 'employed_construction': None, 'employed_information': None, 'employed_retail_trade': None, 'employed_wholesale_trade': None}, {'median_income': '41508.000000000', 'employed_arts_entertainment_recreation_accommodation_food': None, 'employed_construction': None, 'employed_information': None, 'employed_retail_trade': None, 'employed_wholesale_trade': None}]

--------------------------------------------------
Table full name: CENSUS_BUREAU_ACS_2.CENSUS_BUREAU_ACS.ZIP_CODES_2015_5YR
Column name: employed_wholesale_trade Type: NUMBER Description: Workers employed in firms in wholesale trade. The Wholesale Trade sector comprises establishments engaged in wholesaling merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The wholesaling process is an intermediate step in the distribution of merchandise. Wholesalers are organized to sell or arrange the purchase or sale of (a) goods for resale (i.e., goods sold to other wholesalers or retailers), (b) capital or durable nonconsumer goods, and (c) raw and intermediate materials and supplies used in production.
Column name: employed_retail_trade Type: NUMBER Description: Workers employed in firms in retail trade. The Retail Trade sector comprises establishments engaged in retailing merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The retailing process is the final step in the distribution of merchandise; retailers are, therefore, organized to sell merchandise in small quantities to the general public.
Column name: employed_arts_entertainment_recreation_accommodation_food Type: NUMBER Description: Workers employed in firms in arts, entertainment, recreation, accommodation and food services. The Arts, Entertainment, and Recreation sector includes a wide range of establishments that operate facilities or provide services to meet varied cultural, entertainment, and recreational interests of their patrons. This sector comprises (1) establishments that are involved in producing, promoting, or participating in live performances, events, or exhibits intended for public viewing; (2) establishments that preserve and exhibit objects and sites of historical, cultural, or educational interest; and (3) establishments that operate facilities or provide services that enable patrons to participate in recreational activities or pursue amusement, hobby, and leisure-time interests.
Column name: employed_construction Type: NUMBER Description: Workers employed in firms in construction. The Construction sector comprises establishments primarily engaged in the construction of buildings or engineering projects (e.g., highways and utility systems). Construction work done may include new work, additions, alterations, or maintenance and repairs.
Column name: median_income Type: NUMBER Description: Median Household Income in the past 12 Months. Within a geographic area, the median income received by every household on a regular basis before payments for personal income taxes, social security, union dues, medicare deductions, etc.  It includes income received from wages, salary, commissions, bonuses, and tips; self-employment income from own nonfarm or farm businesses, including proprietorships and partnerships; interest, dividends, net rental income, royalty income, or income from estates and trusts; Social Security or Railroad Retirement income; Supplemental Security Income (SSI); any cash public assistance or welfare payments from the state or local welfare office; retirement, survivor, or disability benefits; and any other sources of income received regularly such as Veterans' (VA) payments, unemployment and/or worker's compensation, child support, and alimony.
Column name: employed_information Type: NUMBER Description: Workers employed in firms in information. The Information sector comprises establishments engaged in the following processes: (a) producing and distributing information and cultural products, (b) providing the means to transmit or distribute these products as well as data or communications, and (c) processing data. Included are the publishing industries, the motion picture and sound recording industries; the broadcasting industries, the telecommunications industries; Web search portals, data processing industries, and the information services industries.
Sample rows:
[{'median_income': '56471.000000000', 'employed_arts_entertainment_recreation_accommodation_food': '0E-9', 'employed_construction': '1.000000000', 'employed_information': '3.000000000', 'employed_retail_trade': '31.000000000', 'employed_wholesale_trade': '2.000000000'}, {'median_income': '62083.000000000', 'employed_arts_entertainment_recreation_accommodation_food': '7.000000000', 'employed_construction': '0E-9', 'employed_information': '0E-9', 'employed_retail_trade': '56.000000000', 'employed_wholesale_trade': '0E-9'}, {'median_income': '27500.000000000', 'employed_arts_entertainment_recreation_accommodation_food': '1.000000000', 'employed_construction': '6.000000000', 'employed_information': '0E-9', 'employed_retail_trade': '7.000000000', 'employed_wholesale_trade': '0E-9'}, {'median_income': '58894.000000000', 'employed_arts_entertainment_recreation_accommodation_food': '7.000000000', 'employed_construction': '9.000000000', 'employed_information': '0E-9', 'employed_retail_trade': '59.000000000', 'employed_wholesale_trade': '9.000000000'}, {'median_income': None, 'employed_arts_entertainment_recreation_accommodation_food': '7.000000000', 'employed_construction': '0E-9', 'employed_information': '0E-9', 'employed_retail_trade': '0E-9', 'employed_wholesale_trade': '0E-9'}]

--------------------------------------------------
Table full name: CENSUS_BUREAU_ACS_2.CENSUS_BUREAU_ACS.BLOCKGROUP_2015_5YR
Column name: employed_pop Type: FLOAT Description: Employed Population. The number of civilians 16 years old and over in each geography who either (1) were "at work," that is, those who did any work at all during the reference week as paid employees, worked in their own business or profession, worked on their own farm, or worked 15 hours or more as unpaid workers on a family farm or in a family business; or (2) were "with a job but not at work," that is, those who did not work during the reference week but had jobs or businesses from which they were temporarily absent due to illness, bad weather, industrial dispute, vacation, or other personal reasons. Excluded from the employed are people whose only activity consisted of work around the house or unpaid volunteer work for religious, charitable, and similar organizations; also excluded are all institutionalized people and people on active duty in the United States Armed Forces.
Column name: civilian_labor_force Type: FLOAT Description: Population in Civilian Labor Force. The number of civilians 16 years and over in each geography who can be classified as either "employed" or "unemployed" below.
Column name: median_income Type: FLOAT Description: Median Household Income in the past 12 Months. Within a geographic area, the median income received by every household on a regular basis before payments for personal income taxes, social security, union dues, medicare deductions, etc.  It includes income received from wages, salary, commissions, bonuses, and tips; self-employment income from own nonfarm or farm businesses, including proprietorships and partnerships; interest, dividends, net rental income, royalty income, or income from estates and trusts; Social Security or Railroad Retirement income; Supplemental Security Income (SSI); any cash public assistance or welfare payments from the state or local welfare office; retirement, survivor, or disability benefits; and any other sources of income received regularly such as Veterans' (VA) payments, unemployment and/or worker's compensation, child support, and alimony.
Column name: unemployed_pop Type: FLOAT
Sample rows:
[{'median_income': 54904.0, 'civilian_labor_force': 565.0, 'employed_pop': 536.0, 'unemployed_pop': 29.0}, {'median_income': 36950.0, 'civilian_labor_force': 360.0, 'employed_pop': 328.0, 'unemployed_pop': 32.0}, {'median_income': 77500.0, 'civilian_labor_force': 731.0, 'employed_pop': 711.0, 'unemployed_pop': 20.0}, {'median_income': 32143.0, 'civilian_labor_force': 279.0, 'employed_pop': 255.0, 'unemployed_pop': 24.0}, {'median_income': 36348.0, 'civilian_labor_force': 576.0, 'employed_pop': 499.0, 'unemployed_pop': 77.0}]

--------------------------------------------------
Table full name: CENSUS_BUREAU_ACS_2.CENSUS_BUREAU_ACS.BLOCKGROUP_2017_5YR
Column name: employed_pop Type: FLOAT Description: Employed Population. The number of civilians 16 years old and over in each geography who either (1) were "at work," that is, those who did any work at all during the reference week as paid employees, worked in their own business or profession, worked on their own farm, or worked 15 hours or more as unpaid workers on a family farm or in a family business; or (2) were "with a job but not at work," that is, those who did not work during the reference week but had jobs or businesses from which they were temporarily absent due to illness, bad weather, industrial dispute, vacation, or other personal reasons. Excluded from the employed are people whose only activity consisted of work around the house or unpaid volunteer work for religious, charitable, and similar organizations; also excluded are all institutionalized people and people on active duty in the United States Armed Forces.
Column name: median_income Type: FLOAT Description: Median Household Income in the past 12 Months. Within a geographic area, the median income received by every household on a regular basis before payments for personal income taxes, social security, union dues, medicare deductions, etc.  It includes income received from wages, salary, commissions, bonuses, and tips; self-employment income from own nonfarm or farm businesses, including proprietorships and partnerships; interest, dividends, net rental income, royalty income, or income from estates and trusts; Social Security or Railroad Retirement income; Supplemental Security Income (SSI); any cash public assistance or welfare payments from the state or local welfare office; retirement, survivor, or disability benefits; and any other sources of income received regularly such as Veterans' (VA) payments, unemployment and/or worker's compensation, child support, and alimony.
Sample rows:
[{'median_income': 52574.0, 'employed_pop': 890.0}, {'median_income': 84600.0, 'employed_pop': 1421.0}, {'median_income': 62645.0, 'employed_pop': 729.0}, {'median_income': 154412.0, 'employed_pop': 785.0}, {'median_income': 132782.0, 'employed_pop': 839.0}]

--------------------------------------------------
Table full name: CENSUS_BUREAU_ACS_2.CENSUS_BUREAU_ACS.ZIP_CODES_2017_5YR
Column name: geo_id Type: TEXT Description: US Census Zip Code Tabulation Areas Geoids
Column name: employed_arts_entertainment_recreation_accommodation_food Type: FLOAT Description: Workers employed in firms in arts, entertainment, recreation, accommodation and food services. The Arts, Entertainment, and Recreation sector includes a wide range of establishments that operate facilities or provide services to meet varied cultural, entertainment, and recreational interests of their patrons. This sector comprises (1) establishments that are involved in producing, promoting, or participating in live performances, events, or exhibits intended for public viewing; (2) establishments that preserve and exhibit objects and sites of historical, cultural, or educational interest; and (3) establishments that operate facilities or provide services that enable patrons to participate in recreational activities or pursue amusement, hobby, and leisure-time interests.
Column name: employed_retail_trade Type: FLOAT Description: Workers employed in firms in retail trade. The Retail Trade sector comprises establishments engaged in retailing merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The retailing process is the final step in the distribution of merchandise; retailers are, therefore, organized to sell merchandise in small quantities to the general public.
Column name: employed_information Type: FLOAT Description: Workers employed in firms in information. The Information sector comprises establishments engaged in the following processes: (a) producing and distributing information and cultural products, (b) providing the means to transmit or distribute these products as well as data or communications, and (c) processing data. Included are the publishing industries, the motion picture and sound recording industries; the broadcasting industries, the telecommunications industries; Web search portals, data processing industries, and the information services industries.
Column name: employed_wholesale_trade Type: FLOAT Description: Workers employed in firms in wholesale trade. The Wholesale Trade sector comprises establishments engaged in wholesaling merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The wholesaling process is an intermediate step in the distribution of merchandise. Wholesalers are organized to sell or arrange the purchase or sale of (a) goods for resale (i.e., goods sold to other wholesalers or retailers), (b) capital or durable nonconsumer goods, and (c) raw and intermediate materials and supplies used in production.
Column name: employed_construction Type: FLOAT Description: Workers employed in firms in construction. The Construction sector comprises establishments primarily engaged in the construction of buildings or engineering projects (e.g., highways and utility systems). Construction work done may include new work, additions, alterations, or maintenance and repairs.
Column name: median_income Type: FLOAT Description: Median Household Income in the past 12 Months. Within a geographic area, the median income received by every household on a regular basis before payments for personal income taxes, social security, union dues, medicare deductions, etc.  It includes income received from wages, salary, commissions, bonuses, and tips; self-employment income from own nonfarm or farm businesses, including proprietorships and partnerships; interest, dividends, net rental income, royalty income, or income from estates and trusts; Social Security or Railroad Retirement income; Supplemental Security Income (SSI); any cash public assistance or welfare payments from the state or local welfare office; retirement, survivor, or disability benefits; and any other sources of income received regularly such as Veterans' (VA) payments, unemployment and/or worker's compensation, child support, and alimony.
Sample rows:
[{'geo_id': '43942', 'median_income': 44911.0, 'employed_arts_entertainment_recreation_accommodation_food': 38.0, 'employed_construction': 66.0, 'employed_information': 0.0, 'employed_retail_trade': 84.0, 'employed_wholesale_trade': 14.0}, {'geo_id': '14837', 'median_income': 49615.0, 'employed_arts_entertainment_recreation_accommodation_food': 191.0, 'employed_construction': 201.0, 'employed_information': 28.0, 'employed_retail_trade': 242.0, 'employed_wholesale_trade': 29.0}, {'geo_id': '35218', 'median_income': 24645.0, 'employed_arts_entertainment_recreation_accommodation_food': 170.0, 'employed_construction': 103.0, 'employed_information': 43.0, 'employed_retail_trade': 360.0, 'employed_wholesale_trade': 69.0}, {'geo_id': '80924', 'median_income': 124745.0, 'employed_arts_entertainment_recreation_accommodation_food': 237.0, 'employed_construction': 86.0, 'employed_information': 112.0, 'employed_retail_trade': 259.0, 'employed_wholesale_trade': 41.0}, {'geo_id': '40210', 'median_income': 22487.0, 'employed_arts_entertainment_recreation_accommodation_food': 657.0, 'employed_construction': 85.0, 'employed_information': 61.0, 'employed_retail_trade': 444.0, 'employed_wholesale_trade': 136.0}]

--------------------------------------------------
Table full name: CENSUS_BUREAU_ACS_2.CENSUS_BUREAU_ACS.ZIP_CODES_2018_5YR
Column name: employed_retail_trade Type: FLOAT
Column name: employed_construction Type: FLOAT
Column name: employed_wholesale_trade Type: FLOAT
Column name: employed_arts_entertainment_recreation_accommodation_food Type: FLOAT
Column name: median_income Type: FLOAT
Column name: employed_information Type: FLOAT
Sample rows:
[{'median_income': 46265.0, 'employed_arts_entertainment_recreation_accommodation_food': 372.0, 'employed_construction': 538.0, 'employed_information': 10.0, 'employed_retail_trade': 574.0, 'employed_wholesale_trade': 82.0}, {'median_income': 36653.0, 'employed_arts_entertainment_recreation_accommodation_food': 850.0, 'employed_construction': 512.0, 'employed_information': 32.0, 'employed_retail_trade': 1170.0, 'employed_wholesale_trade': 145.0}, {'median_income': 42243.0, 'employed_arts_entertainment_recreation_accommodation_food': 692.0, 'employed_construction': 568.0, 'employed_information': 169.0, 'employed_retail_trade': 1582.0, 'employed_wholesale_trade': 129.0}, {'median_income': 38891.0, 'employed_arts_entertainment_recreation_accommodation_food': 703.0, 'employed_construction': 544.0, 'employed_information': 47.0, 'employed_retail_trade': 766.0, 'employed_wholesale_trade': 176.0}, {'median_income': 49755.0, 'employed_arts_entertainment_recreation_accommodation_food': 374.0, 'employed_construction': 137.0, 'employed_information': 30.0, 'employed_retail_trade': 234.0, 'employed_wholesale_trade': 41.0}]

--------------------------------------------------
Table full name: CENSUS_BUREAU_ACS_2.CENSUS_BUREAU_ACS.ZIP_CODES_2014_5YR
Column name: employed_retail_trade Type: FLOAT Description: Workers employed in firms in retail trade. The Retail Trade sector comprises establishments engaged in retailing merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The retailing process is the final step in the distribution of merchandise; retailers are, therefore, organized to sell merchandise in small quantities to the general public.
Column name: employed_wholesale_trade Type: FLOAT Description: Workers employed in firms in wholesale trade. The Wholesale Trade sector comprises establishments engaged in wholesaling merchandise, generally without transformation, and rendering services incidental to the sale of merchandise. The wholesaling process is an intermediate step in the distribution of merchandise. Wholesalers are organized to sell or arrange the purchase or sale of (a) goods for resale (i.e., goods sold to other wholesalers or retailers), (b) capital or durable nonconsumer goods, and (c) raw and intermediate materials and supplies used in production.
Column name: employed_information Type: FLOAT Description: Workers employed in firms in information. The Information sector comprises establishments engaged in the following processes: (a) producing and distributing information and cultural products, (b) providing the means to transmit or distribute these products as well as data or communications, and (c) processing data. Included are the publishing industries, the motion picture and sound recording industries; the broadcasting industries, the telecommunications industries; Web search portals, data processing industries, and the information services industries.
Column name: employed_arts_entertainment_recreation_accommodation_food Type: FLOAT Description: Workers employed in firms in arts, entertainment, recreation, accommodation and food services. The Arts, Entertainment, and Recreation sector includes a wide range of establishments that operate facilities or provide services to meet varied cultural, entertainment, and recreational interests of their patrons. This sector comprises (1) establishments that are involved in producing, promoting, or participating in live performances, events, or exhibits intended for public viewing; (2) establishments that preserve and exhibit objects and sites of historical, cultural, or educational interest; and (3) establishments that operate facilities or provide services that enable patrons to participate in recreational activities or pursue amusement, hobby, and leisure-time interests.
Column name: employed_construction Type: FLOAT Description: Workers employed in firms in construction. The Construction sector comprises establishments primarily engaged in the construction of buildings or engineering projects (e.g., highways and utility systems). Construction work done may include new work, additions, alterations, or maintenance and repairs.
Column name: median_income Type: FLOAT Description: Median Household Income in the past 12 Months. Within a geographic area, the median income received by every household on a regular basis before payments for personal income taxes, social security, union dues, medicare deductions, etc.  It includes income received from wages, salary, commissions, bonuses, and tips; self-employment income from own nonfarm or farm businesses, including proprietorships and partnerships; interest, dividends, net rental income, royalty income, or income from estates and trusts; Social Security or Railroad Retirement income; Supplemental Security Income (SSI); any cash public assistance or welfare payments from the state or local welfare office; retirement, survivor, or disability benefits; and any other sources of income received regularly such as Veterans' (VA) payments, unemployment and/or worker's compensation, child support, and alimony.
Sample rows:
[{'median_income': 44063.0, 'employed_arts_entertainment_recreation_accommodation_food': 94.0, 'employed_construction': 151.0, 'employed_information': 3.0, 'employed_retail_trade': 76.0, 'employed_wholesale_trade': 8.0}, {'median_income': 39567.0, 'employed_arts_entertainment_recreation_accommodation_food': 1477.0, 'employed_construction': 182.0, 'employed_information': 427.0, 'employed_retail_trade': 1219.0, 'employed_wholesale_trade': 261.0}, {'median_income': 21769.0, 'employed_arts_entertainment_recreation_accommodation_food': 236.0, 'employed_construction': 160.0, 'employed_information': 72.0, 'employed_retail_trade': 206.0, 'employed_wholesale_trade': 96.0}, {'median_income': 25753.0, 'employed_arts_entertainment_recreation_accommodation_food': 1229.0, 'employed_construction': 289.0, 'employed_information': 118.0, 'employed_retail_trade': 937.0, 'employed_wholesale_trade': 135.0}, {'median_income': 45594.0, 'employed_arts_entertainment_recreation_accommodation_food': 647.0, 'employed_construction': 569.0, 'employed_information': 23.0, 'employed_retail_trade': 466.0, 'employed_wholesale_trade': 54.0}]

--------------------------------------------------
Table full name: CENSUS_BUREAU_ACS_2.CYCLISTIC.STATE_FIPS
Column name: state Type: TEXT
Column name: postal_code Type: TEXT
Column name: fips Type: NUMBER
Sample rows:
[{'state': 'Alabama', 'postal_code': 'AL', 'fips': 1}, {'state': 'Arkansas', 'postal_code': 'AR', 'fips': 5}, {'state': 'Hawaii', 'postal_code': 'HI', 'fips': 15}, {'state': 'Idaho', 'postal_code': 'ID', 'fips': 16}, {'state': 'Illinois', 'postal_code': 'IL', 'fips': 17}]

--------------------------------------------------
External knowledge that might be helpful: 
# Calculation of Average Vulnerable Population

This document outlines the method for calculating the average vulnerable population across various industries based on their employment and vulnerability weights.

## Variables

- Let:
  - wholesale_trade = Employment in Wholesale Trade
  - natural_resources_construction = Employment in Natural Resources and Construction
  - arts_entertainment_recreation = Employment in Arts, Entertainment, and Recreation
  - information = Employment in Information
  - retail = Employment in Retail Trade

## Weights

Each industry has a corresponding vulnerability weight:
- wholesale_trade = 0.38423645320197042 
- natural_resources_construction = 0.48071410777129553 
- arts_entertainment_recreation = 0.89455676291236841
- information = 0.31315240083507306 
- retail = 0.51

The table structure information is ({database name: {schema name: [table name]}}): 
{'CENSUS_BUREAU_ACS_2': {'CENSUS_BUREAU_ACS': ['BLOCKGROUP_2014_5YR', 'CBSA_2007_1YR', 'CENSUSTRACT_2011_5YR', 'CONGRESSIONALDISTRICT_2010_5YR', 'PLACE_2011_3YR', 'SCHOOLDISTRICTSECONDARY_2010_5YR', 'PUMA_2008_3YR', 'SCHOOLDISTRICTELEMENTARY_2010_1YR', 'ZIP_CODES_2015_5YR', 'BLOCKGROUP_2015_5YR', 'BLOCKGROUP_2017_5YR', 'ZIP_CODES_2017_5YR', 'ZIP_CODES_2018_5YR', 'ZIP_CODES_2014_5YR'], 'CYCLISTIC': ['STATE_FIPS']}}

Some few-shot examples after column exploration may be helpful:
Query:
--Description: Preview ZIP-code–level median income and employment counts for the 2015 ACS 5-Year estimates
SELECT *
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR"
LIMIT 20;
Answer:
geo_id,nonfamily_households,family_households,median_year_structure_built,rent_burden_not_computed,rent_over_50_percent,rent_40_to_50_percent,rent_35_to_40_percent,rent_30_to_35_percent,rent_25_to_30_percent,rent_20_to_25_percent,rent_15_to_20_percent,rent_10_to_15_percent,rent_under_10_percent,total_pop,male_pop,female_pop,median_age,white_pop,black_pop,asian_pop,hispanic_pop,amerindian_pop,other_race_pop,two_or_more_races_pop,not_hispanic_pop,commuters_by_public_transportation,households,media
Query:
--Description: Preview ZIP-code–level median income and employment counts for the 2018 ACS 5-Year estimates
SELECT *
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR"
LIMIT 20;
Answer:
geo_id,do_date,total_pop,households,male_pop,female_pop,median_age,male_under_5,male_5_to_9,male_10_to_14,male_15_to_17,male_18_to_19,male_20,male_21,male_22_to_24,male_25_to_29,male_30_to_34,male_35_to_39,male_40_to_44,male_45_to_49,male_50_to_54,male_55_to_59,male_65_to_66,male_67_to_69,male_70_to_74,male_75_to_79,male_80_to_84,male_85_and_over,female_under_5,female_5_to_9,female_10_to_14,female_15_to_17,female_18_to_19,female_20,female_21,female_22_to_24,female_25_to_29,female_30_to_34,female
Query:
--Description: Preview ZIP-code–level employment by industry and median income for the 2017 ACS 5-Year estimates
SELECT *
FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR"
LIMIT 20;
Answer:
geo_id,nonfamily_households,family_households,median_year_structure_built,rent_burden_not_computed,rent_over_50_percent,rent_40_to_50_percent,rent_35_to_40_percent,rent_30_to_35_percent,rent_25_to_30_percent,rent_20_to_25_percent,rent_15_to_20_percent,rent_10_to_15_percent,rent_under_10_percent,total_pop,male_pop,female_pop,median_age,white_pop,black_pop,asian_pop,hispanic_pop,amerindian_pop,other_race_pop,two_or_more_races_pop,not_hispanic_pop,commuters_by_public_transportation,households,media
Query:
--Description: Preview whether a “postal_code” field exists in the 2015 ZIP table by simply
--returning the first 20 ZIP codes (geo_id) and their two-digit prefixes (possible FIPS);
--no “postal_code” column is referenced to avoid compilation errors.
SELECT 
       "geo_id",
       SUBSTR("geo_id", 1, 2) AS "zip_prefix"
FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR"
LIMIT 20
Answer:
geo_id,zip_prefix
98304,98
22714,22
69128,69
97908,97
37228,37
97486,97
04491,04
11005,11
04936,04
12195,12
63102,63
06793,06
44669,44
96109,96
15638,15
36263,36
16853,16
08352,08
72536,72
59926,59
Query:
--Description: Compute the median-income difference (2018 – 2015) for each ZIP code that
--appears in both years; do not reference a nonexistent “state” column.
SELECT
       z15."geo_id",
       z15."median_income"::FLOAT AS "median_income_2015",
       z18."median_income"::FLOAT AS "median_income_2018",
       (z18."median_income"::FLOAT - z15."median_income"::FLOAT) AS "income_diff"
FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR" z15
JOIN   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR" z18
       ON z15."geo_id" = z18."geo_id"
LIMIT 20
Answer:
geo_id,median_income_2015,median_income_2018,income_diff
98304,36746.0,37759.0,1013.0
22714,74625.0,92917.0,18292.0
69128,56471.0,38125.0,-18346.0
97908,22321.0,23750.0,1429.0
37228,15540.0,29119.0,13579.0
97486,62083.0,53393.0,-8690.0
04491,27500.0,37500.0,10000.0
11005,58894.0,62993.0,4099.0
04936,40469.0,,
12195,,35625.0,
63102,39855.0,55053.0,15198.0
06793,81711.0,99861.0,18150.0
44669,67981.0,55313.0,-12668.0
96109,29958.0,42202.0,12244.0
15638,51304.0,44667.0,-6637.0
Query:
--Description: Calculate the weighted number of vulnerable employees for every ZIP code in
--2017; the table lacks a “state” field, so only geo_id and the computed value are returned.
SELECT
       "geo_id",
       COALESCE("employed_wholesale_trade", 0) *
           0.38423645320197042 +
       COALESCE("employed_construction", 0) *
           0.48071410777129553 +
       COALESCE("employed_arts_entertainment_recreation_accommodation_food", 0) *
           0.89455676291236841 +
       COALESCE("employed_information", 0) *
           0.31315240083507306 +
       COALESCE("employed_retail_trade", 0) *
           0.51 AS "vulnerable_employees_2017"
FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR"
LIMIT 20
Answer:
geo_id,vulnerable_employees_2017
14521,194.26996984282385
43942,113.9395984484031
56097,265.6251111405002
14837,410.81500174453197
35218,425.16607130239015
12721,677.8945229428296
80924,436.26812955337164
85607,791.3528440863986
40210,926.3829464803935
46040,878.1674582724338
70525,881.8014158525334
29582,2273.0158460090074
32534,1328.8433115700848
01569,1193.7781146418592
41001,1491.1253017337822
14217,2133.313247650402
48040,799.9760055429774
77836,810.5155001214457
Query:
--Description: Aggregate ZIP-level income differences to an average by state.  State names
--are recovered by mapping the ZIP’s two-digit prefix to the CYCLISTIC.STATE_FIPS table.
WITH income_deltas AS (
    SELECT
           LPAD(sf."fips"::STRING, 2, '0')                AS "fips_prefix",
           sf."state",
           (z18."median_income"::FLOAT - z15."median_income"::FLOAT) AS "delta"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR" z15
    JOIN   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR" z18
           ON z15."geo_id" = z18."geo_id"
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z15."geo_id", 1, 2)
    WHERE  z15."median_income" IS NOT NULL
       AND z18."median_income" IS NOT NULL
)
SELECT
       "state",
       AVG("delta") AS "avg_income_diff_2015_2018"
FROM   income_deltas
GROUP  BY "state"
ORDER  BY "avg_income_diff_2015_2018" DESC
LIMIT 20
Answer:
state,avg_income_diff_2015_2018
Alaska,10241.975694444445
Delaware,9507.951923076924
Louisiana,9055.584905660377
Kansas,7886.549295774648
Alabama,7522.180272108843
Wisconsin,7439.635897435897
Colorado,7429.307692307692
American Samoa,7414.787012987013
California,6897.409961685824
Kentucky,6818.007168458781
Iowa,6313.1021897810215
Washington,6309.990445859873
New Hampshire,6183.737113402062
Montana,6179.283887468031
North Carolina,5894.4049586776855
Indiana,5884.674911660777
Query:
--Description: Aggregate weighted vulnerable-employee counts (2017) to an average by state,
--again mapping ZIP prefixes to CYCLISTIC.STATE_FIPS to obtain state names.
WITH vuln_zip AS (
    SELECT
           LPAD(sf."fips"::STRING, 2, '0') AS "fips_prefix",
           sf."state",
           COALESCE(z."employed_wholesale_trade", 0) *
               0.38423645320197042 +
           COALESCE(z."employed_construction", 0) *
               0.48071410777129553 +
           COALESCE(z."employed_arts_entertainment_recreation_accommodation_food", 0) *
               0.89455676291236841 +
           COALESCE(z."employed_information", 0) *
               0.31315240083507306 +
           COALESCE(z."employed_retail_trade", 0) *
               0.51 AS "vuln_emp"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR" z
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z."geo_id", 1, 2)
)
SELECT
       "state",
       AVG("vuln_emp") AS "avg_vulnerable_employees_2017"
FROM   vuln_zip
GROUP  BY "state"
ORDER  BY "avg_vulnerable_employees_2017" DESC
LIMIT 20
Answer:
state,avg_vulnerable_employees_2017
New Hampshire,2557.129458753234
American Samoa,2009.4722086309102
New Jersey,1931.7790239678752
Delaware,1831.5372550555835
Montana,1690.5247324636239
Nevada,1688.399973233335
Virgin Islands,1469.7009412901843
Alaska,1389.6315630148472
Iowa,1386.1996594931964
Kansas,1340.8264802778347
Colorado,1223.8984976743168
Minnesota,1136.205379376585
California,1118.0191358471723
North Carolina,1115.333450086069
Texas,1096.5610256983405
Mississippi,1067.8
Query:
--Description: Combine the state-level average income change (2015–2018) with the
--state-level average number of vulnerable employees (2017) and list the five states
--with the greatest income increases.
WITH income_deltas AS (
    SELECT
           sf."state",
           (z18."median_income"::FLOAT - z15."median_income"::FLOAT) AS "delta"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR" z15
    JOIN   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR" z18
           ON z15."geo_id" = z18."geo_id"
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z15."geo_id", 1, 2)
    WHERE  z15."median_income" IS NOT NULL
       AND z18."median_income" IS NOT NULL
),
state_income AS (
    SELECT  "state", AVG("delta") AS "avg_income_diff_2015_2018"
    FROM    income_deltas
    GROUP   BY "state"
),
state_vuln AS (
    SELECT
           sf."state",
           AVG(
               COALESCE(z."employed_wholesale_trade", 0) * 0.38423645320197042 +
               COALESCE(z."employed_construction", 0)    * 0.48071410777129553 +
               COALESCE(z."employed_arts_entertainment_recreation_accommodation_food", 0)
                                                     * 0.89455676291236841 +
               COALESCE(z."employed_information", 0)     * 0.31315240083507306 +
               COALESCE(z."employed_retail_trade", 0)    * 0.51
           ) AS "avg_vulnerable_employees_2017"
    FROM   "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR" z
    JOIN   "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
           ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z."geo_id", 1, 2)
    GROUP  BY sf."state"
)
SELECT
       i."state",
       i."avg_income_diff_2015_2018",
       v."avg_vulnerable_employees_2017"
FROM   state_income i
JOIN   state_vuln   v ON i."state" = v."state"
ORDER  BY i."avg_income_diff_2015_2018" DESC
LIMIT 5
Answer:
state,avg_income_diff_2015_2018,avg_vulnerable_employees_2017
Alaska,10241.975694444445,1389.6315630148472
Delaware,9507.951923076924,1831.5372550555835
Louisiana,9055.584905660377,1014.5205260097938
Kansas,7886.549295774648,1340.8264802778347
Alabama,7522.180272108843,950.3457820720455
Task: Which are the top five states with the greatest average difference in median income between 2015 and 2018 at the ZIP code level, and what is the corresponding average number of vulnerable employees across wholesale trade, natural resources and construction, arts and entertainment, information, and retail trade industries in 2017 according to the ACS Five-Year Estimates and ZIP code boundaries data?

Please think step by step and answer only one complete SQL in snowflake dialect in ```sql``` format.
SQL usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'CENSUS_BUREAU_ACS_2': {'CENSUS_BUREAU_ACS': ['BLOCKGROUP_2014_5YR', 'CBSA_2007_1YR', 'CENSUSTRACT_2011_5YR', 'CONGRESSIONALDISTRICT_2010_5YR', 'PLACE_2011_3YR', 'SCHOOLDISTRICTSECONDARY_2010_5YR', 'PUMA_2008_3YR', 'SCHOOLDISTRICTELEMENTARY_2010_1YR', 'ZIP_CODES_2015_5YR', 'BLOCKGROUP_2015_5YR', 'BLOCKGROUP_2017_5YR', 'ZIP_CODES_2017_5YR', 'ZIP_CODES_2018_5YR', 'ZIP_CODES_2014_5YR'], 'CYCLISTIC': ['STATE_FIPS']}}

When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
If the task description does not specify the number of decimal places, retain all decimals to four places.

[Self-refine]
2025-05-07 02:35:11 - Thread-239 (execute) - INFO - [Try to run SQL in self-refine]
```sql
/*  Top 5 states by average ZIP-level median-income increase (2015→2018)
    and their corresponding average number of vulnerable employees (2017)
    across wholesale trade, construction, arts & entertainment, information,
    and retail industries. */

WITH income_deltas AS (
    SELECT
        sf."state",
        (z18."median_income"::FLOAT - z15."median_income"::FLOAT) AS "delta"
    FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2015_5YR"  z15
    JOIN "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2018_5YR"  z18
          ON z15."geo_id" = z18."geo_id"
    JOIN "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
          ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z15."geo_id", 1, 2)
    WHERE z15."median_income" IS NOT NULL
      AND z18."median_income" IS NOT NULL
),
state_income AS (
    SELECT
        "state",
        AVG("delta") AS "avg_income_diff_2015_2018"
    FROM income_deltas
    GROUP BY "state"
),
vuln_zip AS (
    SELECT
        sf."state",
        /* weighted vulnerable-employee count for each ZIP in 2017 */
        COALESCE(z."employed_wholesale_trade", 0) * 0.38423645320197042 +
        COALESCE(z."employed_construction",    0) * 0.48071410777129553 +
        COALESCE(z."employed_arts_entertainment_recreation_accommodation_food", 0)
                                                * 0.89455676291236841 +
        COALESCE(z."employed_information",      0) * 0.31315240083507306 +
        COALESCE(z."employed_retail_trade",     0) * 0.51               AS "vuln_emp"
    FROM "CENSUS_BUREAU_ACS_2"."CENSUS_BUREAU_ACS"."ZIP_CODES_2017_5YR" z
    JOIN "CENSUS_BUREAU_ACS_2"."CYCLISTIC"."STATE_FIPS" sf
          ON LPAD(sf."fips"::STRING, 2, '0') = SUBSTR(z."geo_id", 1, 2)
),
state_vuln AS (
    SELECT
        "state",
        AVG("vuln_emp") AS "avg_vulnerable_employees_2017"
    FROM vuln_zip
    GROUP BY "state"
)
SELECT
    i."state",
    i."avg_income_diff_2015_2018",
    v."avg_vulnerable_employees_2017"
FROM   state_income i
JOIN   state_vuln   v  ON i."state" = v."state"
ORDER  BY i."avg_income_diff_2015_2018" DESC NULLS LAST
LIMIT 5;
```
[Try to run SQL in self-refine]
2025-05-07 02:35:17 - Thread-239 (execute) - INFO - Total iteration counts: 0
