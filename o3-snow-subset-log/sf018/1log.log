2025-05-07 07:28:46 - Thread-826 (execute) - INFO - [Exploration]
```sql
--Description: 1) Sample push-notification “send” events that occurred between 08:00 and 09:00 on 1-Jun-2023.  
SELECT
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
WHERE "TIME" >= 1685606400   -- 2023-06-01 08:00:00 UTC
  AND "TIME" <  1685610000   -- 2023-06-01 09:00:00 UTC
LIMIT 20;

--Description: 2) Distinct platforms represented in “send” events during the same one-hour window.  
SELECT DISTINCT
    "PLATFORM"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20;

--Description: 3) Distinct device models seen in “open” events in the one-hour window.  
SELECT DISTINCT
    "DEVICE_MODEL"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20;

--Description: 4) Count of push-notification sends by platform between 08:00-09:00 on 1-Jun-2023.  
SELECT
    "PLATFORM",
    COUNT(*) AS "push_notification_sends"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
GROUP BY "PLATFORM"
LIMIT 20;

--Description: 5) Open events aggregated by platform with total opens and unique users in the one-hour window.  
SELECT
    "PLATFORM",
    COUNT(*)                            AS "push_notification_open",
    COUNT(DISTINCT "USER_ID")           AS "unique_push_notification_opened"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
GROUP BY "PLATFORM"
LIMIT 20;

--Description: 6) Sample push-notification “bounce” events that occurred during the one-hour window.  
SELECT
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20;

--Description: 7) Influenced-open events summarised by campaign during the one-hour window.  
SELECT
    "CAMPAIGN_ID",
    COUNT(*)                  AS "push_notification_influenced_open",
    COUNT(DISTINCT "USER_ID") AS "unique_push_notification_influenced_open"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
GROUP BY "CAMPAIGN_ID"
LIMIT 20;

--Description: 8) Join “send” and “open” events to list users who both received and opened the same message variation in the window.  
SELECT
    s."USER_ID",
    s."CAMPAIGN_ID",
    s."MESSAGE_VARIATION_ID",
    s."PLATFORM"              AS "send_platform",
    o."PLATFORM"              AS "open_platform",
    s."TIME"                  AS "send_time",
    o."TIME"                  AS "open_time"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"  s
JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"  o
  ON  s."USER_ID"            = o."USER_ID"
  AND s."MESSAGE_VARIATION_ID" = o."MESSAGE_VARIATION_ID"
WHERE s."TIME" >= 1685606400 AND s."TIME" < 1685610000
  AND o."TIME" >= 1685606400 AND o."TIME" < 1685610000
LIMIT 20;

--Description: 9) Sample iOS-foreground push-notification events (user received while app in foreground) in the same window.  
SELECT
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20;

--Description: 10) Quick multi-event comparison: total sends, opens, bounces for each platform in the one-hour window (UNION ALL then aggregate).  
WITH union_events AS (
    SELECT "PLATFORM", 'send'  AS "event_type" FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
    WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
    UNION ALL
    SELECT "PLATFORM", 'open'  FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"
    WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
    UNION ALL
    SELECT "PLATFORM", 'bounce' FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW"
    WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
)
SELECT
    "PLATFORM",
    "event_type",
    COUNT(*) AS "event_count"
FROM union_events
GROUP BY "PLATFORM", "event_type"
LIMIT 20;
```
[Exploration]
2025-05-07 07:28:46 - Thread-826 (execute) - INFO - [Try to execute]
--Description: 1) Sample push-notification “send” events that occurred between 08:00 and 09:00 on 1-Jun-2023.  
SELECT
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
WHERE "TIME" >= 1685606400   -- 2023-06-01 08:00:00 UTC
  AND "TIME" <  1685610000   -- 2023-06-01 09:00:00 UTC
LIMIT 20
[Try to execute]
2025-05-07 07:28:50 - Thread-826 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 1) Sample push-notification “send” events that occurred between 08:00 and 09:00 on 1-Jun-2023.  
SELECT
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
WHERE "TIME" >= 1685606400   -- 2023-06-01 08:00:00 UTC
  AND "TIME" <  1685610000   -- 2023-06-01 09:00:00 UTC
LIMIT 20
Results:
ID,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,TIME
BR1aczOCcav7Ls,0hKOrGR184v01LJ,ViBabKznJzt7Xg1,DQ7cQECEjMwnfVF,android,1685608948
jOJfUSalo8RXMj,07Qalxf0yo64ebD,2unqYg8qHdzS2Sf,OBsOdpSj0iqEUfv,android,1685607734
ONAd55muW7uDI6,0jlM6tnu9x0wiNX,hlGuuYwrPOzXILn,2ln6gitYijMI7y1,android,1685609032
mhdH40f1q7Sl08,1EKfBfPmfxDhJNE,yNMmI42vFKxZ2V9,mJJzPQuZzsqNesB,android,1685607846
27Wv3HDrCDahTt,0CIyKv4YRfOoMx7,M0RTv3IG0DLZYp4,QxqXrdgdcbcpwHU,android,1685607519
FNcEuCRYWqMOJd,2cJE2hoTM6A

[Successfully executed]
2025-05-07 07:28:50 - Thread-826 (execute) - INFO - [Try to execute]
--Description: 2) Distinct platforms represented in “send” events during the same one-hour window.  
SELECT DISTINCT
    "PLATFORM"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20
[Try to execute]
2025-05-07 07:28:53 - Thread-826 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 2) Distinct platforms represented in “send” events during the same one-hour window.  
SELECT DISTINCT
    "PLATFORM"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20
Results:
PLATFORM
ios
android

[Successfully executed]
2025-05-07 07:28:53 - Thread-826 (execute) - INFO - [Try to execute]
--Description: 3) Distinct device models seen in “open” events in the one-hour window.  
SELECT DISTINCT
    "DEVICE_MODEL"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20
[Try to execute]
2025-05-07 07:28:57 - Thread-826 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 3) Distinct device models seen in “open” events in the one-hour window.  
SELECT DISTINCT
    "DEVICE_MODEL"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20
Results:
DEVICE_MODEL
APPLE IPHONE XS MAX
SAMSUNG GALAXY NOTE 10/10 PLUS
HUAWEI P30 PRO

[Successfully executed]
2025-05-07 07:28:57 - Thread-826 (execute) - INFO - [Try to execute]
--Description: 4) Count of push-notification sends by platform between 08:00-09:00 on 1-Jun-2023.  
SELECT
    "PLATFORM",
    COUNT(*) AS "push_notification_sends"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
GROUP BY "PLATFORM"
LIMIT 20
[Try to execute]
2025-05-07 07:29:15 - Thread-826 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 4) Count of push-notification sends by platform between 08:00-09:00 on 1-Jun-2023.  
SELECT
    "PLATFORM",
    COUNT(*) AS "push_notification_sends"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
GROUP BY "PLATFORM"
LIMIT 20
Results:
PLATFORM,push_notification_sends
ios,484
android,516

[Successfully executed]
2025-05-07 07:29:15 - Thread-826 (execute) - INFO - [Try to execute]
--Description: 5) Open events aggregated by platform with total opens and unique users in the one-hour window.  
SELECT
    "PLATFORM",
    COUNT(*)                            AS "push_notification_open",
    COUNT(DISTINCT "USER_ID")           AS "unique_push_notification_opened"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
GROUP BY "PLATFORM"
LIMIT 20
[Try to execute]
2025-05-07 07:29:21 - Thread-826 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 5) Open events aggregated by platform with total opens and unique users in the one-hour window.  
SELECT
    "PLATFORM",
    COUNT(*)                            AS "push_notification_open",
    COUNT(DISTINCT "USER_ID")           AS "unique_push_notification_opened"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
GROUP BY "PLATFORM"
LIMIT 20
Results:
PLATFORM,push_notification_open,unique_push_notification_opened
ios,103,103
android,107,107

[Successfully executed]
2025-05-07 07:29:21 - Thread-826 (execute) - INFO - [Try to execute]
--Description: 6) Sample push-notification “bounce” events that occurred during the one-hour window.  
SELECT
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20
[Try to execute]
2025-05-07 07:29:22 - Thread-826 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 6) Sample push-notification “bounce” events that occurred during the one-hour window.  
SELECT
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20
Results:
ID,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,TIME
QYMW1PkxzW3vSt,1zoENQchq3gFHhg,dXG6PLAuKAJv3vK,s9E0leDLYGJQWKO,ios,1685606766
titie50rUtSSXY,17FxHaQWRvFhF85,7F3cNEq4u3NieO4,G9QPvVZwLE2tHfF,android,1685606518
JYRhU35U88i58e,0l76sh9jpU6Cbib,cfMm7suIWeZEivg,ZyIqigV69RjgSQq,android,1685609820
SicDiROys3a5nl,2iH9coQaf7vzXcS,1iA06NmG79unwIk,WT6TwEN17xZsdQU,android,1685608580
GG5oe97e3tipmq,1PEvLoVrK1LJ4H8,inqIF2cz16Hn5mZ,JQ9T3KaYUBCg58h,android,1685606699
ir1DrQkpd2t0Pu,1iwLxMBGbe3rQSi

[Successfully executed]
2025-05-07 07:29:22 - Thread-826 (execute) - INFO - [Try to execute]
--Description: 7) Influenced-open events summarised by campaign during the one-hour window.  
SELECT
    "CAMPAIGN_ID",
    COUNT(*)                  AS "push_notification_influenced_open",
    COUNT(DISTINCT "USER_ID") AS "unique_push_notification_influenced_open"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
GROUP BY "CAMPAIGN_ID"
LIMIT 20
[Try to execute]
2025-05-07 07:29:26 - Thread-826 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 7) Influenced-open events summarised by campaign during the one-hour window.  
SELECT
    "CAMPAIGN_ID",
    COUNT(*)                  AS "push_notification_influenced_open",
    COUNT(DISTINCT "USER_ID") AS "unique_push_notification_influenced_open"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
GROUP BY "CAMPAIGN_ID"
LIMIT 20
Results:
CAMPAIGN_ID,push_notification_influenced_open,unique_push_notification_influenced_open
VMo98Fi1X5uU5F7,1,1
4ZxrKnlh6RknZWJ,1,1
scX7oYmRDvrEMhV,1,1
n6VwXwof8M30u69,1,1
KeVaP9VfkQ6vOsY,1,1
wWcnJocJ9taDYnp,1,1
3MZZwGT52JAWJUo,1,1
Ug8TAALTRsJC7yq,1,1
wDwjIOSO8xGjxiO,1,1
ElI3p60rXeDJZCY,1,1
KIe7I0aDOYKW9hT,1,1
snp4CvlFBlk627P,1,1
nFAH2RSUIuS1VnH,1,1
6fcfs1aejt9iPwy,1,1
TFY2owsV1wUqNEi,1,1
BFHnxppqFSVUDYf,1,1
ssPT3PYhP0ZJcsi,1,1
9FEBx5vhdsgoGqY,1,1
6kBHrn2McGNy3OF,1,1
F28PH2e0HRODP

[Successfully executed]
2025-05-07 07:29:26 - Thread-826 (execute) - INFO - [Try to execute]
--Description: 8) Join “send” and “open” events to list users who both received and opened the same message variation in the window.  
SELECT
    s."USER_ID",
    s."CAMPAIGN_ID",
    s."MESSAGE_VARIATION_ID",
    s."PLATFORM"              AS "send_platform",
    o."PLATFORM"              AS "open_platform",
    s."TIME"                  AS "send_time",
    o."TIME"                  AS "open_time"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"  s
JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"  o
  ON  s."USER_ID"            = o."USER_ID"
  AND s."MESSAGE_VARIATION_ID" = o."MESSAGE_VARIATION_ID"
WHERE s."TIME" >= 1685606400 AND s."TIME" < 1685610000
  AND o."TIME" >= 1685606400 AND o."TIME" < 1685610000
LIMIT 20
[Try to execute]
2025-05-07 07:29:28 - Thread-826 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 8) Join “send” and “open” events to list users who both received and opened the same message variation in the window.  
SELECT
    s."USER_ID",
    s."CAMPAIGN_ID",
    s."MESSAGE_VARIATION_ID",
    s."PLATFORM"              AS "send_platform",
    o."PLATFORM"              AS "open_platform",
    s."TIME"                  AS "send_time",
    o."TIME"                  AS "open_time"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"  s
JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"  o
  ON  s."USER_ID"            = o."USER_ID"
  AND s."MESSAGE_VARIATION_ID" = o."MESSAGE_VARIATION_ID"
WHERE s."TIME" >= 1685606400 AND s."TIME" < 1685610000
  AND o."TIME" >= 1685606400 AND o."TIME" < 1685610000
LIMIT 20
Results:
USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,send_platform,open_platform,send_time,open_time
1bmtPX5s7nn3dXU,dgHzDlkaWY9Omiv,GGXvOL6JXCmzsoh,android,android,1685607747,1685609192
0dNNtWEkeYmZw9F,g2TzdZbOSgw8pJV,u24LMtcFe0Bau5u,android,android,1685607507,1685609890
0U68Uf49vzOmKt9,Kv8vXl40m1AGhQL,S7jV5T9mBVvv8BF,android,android,1685608039,1685608183
0rBAxVTHGgkECuG,dqJp3aheAaD2NU8,dqJvyMTk4p4KT88,android,android,1685607485,1685607826
2xC9o0oWVzXQ8q5,RBXl8h4nTGaHGxV,Pl9Cvhs8xh05txe,android,androi

[Successfully executed]
2025-05-07 07:29:28 - Thread-826 (execute) - INFO - [Try to execute]
--Description: 9) Sample iOS-foreground push-notification events (user received while app in foreground) in the same window.  
SELECT
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20
[Try to execute]
2025-05-07 07:29:29 - Thread-826 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 9) Sample iOS-foreground push-notification events (user received while app in foreground) in the same window.  
SELECT
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20
Results:
ID,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,TIME
iIC1yklPto2HWi,2qLJPStfpT4tmKS,diJ3f8yv9xtFMhQ,nkpSXUzlyJO3Oe1,android,1685606588
ltL8Mdw5mjzZfl,0KpzYTyXy2nHQRI,ruOdhbn7Z1wOgEO,WXE7EM26ekOgf6B,ios,1685608515
6CuSF15u4nrUgK,0FCKTIbX7bcjTFS,MMxGjwbXJ6A9VqQ,TFtngjh5SudJ2ad,ios,1685609423
T1Y9LSAIUAKrs3,2nWWxJci31ozLx2,WeWa4gikKVqG89N,BkEOXu1pNS9t5lx,android,1685608219
sNU8M9GWWZrdC7,2DpA0pFocEiWKS0,lgSERyGek4S9aMY,lMisDaS3wV1g51R,android,1685607881
EVvQVP5ls0aRbr,0e2kf4dt67Ezzbh,K1S

[Successfully executed]
2025-05-07 07:29:29 - Thread-826 (execute) - INFO - [Try to execute]
--Description: 10) Quick multi-event comparison: total sends, opens, bounces for each platform in the one-hour window (UNION ALL then aggregate).  
WITH union_events AS (
    SELECT "PLATFORM", 'send'  AS "event_type" FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
    WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
    UNION ALL
    SELECT "PLATFORM", 'open'  FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"
    WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
    UNION ALL
    SELECT "PLATFORM", 'bounce' FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW"
    WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
)
SELECT
    "PLATFORM",
    "event_type",
    COUNT(*) AS "event_count"
FROM union_events
GROUP BY "PLATFORM", "event_type"
LIMIT 20
[Try to execute]
2025-05-07 07:29:37 - Thread-826 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 10) Quick multi-event comparison: total sends, opens, bounces for each platform in the one-hour window (UNION ALL then aggregate).  
WITH union_events AS (
    SELECT "PLATFORM", 'send'  AS "event_type" FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
    WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
    UNION ALL
    SELECT "PLATFORM", 'open'  FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"
    WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
    UNION ALL
    SELECT "PLATFORM", 'bounce' FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW"
    WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
)
SELECT
    "PLATFORM",
    "event_type",
    COUNT(*) AS "event_count"
FROM union_events
GROUP BY "PLATFORM", "event_type"
LIMIT 20
Results:
PLATFORM,event_type,event_count
ios,send,484
android,bounce,7
android,open,107
ios,open,103
ios,bounce,3
android,send,516

[Successfully executed]
2025-05-07 07:29:37 - Thread-826 (execute) - INFO - itercount: 0
2025-05-07 07:29:37 - Thread-826 (execute) - INFO - [Self-refine]
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW
Column name: PLATFORM Type: TEXT
Column name: ID Type: TEXT
Column name: MESSAGE_VARIATION_ID Type: TEXT
Column name: APP_ID Type: TEXT
Column name: CAMPAIGN_ID Type: TEXT
Column name: USER_ID Type: TEXT
Column name: APP_API_ID Type: TEXT
Column name: APP_GROUP_API_ID Type: TEXT
Column name: TIME Type: NUMBER
Column name: SF_CREATED_AT Type: TIMESTAMP_LTZ
Column name: AD_TRACKING_ENABLED Type: BOOLEAN
Column name: APP_GROUP_ID Type: TEXT
Column name: DEVICE_MODEL Type: TEXT
Column name: CARRIER Type: TEXT
Column name: BROWSER Type: TEXT
Sample rows:
[{'PLATFORM': 'android', 'ID': 'Hc1Iv6aIcwzNeW', 'MESSAGE_VARIATION_ID': 'MS7NDpmYtLv49sG', 'APP_ID': 'cavgwlQbKmE', 'CAMPAIGN_ID': 'v15fcVnCvcpFehz', 'USER_ID': '01HcGn13T509adp', 'APP_API_ID': 'NgLvvF7qSliEgW', 'APP_GROUP_API_ID': 'fKsYbbiE7hU8Li', 'TIME': 1688533671, 'SF_CREATED_AT': '2021-12-14 11:16:28.525000-08:00', 'AD_TRACKING_ENABLED': True, 'APP_GROUP_ID': 'JyWFOSKn8bq', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'CARRIER': 'j3xtkLk', 'BROWSER': 'LBFXVe3'}, {'PLATFORM': 'ios', 'ID': 'oKsbvcBxYICOW1', 'MESSAGE_VARIATION_ID': 'okYhlj8WjA032LL', 'APP_ID': 'cavgwlQbKmE', 'CAMPAIGN_ID': 'OezajA2FP4vbeoD', 'USER_ID': '33ZLxxfrv4N5wy0', 'APP_API_ID': 'u7lB2nuwUxzFSm', 'APP_GROUP_API_ID': 'yEtQUZGswVeP1X', 'TIME': 1690643557, 'SF_CREATED_AT': '2021-12-14 11:16:28.812000-08:00', 'AD_TRACKING_ENABLED': True, 'APP_GROUP_ID': 'JyWFOSKn8bq', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'CARRIER': '0Qcwx20', 'BROWSER': 'eITRtr6'}, {'PLATFORM': 'ios', 'ID': 'EjKZMIT301EhfV', 'MESSAGE_VARIATION_ID': 'kAkCZ42myvzJKKN', 'APP_ID': 'cavgwlQbKmE', 'CAMPAIGN_ID': 'U8lndpVyn6UwV1W', 'USER_ID': '1RwdaKTeiHkavOL', 'APP_API_ID': 'pVQV2P51m1BVYY', 'APP_GROUP_API_ID': 'ilhVYRwtIWF1oy', 'TIME': 1658549015, 'SF_CREATED_AT': '2021-12-14 11:16:11.490000-08:00', 'AD_TRACKING_ENABLED': True, 'APP_GROUP_ID': 'JyWFOSKn8bq', 'DEVICE_MODEL': 'HUAWEI P30 PRO', 'CARRIER': 'GkQomMp', 'BROWSER': 'hDC16LT'}, {'PLATFORM': 'android', 'ID': 'bAsR6oPSOUHTH0', 'MESSAGE_VARIATION_ID': 'SZBTcgaralR0if8', 'APP_ID': 'WleeR6PnBPb', 'CAMPAIGN_ID': 'rigyzC8DgiJjJMb', 'USER_ID': '01LG44JZd3CdJdo', 'APP_API_ID': 'ZWtiBxwmRuAjY6', 'APP_GROUP_API_ID': 'XYCeWVM62rxzll', 'TIME': 1652296354, 'SF_CREATED_AT': '2021-12-14 11:16:11.202000-08:00', 'AD_TRACKING_ENABLED': True, 'APP_GROUP_ID': 'OkIYT1HbF7u', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'CARRIER': 'i6Xetqj', 'BROWSER': '0VFzSbj'}, {'PLATFORM': 'ios', 'ID': 'UYygaUHXuT6hdA', 'MESSAGE_VARIATION_ID': 'ngEk48SmRllJ0Ub', 'APP_ID': 'WleeR6PnBPb', 'CAMPAIGN_ID': 's4SVSHz8xz6jf8W', 'USER_ID': '19C5E2XN7hwj7pJ', 'APP_API_ID': 'Y6Fw1ciycg3EW6', 'APP_GROUP_API_ID': 'CgTlfXTAxWm0lE', 'TIME': 1657431828, 'SF_CREATED_AT': '2021-12-14 11:16:12.130000-08:00', 'AD_TRACKING_ENABLED': True, 'APP_GROUP_ID': 'OkIYT1HbF7u', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'CARRIER': 'ZWcUluL', 'BROWSER': 'gV5IbYi'}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_VIEW
Column name: MESSAGE_VARIATION_API_ID Type: TEXT
Column name: BROWSER Type: TEXT
Column name: APP_ID Type: TEXT
Column name: SEND_ID Type: TEXT
Column name: DEVICE_MODEL Type: TEXT
Column name: PLATFORM Type: TEXT
Column name: APP_GROUP_API_ID Type: TEXT
Column name: APP_API_ID Type: TEXT
Column name: CAMPAIGN_API_ID Type: TEXT
Column name: APP_GROUP_ID Type: TEXT
Column name: ID Type: TEXT
Column name: DISPATCH_ID Type: TEXT
Column name: TIME Type: NUMBER
Column name: SF_CREATED_AT Type: TIMESTAMP_LTZ
Column name: CAMPAIGN_ID Type: TEXT
Column name: MESSAGE_VARIATION_ID Type: TEXT
Column name: USER_ID Type: TEXT
Column name: AD_TRACKING_ENABLED Type: BOOLEAN
Column name: CARRIER Type: TEXT
Sample rows:
[{'MESSAGE_VARIATION_API_ID': 'j5uvwemwdRPtkS', 'BROWSER': 'LNi6eLq', 'APP_ID': 'cavgwlQbKmE', 'SEND_ID': 'IHsWBtGQnt2evg', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'PLATFORM': 'android', 'APP_GROUP_API_ID': '89DbzhTflGYFCr', 'APP_API_ID': 'ZB5yvGAeChjb72', 'CAMPAIGN_API_ID': 'nI684v4sRoHNo4L', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'ID': 'k0xxl1lWnQSEBO', 'DISPATCH_ID': 'kIi1UfF3L1AKvP', 'TIME': 1680692760, 'SF_CREATED_AT': '2021-12-14 11:16:05.085000-08:00', 'CAMPAIGN_ID': 'WSlZXCVUyYDoQUv', 'MESSAGE_VARIATION_ID': 'LJa5UttXS2tXm4e', 'USER_ID': '1rv16rYZPX39xog', 'AD_TRACKING_ENABLED': True, 'CARRIER': 'hymSNGT'}, {'MESSAGE_VARIATION_API_ID': '32w4XgBOtK89Ey', 'BROWSER': 'fN7A1EZ', 'APP_ID': 'cavgwlQbKmE', 'SEND_ID': 'QuHojAUzkgD00t', 'DEVICE_MODEL': 'HUAWEI P30 PRO', 'PLATFORM': 'android', 'APP_GROUP_API_ID': 'KehmPvL3zdg9HJ', 'APP_API_ID': 'AoaSnzVPoyi9qt', 'CAMPAIGN_API_ID': 'PatOhqckTtbqLNw', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'ID': 'Yxq7VT0hvgsK5l', 'DISPATCH_ID': 'Mi6C1pRV6XovY9', 'TIME': 1665197106, 'SF_CREATED_AT': '2021-12-14 11:14:44.058000-08:00', 'CAMPAIGN_ID': 'Bf1YIuBI9fcL5yn', 'MESSAGE_VARIATION_ID': 'ikc1ihVyegYVyea', 'USER_ID': '1JLoJg1YnzkhVP4', 'AD_TRACKING_ENABLED': True, 'CARRIER': 'DcqD1Ox'}, {'MESSAGE_VARIATION_API_ID': 'dC64X56si7MtgA', 'BROWSER': 'lVsBLGh', 'APP_ID': 'cavgwlQbKmE', 'SEND_ID': 'S4Hkpp4Zd7U9L1', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'PLATFORM': 'ios', 'APP_GROUP_API_ID': 'VhotVy5sDC3oyw', 'APP_API_ID': 'doCBBzEepqnKuz', 'CAMPAIGN_API_ID': '7GZfe64AFcwkU5d', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'ID': 'J66KgIZyKe2QYe', 'DISPATCH_ID': 'iePwUnpN7anCKX', 'TIME': 1674701843, 'SF_CREATED_AT': '2021-12-14 11:15:56.813000-08:00', 'CAMPAIGN_ID': '20hyfGkLDTbBhkT', 'MESSAGE_VARIATION_ID': 'hx4ZnyHDE8PDtgr', 'USER_ID': '2dy83kVW0nfIfZK', 'AD_TRACKING_ENABLED': True, 'CARRIER': 'ikZ9nxX'}, {'MESSAGE_VARIATION_API_ID': 'A45JdaMb4FhkqU', 'BROWSER': 'yQk54RQ', 'APP_ID': 'WleeR6PnBPb', 'SEND_ID': '8sReru9Fm7U4Qn', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'PLATFORM': 'ios', 'APP_GROUP_API_ID': 'LimSTJ7isqbHxL', 'APP_API_ID': 'LEWyHi9bPKgte5', 'CAMPAIGN_API_ID': 'lmdIk2aAjaC30mn', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'ID': 'L6395n3LUuWWYe', 'DISPATCH_ID': 'CgCkHyIYWZgaMK', 'TIME': 1685727688, 'SF_CREATED_AT': '2021-12-14 11:14:48.032000-08:00', 'CAMPAIGN_ID': 'i4OwymmArxThk37', 'MESSAGE_VARIATION_ID': 'W6zQjMY9tCt2miJ', 'USER_ID': '34CwwBsuhd45Rh3', 'AD_TRACKING_ENABLED': True, 'CARRIER': 'mYw394L'}, {'MESSAGE_VARIATION_API_ID': 'yrYV3hIVVzQWNr', 'BROWSER': 'Jdueg6T', 'APP_ID': 'WleeR6PnBPb', 'SEND_ID': 'bIbmaspMRqvBVi', 'DEVICE_MODEL': 'APPLE IPHONE XS MAX', 'PLATFORM': 'ios', 'APP_GROUP_API_ID': '1atq34rbW7OtwY', 'APP_API_ID': 'thm5friuOalK6Y', 'CAMPAIGN_API_ID': 'FykRGQs5JGT3YcA', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'ID': 'M9KQ9W4gawLjfR', 'DISPATCH_ID': 'XgNyJ3Vr6W4R49', 'TIME': 1692931610, 'SF_CREATED_AT': '2021-12-14 11:15:57.061000-08:00', 'CAMPAIGN_ID': 'rH0iMS25X0gWRqm', 'MESSAGE_VARIATION_ID': 'PLoyj5bET4GIwwM', 'USER_ID': '1wUkT0GXnWGNNfS', 'AD_TRACKING_ENABLED': True, 'CARRIER': 'BUrQSe2'}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_SHARED_VIEW
Column name: AD_TRACKING_ENABLED Type: BOOLEAN
Column name: MESSAGE_VARIATION_API_ID Type: TEXT
Column name: CAMPAIGN_ID Type: TEXT
Column name: USER_ID Type: TEXT
Column name: PLATFORM Type: TEXT
Column name: ID Type: TEXT
Column name: DEVICE_MODEL Type: TEXT
Column name: TIME Type: NUMBER
Sample rows:
[{'AD_TRACKING_ENABLED': True, 'MESSAGE_VARIATION_API_ID': 'qU1t8uBDTlIIvr', 'CAMPAIGN_ID': '1b4Crn3LDcPJFfY', 'USER_ID': '0GnuCJJGV8GgqmP', 'PLATFORM': 'android', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'TIME': 1680787636}, {'AD_TRACKING_ENABLED': True, 'MESSAGE_VARIATION_API_ID': 'frPf4siaAMQmRX', 'CAMPAIGN_ID': 'jM8YmNSJGUxvoI1', 'USER_ID': '1yO1KjvB6nmwYuo', 'PLATFORM': 'android', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'TIME': 1690223871}, {'AD_TRACKING_ENABLED': True, 'MESSAGE_VARIATION_API_ID': 'VzMasP7n4wuWTz', 'CAMPAIGN_ID': '35bKrd586cO6W5t', 'USER_ID': '0tAyMAhZlNUfF5L', 'PLATFORM': 'ios', 'DEVICE_MODEL': 'HUAWEI P30 PRO', 'TIME': 1680890081}, {'AD_TRACKING_ENABLED': True, 'MESSAGE_VARIATION_API_ID': 'utz6V6lNGrpdCY', 'CAMPAIGN_ID': 'p96a8Sw1kI8q51B', 'USER_ID': '1qDbLVkxWn1q1mH', 'PLATFORM': 'android', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'TIME': 1691986557}, {'AD_TRACKING_ENABLED': True, 'MESSAGE_VARIATION_API_ID': 'WOHKpcfJkVgh0R', 'CAMPAIGN_ID': 'uWySmvwgvbwTJ3D', 'USER_ID': '1qrPDrAHrU6NB0p', 'PLATFORM': 'ios', 'DEVICE_MODEL': 'HUAWEI P30 PRO', 'TIME': 1691273523}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW
Column name: MESSAGE_VARIATION_ID Type: TEXT
Column name: SF_CREATED_AT Type: TIMESTAMP_LTZ
Column name: TIME Type: NUMBER
Column name: PLATFORM Type: TEXT
Column name: USER_ID Type: TEXT
Column name: ID Type: TEXT
Column name: APP_GROUP_ID Type: TEXT
Column name: AD_TRACKING_ENABLED Type: BOOLEAN
Column name: CAMPAIGN_ID Type: TEXT
Sample rows:
[{'MESSAGE_VARIATION_ID': 'dv7cyxmLjXAHLr1', 'SF_CREATED_AT': '2021-12-14 11:17:38.135000-08:00', 'PLATFORM': 'android', 'USER_ID': '1ozEahxyc2abh48', 'ID': 'l2pRHH03p3rNKQ', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'AD_TRACKING_ENABLED': True, 'CAMPAIGN_ID': 'WUWF171IL9Y8zT4'}, {'MESSAGE_VARIATION_ID': '4Gmnf9yXWnUsLEE', 'SF_CREATED_AT': '2021-12-14 11:17:38.333000-08:00', 'PLATFORM': 'android', 'USER_ID': '0XgcLFFDjphFiOX', 'ID': 'YamKzAZrlJSrpV', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'AD_TRACKING_ENABLED': True, 'CAMPAIGN_ID': '8Ih99pbTHK95mnc'}, {'MESSAGE_VARIATION_ID': '8zms93AOs32n6Fk', 'SF_CREATED_AT': '2021-12-14 11:17:38.135000-08:00', 'PLATFORM': 'ios', 'USER_ID': '1CNcSx4WjnmgQp1', 'ID': 'e9atU6myPmtS0K', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'AD_TRACKING_ENABLED': True, 'CAMPAIGN_ID': 'NNWSBRr6MaWCMK2'}, {'MESSAGE_VARIATION_ID': 'GamGQtsQEPlO9fJ', 'SF_CREATED_AT': '2021-12-14 11:18:00-08:00', 'PLATFORM': 'ios', 'USER_ID': '1DJMPvQ1CF3F9vu', 'ID': 'M2q9dBXWTaSuzt', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'AD_TRACKING_ENABLED': True, 'CAMPAIGN_ID': 'neE5WoL5K2uGAUy'}, {'MESSAGE_VARIATION_ID': 'pun9TLDiT2FuMMD', 'SF_CREATED_AT': '2021-12-14 11:17:55.430000-08:00', 'PLATFORM': 'ios', 'USER_ID': '30641y1RaIc6WbP', 'ID': 'DSRPpLtNks1KbX', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'AD_TRACKING_ENABLED': True, 'CAMPAIGN_ID': 'C7D49eFmKHwUNVY'}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_CAMPAIGNS_ENROLLINCONTROL_VIEW
Column name: APP_ID Type: TEXT
Column name: TIME Type: NUMBER
Column name: MESSAGE_VARIATION_ID Type: TEXT
Column name: USER_ID Type: TEXT
Column name: APP_GROUP_ID Type: TEXT
Column name: ID Type: TEXT
Column name: CAMPAIGN_ID Type: TEXT
Sample rows:
[{'APP_ID': 'cavgwlQbKmE', 'TIME': 1630486337, 'MESSAGE_VARIATION_ID': '4YDlo21KDnxfAkC', 'USER_ID': '1D67jDbDZ1s9nAI', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'CAMPAIGN_ID': 'UVCRPe5AIq7VwSx'}, {'APP_ID': 'cavgwlQbKmE', 'TIME': 1664767851, 'MESSAGE_VARIATION_ID': 'h9C0MgvmNZORUiW', 'USER_ID': '04EFw55bmRtHShh', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'CAMPAIGN_ID': 'R54gcVYRz9OJ6bI'}, {'APP_ID': 'WleeR6PnBPb', 'TIME': 1646166007, 'MESSAGE_VARIATION_ID': 'iB7OQSxudLTViuI', 'USER_ID': '2BTimyDzdioEd1g', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'CAMPAIGN_ID': '0PVzemOysFYy6yg'}, {'APP_ID': 'cavgwlQbKmE', 'TIME': 1676151296, 'MESSAGE_VARIATION_ID': 'cwx3BVcFYGWzAYc', 'USER_ID': '24AFGd5e8uDoXkJ', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'CAMPAIGN_ID': 'WnoNybWawFF9uFe'}, {'APP_ID': 'WleeR6PnBPb', 'TIME': 1643352534, 'MESSAGE_VARIATION_ID': 'd6grikJed9T9PSs', 'USER_ID': '0ubg8mmgolDToaz', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'CAMPAIGN_ID': 'sximVDY7BpbHNGv'}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW
Column name: MESSAGE_VARIATION_ID Type: TEXT
Column name: CAMPAIGN_ID Type: TEXT
Column name: SF_CREATED_AT Type: TIMESTAMP_LTZ
Column name: ID Type: TEXT
Column name: PLATFORM Type: TEXT
Column name: USER_ID Type: TEXT
Column name: TIME Type: NUMBER
Sample rows:
[{'MESSAGE_VARIATION_ID': '53NwKNR9MSRc5IH', 'CAMPAIGN_ID': '58h8RRp5cjh7dZr', 'SF_CREATED_AT': '2021-12-14 11:16:07.659000-08:00', 'PLATFORM': 'ios', 'USER_ID': '1dRCeEIuKZ8Esep'}, {'MESSAGE_VARIATION_ID': '0VPF1QZtOCDJq8O', 'CAMPAIGN_ID': 'NWWjVWwPX140u5s', 'SF_CREATED_AT': '2021-12-14 11:16:08.677000-08:00', 'PLATFORM': 'ios', 'USER_ID': '0tb7p0FKWQnBy1S'}, {'MESSAGE_VARIATION_ID': '7Yf7LLyMAzg1IUb', 'CAMPAIGN_ID': 'Sv3BmuYe2qJEWQS', 'SF_CREATED_AT': '2021-12-14 11:16:09.322000-08:00', 'PLATFORM': 'android', 'USER_ID': '1n6jqoooaPLONqP'}, {'MESSAGE_VARIATION_ID': 'Z8NEPdmuaukppii', 'CAMPAIGN_ID': 'HifherE5Tk7bAAn', 'SF_CREATED_AT': '2021-12-14 11:16:08.756000-08:00', 'PLATFORM': 'android', 'USER_ID': '2ccovMaIiTfhofK'}, {'MESSAGE_VARIATION_ID': 'Y98AKtTCAIVAUhg', 'CAMPAIGN_ID': '7JPBzPEEyxas2XK', 'SF_CREATED_AT': '2021-12-14 11:14:25.683000-08:00', 'PLATFORM': 'android', 'USER_ID': '2ex1BB4abO679Uw'}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_SHARED_VIEW
Column name: AD_TRACKING_ENABLED Type: BOOLEAN
Column name: PLATFORM Type: TEXT
Column name: APP_GROUP_ID Type: TEXT
Column name: USER_ID Type: TEXT
Column name: MESSAGE_VARIATION_API_ID Type: TEXT
Column name: ID Type: TEXT
Column name: CAMPAIGN_ID Type: TEXT
Column name: CARRIER Type: TEXT
Column name: BROWSER Type: TEXT
Column name: TIME Type: NUMBER
Column name: DEVICE_MODEL Type: TEXT
Sample rows:
[{'AD_TRACKING_ENABLED': True, 'PLATFORM': 'ios', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'USER_ID': '1l56ymrYc0Kr7L9', 'MESSAGE_VARIATION_API_ID': 'mOKZKQIMy4eoJK', 'CAMPAIGN_ID': 'yVtDpA2JCpTMloj', 'CARRIER': 'nSWyOLT', 'BROWSER': 'Z8c8boT', 'TIME': 1689750584, 'DEVICE_MODEL': 'APPLE IPHONE XS MAX'}, {'AD_TRACKING_ENABLED': True, 'PLATFORM': 'ios', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'USER_ID': '1ptY9FvxAY5xTvx', 'MESSAGE_VARIATION_API_ID': 'eY2iP8DyEu3fs7', 'CAMPAIGN_ID': 'U9HqCw7BrfPHydp', 'CARRIER': '78kEQ0c', 'BROWSER': 'cn5pbJp', 'TIME': 1693107569, 'DEVICE_MODEL': 'APPLE IPHONE XS MAX'}, {'AD_TRACKING_ENABLED': True, 'PLATFORM': 'android', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'USER_ID': '0pk0dTIPvIDBbKj', 'MESSAGE_VARIATION_API_ID': 'QFXKByYiF9Jwfs', 'CAMPAIGN_ID': 'Qja5gABJUx2WzNR', 'CARRIER': 'BJ8zcay', 'BROWSER': '6SIdUtz', 'TIME': 1684397837, 'DEVICE_MODEL': 'APPLE IPHONE XS MAX'}, {'AD_TRACKING_ENABLED': True, 'PLATFORM': 'ios', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'USER_ID': '07LAiBfAEhTqMuW', 'MESSAGE_VARIATION_API_ID': 'bp4gOxOrLdMKQE', 'CAMPAIGN_ID': 'iyDNPIoMgVrCScw', 'CARRIER': '2sE3lNu', 'BROWSER': 'LLVLj6N', 'TIME': 1691255796, 'DEVICE_MODEL': 'HUAWEI P30 PRO'}, {'AD_TRACKING_ENABLED': True, 'PLATFORM': 'android', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'USER_ID': '2OhG8HzLZKfSMv8', 'MESSAGE_VARIATION_API_ID': 'jJyqbh9XBjvThU', 'CAMPAIGN_ID': 'o5pJWezrug0ICjL', 'CARRIER': 'vUecmST', 'BROWSER': 'edWrZ4A', 'TIME': 1692812020, 'DEVICE_MODEL': 'HUAWEI P30 PRO'}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_SHARED_VIEW
Column name: PLATFORM Type: TEXT
Column name: USER_ID Type: TEXT
Column name: TIME Type: NUMBER
Column name: MESSAGE_VARIATION_API_ID Type: TEXT
Column name: ID Type: TEXT
Sample rows:
[{'PLATFORM': 'ios', 'USER_ID': '0lL7oak0UWagKyU', 'TIME': 1693362990, 'MESSAGE_VARIATION_API_ID': 'nvIZW4Gc4cWmo0'}, {'PLATFORM': 'android', 'USER_ID': '1XulAf3cAOSwB3W', 'TIME': 1685948542, 'MESSAGE_VARIATION_API_ID': '1rKOMlnzSQ7Wus'}, {'PLATFORM': 'android', 'USER_ID': '0BlSnAPNt8tfJkp', 'TIME': 1682498789, 'MESSAGE_VARIATION_API_ID': 'ootTeZZe20idd1'}, {'PLATFORM': 'android', 'USER_ID': '0CHNabJAxHe9IJA', 'TIME': 1675208701, 'MESSAGE_VARIATION_API_ID': 'OFdeH8ArLJJwXs'}, {'PLATFORM': 'android', 'USER_ID': '0GHEyFlipKACmHm', 'TIME': 1692450056, 'MESSAGE_VARIATION_API_ID': 'qW90WZ2a5RMfEV'}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_SHARED_VIEW
Column name: MESSAGE_VARIATION_API_ID Type: TEXT
Column name: TIME Type: NUMBER
Column name: ID Type: TEXT
Column name: PLATFORM Type: TEXT
Column name: CAMPAIGN_ID Type: TEXT
Column name: APP_GROUP_ID Type: TEXT
Column name: USER_ID Type: TEXT
Column name: AD_TRACKING_ENABLED Type: BOOLEAN
Sample rows:
[{'MESSAGE_VARIATION_API_ID': 'a3FcGsCQEUX6li', 'TIME': 1690642972, 'PLATFORM': 'android', 'CAMPAIGN_ID': 'eivJmWT6f2bB3F0', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'USER_ID': '1Vhr7od4uu4dGqg', 'AD_TRACKING_ENABLED': True}, {'MESSAGE_VARIATION_API_ID': 'ZpngLB2XrppT33', 'TIME': 1686292880, 'PLATFORM': 'ios', 'CAMPAIGN_ID': 'vWwH0WOV5wVCdpP', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'USER_ID': '1Vk4XLPTPNc0P5u', 'AD_TRACKING_ENABLED': True}, {'MESSAGE_VARIATION_API_ID': 'M3MYgVx8Y2oNb5', 'TIME': 1680917163, 'PLATFORM': 'android', 'CAMPAIGN_ID': 'zby0CTZmUsO1Yl3', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'USER_ID': '1W8FUwMymtpeQDX', 'AD_TRACKING_ENABLED': True}, {'MESSAGE_VARIATION_API_ID': 'ZwRSohifXoYcSa', 'TIME': 1685781311, 'PLATFORM': 'ios', 'CAMPAIGN_ID': 'xOLIHdZxDvrclPC', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'USER_ID': '1VZLZK4nwMZHyiP', 'AD_TRACKING_ENABLED': True}, {'MESSAGE_VARIATION_API_ID': 'OUzqdQOpsJqloO', 'TIME': 1655666409, 'PLATFORM': 'ios', 'CAMPAIGN_ID': 'n6VwXwof8M30u69', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'USER_ID': '1VwhzrGCYj4G7yZ', 'AD_TRACKING_ENABLED': True}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW
Column name: USER_ID Type: TEXT
Column name: MESSAGE_VARIATION_ID Type: TEXT
Column name: PLATFORM Type: TEXT
Column name: TIME Type: NUMBER
Column name: CAMPAIGN_ID Type: TEXT
Column name: APP_GROUP_ID Type: TEXT
Column name: AD_TRACKING_ENABLED Type: BOOLEAN
Column name: ID Type: TEXT
Sample rows:
[{'USER_ID': '2TcIEwF3b000naI', 'MESSAGE_VARIATION_ID': 'okWUvcJtNoLwKCo', 'PLATFORM': 'ios', 'TIME': 1689990591, 'CAMPAIGN_ID': 'WiLO2VZ0fj50DrT', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'AD_TRACKING_ENABLED': True}, {'USER_ID': '2TfnOwCCtafuJPi', 'MESSAGE_VARIATION_ID': 'YTg7alAK0JG0CDn', 'PLATFORM': 'ios', 'TIME': 1651389539, 'CAMPAIGN_ID': 'WGinxN5BQPYQofb', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'AD_TRACKING_ENABLED': True}, {'USER_ID': '2UEp938n6Y3LWwN', 'MESSAGE_VARIATION_ID': 'xLjSkv862cKHQyu', 'PLATFORM': 'android', 'TIME': 1680812889, 'CAMPAIGN_ID': 'nxOMIJIzkPPj75z', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'AD_TRACKING_ENABLED': True}, {'USER_ID': '2TX8wX0YcPtzzLA', 'MESSAGE_VARIATION_ID': 'Q1FlJjDZHAmBqHq', 'PLATFORM': 'ios', 'TIME': 1664846591, 'CAMPAIGN_ID': 'VFYN9QWk6h6fmAn', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'AD_TRACKING_ENABLED': True}, {'USER_ID': '2TnYaz613nOVHyW', 'MESSAGE_VARIATION_ID': 'GfkzbQ99IDga7g6', 'PLATFORM': 'android', 'TIME': 1679999803, 'CAMPAIGN_ID': 'Jv0XoRCDYyNplqs', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'AD_TRACKING_ENABLED': True}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_SHARED_VIEW
Column name: PLATFORM Type: TEXT
Column name: ID Type: TEXT
Column name: CAMPAIGN_ID Type: TEXT
Column name: USER_ID Type: TEXT
Column name: MESSAGE_VARIATION_API_ID Type: TEXT
Column name: TIME Type: NUMBER
Sample rows:
[{'PLATFORM': 'android', 'CAMPAIGN_ID': 'loPFcRNkEIeyDTC', 'USER_ID': '1ThK0Tfzzjo6C35', 'MESSAGE_VARIATION_API_ID': 'DJqv9T494HxaMM', 'TIME': 1665435755}, {'PLATFORM': 'ios', 'CAMPAIGN_ID': 'lPNNGio8wkxocHJ', 'USER_ID': '2iYSDGm3afLWJzp', 'MESSAGE_VARIATION_API_ID': 'bDL7fmDLfRbbdU', 'TIME': 1674733934}, {'PLATFORM': 'android', 'CAMPAIGN_ID': 'fau5DW9R3tXHpLb', 'USER_ID': '28xEpmvPj2cC2mO', 'MESSAGE_VARIATION_API_ID': 'm8bxZOrZZiNB12', 'TIME': 1674786226}, {'PLATFORM': 'android', 'CAMPAIGN_ID': 'zfAz0UFA42Op3XK', 'USER_ID': '0F3flaXfCmNzjLq', 'MESSAGE_VARIATION_API_ID': 'h6O2YytJwAIe0J', 'TIME': 1639910277}, {'PLATFORM': 'ios', 'CAMPAIGN_ID': 'HqlJhauAE0gMYa1', 'USER_ID': '1BgLSozIm7s93cI', 'MESSAGE_VARIATION_API_ID': '1IrLyFo2YUWIqP', 'TIME': 1663792947}]

--------------------------------------------------
External knowledge that might be helpful: 
# Push Notification Analysis

## Overview
This document details an SQL query that analyzes user responses to push notifications within the timeframe of 8:00 AM to 9:00 AM on June 1, 2023. It is designed to assess the impact and effectiveness of push notification campaigns across various metrics.

## Data Sources
The analysis utilizes four distinct subqueries pulling from push notification event views:
- **Send Events**
- **Bounce Events**
- **Open Events**
- **Influenced Open Events**

## Query Description
Each subquery counts and categorizes events based on the type of interaction (sent, bounced, opened, influenced open), along with detailed user and device information.

### Send Events
- **Table**: `USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW`
- **Columns**: ID, app group ID, user ID, campaign ID, message variation ID, platform, ad tracking enabled, event timestamp

### Bounce Events
- **Table**: `USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW`
- **Columns**: Same as Send Events

### Open Events
- **Table**: `USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW`
- **Columns**: Same as Send Events plus carrier, browser, and device model

### Influenced Open Events
- **Table**: `USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW`
- **Columns**: Same as Open Events

## Results Aggregation
The final output of the query is grouped by:
- App Group ID
- Campaign ID
- User ID
- Message Variation ID
- Platform
- Ad Tracking Enabled
- Device Information (Carrier, Browser, Device Model)

### Metrics Included
- `push_notification_sends`: Total number of notifications sent.
- `unique_push_notification_sends`: Number of unique users who received notifications.
- `push_notification_bounced`: Total number of notifications that bounced.
- `unique_push_notification_bounced`: Number of unique users who received bounced notifications.
- `push_notification_open`: Total number of notifications opened.
- `unique_push_notification_opened`: Number of unique users who opened notifications.
- `push_notification_influenced_open`: Total number of indirectly opened notifications.
- `unique_push_notification_influenced_open`: Number of unique users who opened notifications indirectly.

## Conclusion
This analysis provides valuable insights into the reach and responsiveness of users to push notifications, helping to guide future marketing strategies and campaign optimizations.

The table structure information is ({database name: {schema name: [table name]}}): 
{'BRAZE_USER_EVENT_DEMO_DATASET': {'PUBLIC': ['USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_OPEN_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW', 'USERS_CAMPAIGNS_ENROLLINCONTROL_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_SEND_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_SHARED_VIEW']}}

Some few-shot examples after column exploration may be helpful:
Query:
--Description: 1) Sample push-notification “send” events that occurred between 08:00 and 09:00 on 1-Jun-2023.  
SELECT
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
WHERE "TIME" >= 1685606400   -- 2023-06-01 08:00:00 UTC
  AND "TIME" <  1685610000   -- 2023-06-01 09:00:00 UTC
LIMIT 20
Answer:
ID,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,TIME
BR1aczOCcav7Ls,0hKOrGR184v01LJ,ViBabKznJzt7Xg1,DQ7cQECEjMwnfVF,android,1685608948
jOJfUSalo8RXMj,07Qalxf0yo64ebD,2unqYg8qHdzS2Sf,OBsOdpSj0iqEUfv,android,1685607734
ONAd55muW7uDI6,0jlM6tnu9x0wiNX,hlGuuYwrPOzXILn,2ln6gitYijMI7y1,android,1685609032
mhdH40f1q7Sl08,1EKfBfPmfxDhJNE,yNMmI42vFKxZ2V9,mJJzPQuZzsqNesB,android,1685607846
27Wv3HDrCDahTt,0CIyKv4YRfOoMx7,M0RTv3IG0DLZYp4,QxqXrdgdcbcpwHU,android,1685607519
FNcEuCRYWqMOJd,2cJE2hoTM6A
Query:
--Description: 2) Distinct platforms represented in “send” events during the same one-hour window.  
SELECT DISTINCT
    "PLATFORM"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20
Answer:
PLATFORM
ios
android
Query:
--Description: 3) Distinct device models seen in “open” events in the one-hour window.  
SELECT DISTINCT
    "DEVICE_MODEL"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20
Answer:
DEVICE_MODEL
APPLE IPHONE XS MAX
SAMSUNG GALAXY NOTE 10/10 PLUS
HUAWEI P30 PRO
Query:
--Description: 4) Count of push-notification sends by platform between 08:00-09:00 on 1-Jun-2023.  
SELECT
    "PLATFORM",
    COUNT(*) AS "push_notification_sends"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
GROUP BY "PLATFORM"
LIMIT 20
Answer:
PLATFORM,push_notification_sends
ios,484
android,516
Query:
--Description: 5) Open events aggregated by platform with total opens and unique users in the one-hour window.  
SELECT
    "PLATFORM",
    COUNT(*)                            AS "push_notification_open",
    COUNT(DISTINCT "USER_ID")           AS "unique_push_notification_opened"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
GROUP BY "PLATFORM"
LIMIT 20
Answer:
PLATFORM,push_notification_open,unique_push_notification_opened
ios,103,103
android,107,107
Query:
--Description: 6) Sample push-notification “bounce” events that occurred during the one-hour window.  
SELECT
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20
Answer:
ID,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,TIME
QYMW1PkxzW3vSt,1zoENQchq3gFHhg,dXG6PLAuKAJv3vK,s9E0leDLYGJQWKO,ios,1685606766
titie50rUtSSXY,17FxHaQWRvFhF85,7F3cNEq4u3NieO4,G9QPvVZwLE2tHfF,android,1685606518
JYRhU35U88i58e,0l76sh9jpU6Cbib,cfMm7suIWeZEivg,ZyIqigV69RjgSQq,android,1685609820
SicDiROys3a5nl,2iH9coQaf7vzXcS,1iA06NmG79unwIk,WT6TwEN17xZsdQU,android,1685608580
GG5oe97e3tipmq,1PEvLoVrK1LJ4H8,inqIF2cz16Hn5mZ,JQ9T3KaYUBCg58h,android,1685606699
ir1DrQkpd2t0Pu,1iwLxMBGbe3rQSi
Query:
--Description: 7) Influenced-open events summarised by campaign during the one-hour window.  
SELECT
    "CAMPAIGN_ID",
    COUNT(*)                  AS "push_notification_influenced_open",
    COUNT(DISTINCT "USER_ID") AS "unique_push_notification_influenced_open"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
GROUP BY "CAMPAIGN_ID"
LIMIT 20
Answer:
CAMPAIGN_ID,push_notification_influenced_open,unique_push_notification_influenced_open
VMo98Fi1X5uU5F7,1,1
4ZxrKnlh6RknZWJ,1,1
scX7oYmRDvrEMhV,1,1
n6VwXwof8M30u69,1,1
KeVaP9VfkQ6vOsY,1,1
wWcnJocJ9taDYnp,1,1
3MZZwGT52JAWJUo,1,1
Ug8TAALTRsJC7yq,1,1
wDwjIOSO8xGjxiO,1,1
ElI3p60rXeDJZCY,1,1
KIe7I0aDOYKW9hT,1,1
snp4CvlFBlk627P,1,1
nFAH2RSUIuS1VnH,1,1
6fcfs1aejt9iPwy,1,1
TFY2owsV1wUqNEi,1,1
BFHnxppqFSVUDYf,1,1
ssPT3PYhP0ZJcsi,1,1
9FEBx5vhdsgoGqY,1,1
6kBHrn2McGNy3OF,1,1
F28PH2e0HRODP
Query:
--Description: 8) Join “send” and “open” events to list users who both received and opened the same message variation in the window.  
SELECT
    s."USER_ID",
    s."CAMPAIGN_ID",
    s."MESSAGE_VARIATION_ID",
    s."PLATFORM"              AS "send_platform",
    o."PLATFORM"              AS "open_platform",
    s."TIME"                  AS "send_time",
    o."TIME"                  AS "open_time"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"  s
JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"  o
  ON  s."USER_ID"            = o."USER_ID"
  AND s."MESSAGE_VARIATION_ID" = o."MESSAGE_VARIATION_ID"
WHERE s."TIME" >= 1685606400 AND s."TIME" < 1685610000
  AND o."TIME" >= 1685606400 AND o."TIME" < 1685610000
LIMIT 20
Answer:
USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,send_platform,open_platform,send_time,open_time
1bmtPX5s7nn3dXU,dgHzDlkaWY9Omiv,GGXvOL6JXCmzsoh,android,android,1685607747,1685609192
0dNNtWEkeYmZw9F,g2TzdZbOSgw8pJV,u24LMtcFe0Bau5u,android,android,1685607507,1685609890
0U68Uf49vzOmKt9,Kv8vXl40m1AGhQL,S7jV5T9mBVvv8BF,android,android,1685608039,1685608183
0rBAxVTHGgkECuG,dqJp3aheAaD2NU8,dqJvyMTk4p4KT88,android,android,1685607485,1685607826
2xC9o0oWVzXQ8q5,RBXl8h4nTGaHGxV,Pl9Cvhs8xh05txe,android,androi
Query:
--Description: 9) Sample iOS-foreground push-notification events (user received while app in foreground) in the same window.  
SELECT
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_VIEW"
WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
LIMIT 20
Answer:
ID,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,TIME
iIC1yklPto2HWi,2qLJPStfpT4tmKS,diJ3f8yv9xtFMhQ,nkpSXUzlyJO3Oe1,android,1685606588
ltL8Mdw5mjzZfl,0KpzYTyXy2nHQRI,ruOdhbn7Z1wOgEO,WXE7EM26ekOgf6B,ios,1685608515
6CuSF15u4nrUgK,0FCKTIbX7bcjTFS,MMxGjwbXJ6A9VqQ,TFtngjh5SudJ2ad,ios,1685609423
T1Y9LSAIUAKrs3,2nWWxJci31ozLx2,WeWa4gikKVqG89N,BkEOXu1pNS9t5lx,android,1685608219
sNU8M9GWWZrdC7,2DpA0pFocEiWKS0,lgSERyGek4S9aMY,lMisDaS3wV1g51R,android,1685607881
EVvQVP5ls0aRbr,0e2kf4dt67Ezzbh,K1S
Query:
--Description: 10) Quick multi-event comparison: total sends, opens, bounces for each platform in the one-hour window (UNION ALL then aggregate).  
WITH union_events AS (
    SELECT "PLATFORM", 'send'  AS "event_type" FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
    WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
    UNION ALL
    SELECT "PLATFORM", 'open'  FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"
    WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
    UNION ALL
    SELECT "PLATFORM", 'bounce' FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW"
    WHERE "TIME" >= 1685606400 AND "TIME" < 1685610000
)
SELECT
    "PLATFORM",
    "event_type",
    COUNT(*) AS "event_count"
FROM union_events
GROUP BY "PLATFORM", "event_type"
LIMIT 20
Answer:
PLATFORM,event_type,event_count
ios,send,484
android,bounce,7
android,open,107
ios,open,103
ios,bounce,3
android,send,516
Task: Examine user engagement with push notifications within a specified one-hour window on June 1, 2023.

Please think step by step and answer only one complete SQL in snowflake dialect in ```sql``` format.
SQL usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'BRAZE_USER_EVENT_DEMO_DATASET': {'PUBLIC': ['USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_OPEN_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW', 'USERS_CAMPAIGNS_ENROLLINCONTROL_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_SEND_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_SHARED_VIEW']}}

When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
If the task description does not specify the number of decimal places, retain all decimals to four places.

[Self-refine]
2025-05-07 07:30:59 - Thread-826 (execute) - INFO - [Try to run SQL in self-refine]
```sql
/* Examine user engagement with push-notifications between
   08:00 and 09:00 UTC on 01-Jun-2023 (Unix time 1 685 606 400-1 685 610 000) */

WITH union_events AS (

    /* Sends */
    SELECT
        "PLATFORM",
        "USER_ID",
        'send' AS "event_type"
    FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW"
    WHERE "TIME" >= 1685606400
      AND "TIME" <  1685610000

    UNION ALL

    /* Bounces */
    SELECT
        "PLATFORM",
        "USER_ID",
        'bounce' AS "event_type"
    FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW"
    WHERE "TIME" >= 1685606400
      AND "TIME" <  1685610000

    UNION ALL

    /* Opens */
    SELECT
        "PLATFORM",
        "USER_ID",
        'open' AS "event_type"
    FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW"
    WHERE "TIME" >= 1685606400
      AND "TIME" <  1685610000

    UNION ALL

    /* Influenced Opens */
    SELECT
        "PLATFORM",
        "USER_ID",
        'influenced_open' AS "event_type"
    FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC."USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW"
    WHERE "TIME" >= 1685606400
      AND "TIME" <  1685610000
)

SELECT
    "PLATFORM",

    /* Sends */
    SUM( CASE WHEN "event_type" = 'send'            THEN 1 ELSE 0 END )                                   AS "push_notification_sends",
    COUNT( DISTINCT CASE WHEN "event_type" = 'send' THEN "USER_ID" END )                                   AS "unique_push_notification_sends",

    /* Bounces */
    SUM( CASE WHEN "event_type" = 'bounce'          THEN 1 ELSE 0 END )                                   AS "push_notification_bounced",
    COUNT( DISTINCT CASE WHEN "event_type" = 'bounce' THEN "USER_ID" END )                                 AS "unique_push_notification_bounced",

    /* Opens */
    SUM( CASE WHEN "event_type" = 'open'            THEN 1 ELSE 0 END )                                   AS "push_notification_open",
    COUNT( DISTINCT CASE WHEN "event_type" = 'open' THEN "USER_ID" END )                                   AS "unique_push_notification_opened",

    /* Influenced Opens */
    SUM( CASE WHEN "event_type" = 'influenced_open' THEN 1 ELSE 0 END )                                   AS "push_notification_influenced_open",
    COUNT( DISTINCT CASE WHEN "event_type" = 'influenced_open' THEN "USER_ID" END )                        AS "unique_push_notification_influenced_open"

FROM union_events
GROUP BY "PLATFORM"
ORDER BY "PLATFORM" NULLS LAST;
```
[Try to run SQL in self-refine]
2025-05-07 07:31:02 - Thread-826 (execute) - INFO - Total iteration counts: 0
