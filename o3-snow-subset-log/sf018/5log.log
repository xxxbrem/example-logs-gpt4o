2025-05-07 07:29:34 - Thread-830 (execute) - INFO - [Exploration]
```sql
--Description: 1) Inspect raw push-notification “send” events that occurred between 08:00 and 09:00 UTC on 1-Jun-2023.
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "APP_GROUP_ID",
    "AD_TRACKING_ENABLED",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
```

```sql
--Description: 2) List distinct users who received at least one push notification in that hour.
SELECT DISTINCT 
    "USER_ID"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
```

```sql
--Description: 3) Examine bounce events in the same time window to see which notifications failed.
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "APP_GROUP_ID",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
```

```sql
--Description: 4) Look at open events (users actually tapped the push) during the hour, including device data.
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "DEVICE_MODEL",
    "CARRIER",
    "BROWSER",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
```

```sql
--Description: 5) Retrieve the different mobile carriers associated with openings in that hour.
SELECT DISTINCT 
    "CARRIER"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
```

```sql
--Description: 6) Inspect “influenced open” events (user opened the app within attrib-window after seeing push).
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
```

```sql
--Description: 7) Aggregate: number of sends by platform for the one-hour window.
SELECT 
    "PLATFORM",
    COUNT(*)                       AS "push_notification_sends"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
GROUP BY "PLATFORM"
LIMIT 20;
```

```sql
--Description: 8) Join sends with opens to see which sends were actually opened (sample 20 rows).
SELECT 
    s."ID"                         AS "send_id",
    s."USER_ID",
    s."CAMPAIGN_ID",
    s."MESSAGE_VARIATION_ID",
    s."PLATFORM",
    o."ID"                         AS "open_id",
    o."TIME"                       AS "open_time"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW  s
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW o
      ON  s."USER_ID"              = o."USER_ID"
      AND s."MESSAGE_VARIATION_ID" = o."MESSAGE_VARIATION_ID"
      AND o."TIME" BETWEEN 1685606400 AND 1685610000
WHERE s."TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
```

```sql
--Description: 9) Campaign-level open-vs-send counts in the time window (top 20).
SELECT
    s."CAMPAIGN_ID",
    COUNT(*)                                     AS "push_notification_sends",
    COUNT(o."ID")                                AS "push_notification_open"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW  s
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW o
      ON  s."USER_ID"              = o."USER_ID"
      AND s."MESSAGE_VARIATION_ID" = o."MESSAGE_VARIATION_ID"
      AND o."TIME" BETWEEN 1685606400 AND 1685610000
WHERE s."TIME" BETWEEN 1685606400 AND 1685610000
GROUP BY s."CAMPAIGN_ID"
LIMIT 20;
```

```sql
--Description: 10) Consolidated metrics (sends, bounces, opens, influenced opens) for each campaign in the hour.
SELECT
    COALESCE(s."CAMPAIGN_ID", b."CAMPAIGN_ID", o."CAMPAIGN_ID", i."CAMPAIGN_ID") AS "CAMPAIGN_ID",
    COUNT(DISTINCT s."ID")  AS "push_notification_sends",
    COUNT(DISTINCT b."ID")  AS "push_notification_bounced",
    COUNT(DISTINCT o."ID")  AS "push_notification_open",
    COUNT(DISTINCT i."ID")  AS "push_notification_influenced_open"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW           s
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW    b
       ON s."CAMPAIGN_ID" = b."CAMPAIGN_ID"
      AND b."TIME" BETWEEN 1685606400 AND 1685610000
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW      o
       ON s."CAMPAIGN_ID" = o."CAMPAIGN_ID"
      AND o."TIME" BETWEEN 1685606400 AND 1685610000
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW i
       ON s."CAMPAIGN_ID" = i."CAMPAIGN_ID"
      AND i."TIME" BETWEEN 1685606400 AND 1685610000
WHERE s."TIME" BETWEEN 1685606400 AND 1685610000
GROUP BY COALESCE(s."CAMPAIGN_ID", b."CAMPAIGN_ID", o."CAMPAIGN_ID", i."CAMPAIGN_ID")
LIMIT 20;
```
[Exploration]
2025-05-07 07:29:34 - Thread-830 (execute) - INFO - [Try to execute]
--Description: 1) Inspect raw push-notification “send” events that occurred between 08:00 and 09:00 UTC on 1-Jun-2023.
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "APP_GROUP_ID",
    "AD_TRACKING_ENABLED",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
[Try to execute]
2025-05-07 07:29:36 - Thread-830 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 1) Inspect raw push-notification “send” events that occurred between 08:00 and 09:00 UTC on 1-Jun-2023.
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "APP_GROUP_ID",
    "AD_TRACKING_ENABLED",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
Results:
ID,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,APP_GROUP_ID,AD_TRACKING_ENABLED,TIME
CTIY0Wgh9t1mZo,33JXzkDPuOIH9K3,iCU1rgIA4Su6K9u,W8QOJOzUiP7c4tw,ios,JyWFOSKn8bq,True,1685607585
zFpyZLpJpf0UMb,0ouZEQXOkJDHXcv,Wip7esv4UPxpBsi,50dqL10dQgxaWsJ,ios,OkIYT1HbF7u,True,1685606587
zph8HGB61143cB,0q1lmKgiDNMobQM,hXItjc228BPRN26,23srNEIeDv9OJNl,android,JyWFOSKn8bq,True,1685607648
GuKXGzrywU0cD5,2X3JSrxsMXNPQC9,rigyzC8DgiJjJMb,SZBTcgaralR0if8,ios,JyWFOSKn8bq,True,1685606624
lIXnarJMQekvM5,2XvPD

[Successfully executed]
2025-05-07 07:29:36 - Thread-830 (execute) - INFO - [Try to execute]
--Description: 2) List distinct users who received at least one push notification in that hour.
SELECT DISTINCT 
    "USER_ID"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
[Try to execute]
2025-05-07 07:29:37 - Thread-830 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 2) List distinct users who received at least one push notification in that hour.
SELECT DISTINCT 
    "USER_ID"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
Results:
USER_ID
0PvoRdl9lZaQKwX
1Hj35eXKXQLEQIO
12DanSBoMB4kW6F
1AcVMmDxHOf2XyD
1e7Rf8t6rQszkwC
2yVdWfrA5lBzKCj
0jq5SR09SlnzErs
1FEvjqau40IbUd9
2lSkFlA9Tg1ev9g
34PkInSOZzK1hrh
1fOWJhwxWPJNIJn
21HQIrlhZei9YKK
1qS4AirfNQk5dzB
0bV7i4JK7XmdiY8
1yp3K98es5FNj4j
2qAu8ymZyFko95t
0QffmxHtPu0Cziw
32uStZ8t4NhzWV5
06ogPB4SAEwPIjg
1r97Qq8Jts1IqEl

[Successfully executed]
2025-05-07 07:29:37 - Thread-830 (execute) - INFO - [Try to execute]
--Description: 3) Examine bounce events in the same time window to see which notifications failed.
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "APP_GROUP_ID",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
[Try to execute]
2025-05-07 07:29:38 - Thread-830 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 3) Examine bounce events in the same time window to see which notifications failed.
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "APP_GROUP_ID",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
Results:
ID,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,APP_GROUP_ID,TIME
QYMW1PkxzW3vSt,1zoENQchq3gFHhg,dXG6PLAuKAJv3vK,s9E0leDLYGJQWKO,ios,JyWFOSKn8bq,1685606766
zfCMY99jFz6kQS,1nJeGx4kpRerTwG,oGXu06hgprN7n4A,SXUeIlnkGQu5Vd4,ios,JyWFOSKn8bq,1685607881
JYRhU35U88i58e,0l76sh9jpU6Cbib,cfMm7suIWeZEivg,ZyIqigV69RjgSQq,android,OkIYT1HbF7u,1685609820
titie50rUtSSXY,17FxHaQWRvFhF85,7F3cNEq4u3NieO4,G9QPvVZwLE2tHfF,android,OkIYT1HbF7u,1685606518
K0FNM6v5OJTtoG,0SFfhUjBu3FoBK8,7PZvMEgW7LpaTuu,Gu2xbWlsu

[Successfully executed]
2025-05-07 07:29:38 - Thread-830 (execute) - INFO - [Try to execute]
--Description: 4) Look at open events (users actually tapped the push) during the hour, including device data.
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "DEVICE_MODEL",
    "CARRIER",
    "BROWSER",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
[Try to execute]
2025-05-07 07:29:39 - Thread-830 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 4) Look at open events (users actually tapped the push) during the hour, including device data.
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "DEVICE_MODEL",
    "CARRIER",
    "BROWSER",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
Results:
ID,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,DEVICE_MODEL,CARRIER,BROWSER,TIME
Lpxa1x1wMewQpP,2qqe884u221g2Mw,FC2IvzYewW5DjGI,yxzrtvaHxJQcPaD,ios,HUAWEI P30 PRO,rklf1h9,QJl5KtT,1685609976
qiouWxHfjBI91j,0YDFJlKpftZeqLT,OXay4LwHYCEoFmF,Wfum4MMLTn0x1O1,android,HUAWEI P30 PRO,F7lgCub,n58ctaR,1685609485
sQ6RKm6zvZus3G,32P1daRhKQHjkdi,2Y8NMPufhGqDBnt,APOd7pDrAgk3x2r,android,HUAWEI P30 PRO,FWmpdw4,llu0KtH,1685609710
ACMm5VkJSyt8gz,1WnGcZaTkLcrQqy,9wdjgrSzrY6rPO2,UaB6AaKigC5CBQp,android,HUA

[Successfully executed]
2025-05-07 07:29:39 - Thread-830 (execute) - INFO - [Try to execute]
--Description: 5) Retrieve the different mobile carriers associated with openings in that hour.
SELECT DISTINCT 
    "CARRIER"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
[Try to execute]
2025-05-07 07:29:40 - Thread-830 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 5) Retrieve the different mobile carriers associated with openings in that hour.
SELECT DISTINCT 
    "CARRIER"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
Results:
CARRIER
84XSIdX
eBnsMip
4KGqSEF
7l0pa6O
IbjpnaO
XJKcsFb
lXEM4R5
LaUSLDu
5NVSL5d
xF2MnhC
TSvIOce
CCPLXPK
xQBCauw
CuTGasv
ve6mFcq
BQltGAT
wlAcZkP
l3X7SNl
GyzIiY0
ds9Se1F

[Successfully executed]
2025-05-07 07:29:40 - Thread-830 (execute) - INFO - [Try to execute]
--Description: 6) Inspect “influenced open” events (user opened the app within attrib-window after seeing push).
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
[Try to execute]
2025-05-07 07:29:40 - Thread-830 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 6) Inspect “influenced open” events (user opened the app within attrib-window after seeing push).
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
Results:
ID,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,TIME
CvHJ95obFRWUDr,26xMHPvA2p8om1Z,caerM3W3Stan0XB,BqNgpebG2pkR6gU,ios,1685607168
E2xFhztJQod9aQ,26OtS2Ln3Oi3rKO,snp4CvlFBlk627P,HcmDZ87pEPjC0EN,android,1685608178
5L3Le8WLMDCoZ4,0iFjSjbugTja0jg,bb1QRT5WBTib0O9,Z4eKwlh0f1b7gFc,ios,1685609577
A0AIcxIHfn7rbe,1LHhR33oELcUwLd,aTY8MFvXklm8itQ,lNFDPEK5fgCso7A,ios,1685608904
cvxHkn0dIIlgUc,2WtZW1CO8wRBxYw,n6VwXwof8M30u69,QAoUXQNLOJUAAeF,ios,1685609942
cBdyA6xfGRNSpp,267SO6HU34o48UF,1Q04JOZsSoO

[Successfully executed]
2025-05-07 07:29:40 - Thread-830 (execute) - INFO - [Try to execute]
--Description: 7) Aggregate: number of sends by platform for the one-hour window.
SELECT 
    "PLATFORM",
    COUNT(*)                       AS "push_notification_sends"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
GROUP BY "PLATFORM"
LIMIT 20;
[Try to execute]
2025-05-07 07:29:41 - Thread-830 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 7) Aggregate: number of sends by platform for the one-hour window.
SELECT 
    "PLATFORM",
    COUNT(*)                       AS "push_notification_sends"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
GROUP BY "PLATFORM"
LIMIT 20;
Results:
PLATFORM,push_notification_sends
android,516
ios,484

[Successfully executed]
2025-05-07 07:29:41 - Thread-830 (execute) - INFO - [Try to execute]
--Description: 8) Join sends with opens to see which sends were actually opened (sample 20 rows).
SELECT 
    s."ID"                         AS "send_id",
    s."USER_ID",
    s."CAMPAIGN_ID",
    s."MESSAGE_VARIATION_ID",
    s."PLATFORM",
    o."ID"                         AS "open_id",
    o."TIME"                       AS "open_time"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW  s
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW o
      ON  s."USER_ID"              = o."USER_ID"
      AND s."MESSAGE_VARIATION_ID" = o."MESSAGE_VARIATION_ID"
      AND o."TIME" BETWEEN 1685606400 AND 1685610000
WHERE s."TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
[Try to execute]
2025-05-07 07:29:43 - Thread-830 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 8) Join sends with opens to see which sends were actually opened (sample 20 rows).
SELECT 
    s."ID"                         AS "send_id",
    s."USER_ID",
    s."CAMPAIGN_ID",
    s."MESSAGE_VARIATION_ID",
    s."PLATFORM",
    o."ID"                         AS "open_id",
    o."TIME"                       AS "open_time"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW  s
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW o
      ON  s."USER_ID"              = o."USER_ID"
      AND s."MESSAGE_VARIATION_ID" = o."MESSAGE_VARIATION_ID"
      AND o."TIME" BETWEEN 1685606400 AND 1685610000
WHERE s."TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
Results:
send_id,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,open_id,open_time
jTGNiZ8se73DAF,2cm2glsWU2DFHJD,,,ios,,
nyYgZBcfm7ygdF,1VF5dEHv5I2EsFs,6xxajDsJRL6ZeF3,vQ3NDVRTyOg30Ny,android,,
mhdH40f1q7Sl08,1EKfBfPmfxDhJNE,yNMmI42vFKxZ2V9,mJJzPQuZzsqNesB,android,,
QaKmaVe8xXKLpl,20wsj5Ba1BFTAWl,H6hyiXzIv8PV0uC,1gBd6WlvvNpUlAy,android,,
c1WZT9Gohf5ess,0Xpn1yhtPduJJ3T,nHZJVE8EZ0iB214,tRnMAS0OyH1dlKd,android,,
j9bupKvBimJZ0Z,1mZR2xjhv1E6ac2,UtQUXPEmftaiufe,PAgKq2CXwlF3UOS,ios,,

[Successfully executed]
2025-05-07 07:29:43 - Thread-830 (execute) - INFO - [Try to execute]
--Description: 9) Campaign-level open-vs-send counts in the time window (top 20).
SELECT
    s."CAMPAIGN_ID",
    COUNT(*)                                     AS "push_notification_sends",
    COUNT(o."ID")                                AS "push_notification_open"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW  s
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW o
      ON  s."USER_ID"              = o."USER_ID"
      AND s."MESSAGE_VARIATION_ID" = o."MESSAGE_VARIATION_ID"
      AND o."TIME" BETWEEN 1685606400 AND 1685610000
WHERE s."TIME" BETWEEN 1685606400 AND 1685610000
GROUP BY s."CAMPAIGN_ID"
LIMIT 20;
[Try to execute]
2025-05-07 07:29:46 - Thread-830 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 9) Campaign-level open-vs-send counts in the time window (top 20).
SELECT
    s."CAMPAIGN_ID",
    COUNT(*)                                     AS "push_notification_sends",
    COUNT(o."ID")                                AS "push_notification_open"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW  s
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW o
      ON  s."USER_ID"              = o."USER_ID"
      AND s."MESSAGE_VARIATION_ID" = o."MESSAGE_VARIATION_ID"
      AND o."TIME" BETWEEN 1685606400 AND 1685610000
WHERE s."TIME" BETWEEN 1685606400 AND 1685610000
GROUP BY s."CAMPAIGN_ID"
LIMIT 20;
Results:
CAMPAIGN_ID,push_notification_sends,push_notification_open
FUdoMRQ8oFBrvAX,1,0
SvbotUAPk4qcgQ3,2,0
YKEAaOdr1t1lNzm,2,0
1dkgJlITBhtnyZM,1,0
QQYIfRMmHKSs2HF,1,0
yuSxBN2ge1Q9DJD,1,0
ViBabKznJzt7Xg1,2,0
2Y8NMPufhGqDBnt,1,1
lb76acinztTr7gZ,1,0
6ajlu7AXDZHqJZF,1,0
JfK57cru3r7WFJ1,1,0
2unqYg8qHdzS2Sf,1,0
4lkKgoBBDAUIkth,1,0
zf5l7j3SzK429lQ,1,0
FNgu4XVcWV0UKBj,1,0
M0RTv3IG0DLZYp4,1,0
nO4z0ephi8zTOVs,1,0
Rtd0yeF6ZkduUbu,1,0
Y2I4tgHp9vJQB4v,1,0
dgHzDlkaWY9Omiv,1,1

[Successfully executed]
2025-05-07 07:29:46 - Thread-830 (execute) - INFO - [Try to execute]
--Description: 10) Consolidated metrics (sends, bounces, opens, influenced opens) for each campaign in the hour.
SELECT
    COALESCE(s."CAMPAIGN_ID", b."CAMPAIGN_ID", o."CAMPAIGN_ID", i."CAMPAIGN_ID") AS "CAMPAIGN_ID",
    COUNT(DISTINCT s."ID")  AS "push_notification_sends",
    COUNT(DISTINCT b."ID")  AS "push_notification_bounced",
    COUNT(DISTINCT o."ID")  AS "push_notification_open",
    COUNT(DISTINCT i."ID")  AS "push_notification_influenced_open"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW           s
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW    b
       ON s."CAMPAIGN_ID" = b."CAMPAIGN_ID"
      AND b."TIME" BETWEEN 1685606400 AND 1685610000
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW      o
       ON s."CAMPAIGN_ID" = o."CAMPAIGN_ID"
      AND o."TIME" BETWEEN 1685606400 AND 1685610000
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW i
       ON s."CAMPAIGN_ID" = i."CAMPAIGN_ID"
      AND i."TIME" BETWEEN 1685606400 AND 1685610000
WHERE s."TIME" BETWEEN 1685606400 AND 1685610000
GROUP BY COALESCE(s."CAMPAIGN_ID", b."CAMPAIGN_ID", o."CAMPAIGN_ID", i."CAMPAIGN_ID")
LIMIT 20;
[Try to execute]
2025-05-07 07:29:55 - Thread-830 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
--Description: 10) Consolidated metrics (sends, bounces, opens, influenced opens) for each campaign in the hour.
SELECT
    COALESCE(s."CAMPAIGN_ID", b."CAMPAIGN_ID", o."CAMPAIGN_ID", i."CAMPAIGN_ID") AS "CAMPAIGN_ID",
    COUNT(DISTINCT s."ID")  AS "push_notification_sends",
    COUNT(DISTINCT b."ID")  AS "push_notification_bounced",
    COUNT(DISTINCT o."ID")  AS "push_notification_open",
    COUNT(DISTINCT i."ID")  AS "push_notification_influenced_open"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW           s
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW    b
       ON s."CAMPAIGN_ID" = b."CAMPAIGN_ID"
      AND b."TIME" BETWEEN 1685606400 AND 1685610000
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW      o
       ON s."CAMPAIGN_ID" = o."CAMPAIGN_ID"
      AND o."TIME" BETWEEN 1685606400 AND 1685610000
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW i
       ON s."CAMPAIGN_ID" = i."CAMPAIGN_ID"
      AND i."TIME" BETWEEN 1685606400 AND 1685610000
WHERE s."TIME" BETWEEN 1685606400 AND 1685610000
GROUP BY COALESCE(s."CAMPAIGN_ID", b."CAMPAIGN_ID", o."CAMPAIGN_ID", i."CAMPAIGN_ID")
LIMIT 20;
Results:
CAMPAIGN_ID,push_notification_sends,push_notification_bounced,push_notification_open,push_notification_influenced_open
kJkDHA6hCVPcXrB,1,0,0,0
tjvU8ERKUMQF1UW,1,0,0,0
Dkef4xy74r6ahbv,1,0,0,0
fKLQBAx6erJq0jj,2,0,0,0
9WCto5H6icJrEiR,1,0,0,0
mn2mJObtjkZcmQ0,2,0,0,0
nOFh8UGZKeC7nel,1,0,0,0
duyzRD4I9tPcE1o,1,0,0,0
3Rruj0m4G9UPZug,1,0,0,0
PyBOvgK3494tCqj,1,0,0,0
nMX89IzrSiYu7i7,1,0,0,0
lBP78Ef9uM584Vc,1,0,1,0
diJ3f8yv9xtFMhQ,1,0,0,0
eXHW492uzMtiZ6v,3,1,0,0
HICoq7JY9vQTAZ8,1,0,0,0
lgSER

[Successfully executed]
2025-05-07 07:29:55 - Thread-830 (execute) - INFO - itercount: 0
2025-05-07 07:29:55 - Thread-830 (execute) - INFO - [Self-refine]
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW
Column name: PLATFORM Type: TEXT
Column name: ID Type: TEXT
Column name: MESSAGE_VARIATION_ID Type: TEXT
Column name: APP_ID Type: TEXT
Column name: CAMPAIGN_ID Type: TEXT
Column name: USER_ID Type: TEXT
Column name: APP_API_ID Type: TEXT
Column name: APP_GROUP_API_ID Type: TEXT
Column name: TIME Type: NUMBER
Column name: SF_CREATED_AT Type: TIMESTAMP_LTZ
Column name: AD_TRACKING_ENABLED Type: BOOLEAN
Column name: APP_GROUP_ID Type: TEXT
Column name: DEVICE_MODEL Type: TEXT
Column name: CARRIER Type: TEXT
Column name: BROWSER Type: TEXT
Sample rows:
[{'PLATFORM': 'android', 'ID': 'Hc1Iv6aIcwzNeW', 'MESSAGE_VARIATION_ID': 'MS7NDpmYtLv49sG', 'APP_ID': 'cavgwlQbKmE', 'CAMPAIGN_ID': 'v15fcVnCvcpFehz', 'USER_ID': '01HcGn13T509adp', 'APP_API_ID': 'NgLvvF7qSliEgW', 'APP_GROUP_API_ID': 'fKsYbbiE7hU8Li', 'TIME': 1688533671, 'SF_CREATED_AT': '2021-12-14 11:16:28.525000-08:00', 'AD_TRACKING_ENABLED': True, 'APP_GROUP_ID': 'JyWFOSKn8bq', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'CARRIER': 'j3xtkLk', 'BROWSER': 'LBFXVe3'}, {'PLATFORM': 'ios', 'ID': 'oKsbvcBxYICOW1', 'MESSAGE_VARIATION_ID': 'okYhlj8WjA032LL', 'APP_ID': 'cavgwlQbKmE', 'CAMPAIGN_ID': 'OezajA2FP4vbeoD', 'USER_ID': '33ZLxxfrv4N5wy0', 'APP_API_ID': 'u7lB2nuwUxzFSm', 'APP_GROUP_API_ID': 'yEtQUZGswVeP1X', 'TIME': 1690643557, 'SF_CREATED_AT': '2021-12-14 11:16:28.812000-08:00', 'AD_TRACKING_ENABLED': True, 'APP_GROUP_ID': 'JyWFOSKn8bq', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'CARRIER': '0Qcwx20', 'BROWSER': 'eITRtr6'}, {'PLATFORM': 'ios', 'ID': 'EjKZMIT301EhfV', 'MESSAGE_VARIATION_ID': 'kAkCZ42myvzJKKN', 'APP_ID': 'cavgwlQbKmE', 'CAMPAIGN_ID': 'U8lndpVyn6UwV1W', 'USER_ID': '1RwdaKTeiHkavOL', 'APP_API_ID': 'pVQV2P51m1BVYY', 'APP_GROUP_API_ID': 'ilhVYRwtIWF1oy', 'TIME': 1658549015, 'SF_CREATED_AT': '2021-12-14 11:16:11.490000-08:00', 'AD_TRACKING_ENABLED': True, 'APP_GROUP_ID': 'JyWFOSKn8bq', 'DEVICE_MODEL': 'HUAWEI P30 PRO', 'CARRIER': 'GkQomMp', 'BROWSER': 'hDC16LT'}, {'PLATFORM': 'android', 'ID': 'bAsR6oPSOUHTH0', 'MESSAGE_VARIATION_ID': 'SZBTcgaralR0if8', 'APP_ID': 'WleeR6PnBPb', 'CAMPAIGN_ID': 'rigyzC8DgiJjJMb', 'USER_ID': '01LG44JZd3CdJdo', 'APP_API_ID': 'ZWtiBxwmRuAjY6', 'APP_GROUP_API_ID': 'XYCeWVM62rxzll', 'TIME': 1652296354, 'SF_CREATED_AT': '2021-12-14 11:16:11.202000-08:00', 'AD_TRACKING_ENABLED': True, 'APP_GROUP_ID': 'OkIYT1HbF7u', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'CARRIER': 'i6Xetqj', 'BROWSER': '0VFzSbj'}, {'PLATFORM': 'ios', 'ID': 'UYygaUHXuT6hdA', 'MESSAGE_VARIATION_ID': 'ngEk48SmRllJ0Ub', 'APP_ID': 'WleeR6PnBPb', 'CAMPAIGN_ID': 's4SVSHz8xz6jf8W', 'USER_ID': '19C5E2XN7hwj7pJ', 'APP_API_ID': 'Y6Fw1ciycg3EW6', 'APP_GROUP_API_ID': 'CgTlfXTAxWm0lE', 'TIME': 1657431828, 'SF_CREATED_AT': '2021-12-14 11:16:12.130000-08:00', 'AD_TRACKING_ENABLED': True, 'APP_GROUP_ID': 'OkIYT1HbF7u', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'CARRIER': 'ZWcUluL', 'BROWSER': 'gV5IbYi'}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_VIEW
Column name: MESSAGE_VARIATION_API_ID Type: TEXT
Column name: BROWSER Type: TEXT
Column name: APP_ID Type: TEXT
Column name: SEND_ID Type: TEXT
Column name: DEVICE_MODEL Type: TEXT
Column name: PLATFORM Type: TEXT
Column name: APP_GROUP_API_ID Type: TEXT
Column name: APP_API_ID Type: TEXT
Column name: CAMPAIGN_API_ID Type: TEXT
Column name: APP_GROUP_ID Type: TEXT
Column name: ID Type: TEXT
Column name: DISPATCH_ID Type: TEXT
Column name: TIME Type: NUMBER
Column name: SF_CREATED_AT Type: TIMESTAMP_LTZ
Column name: CAMPAIGN_ID Type: TEXT
Column name: MESSAGE_VARIATION_ID Type: TEXT
Column name: USER_ID Type: TEXT
Column name: AD_TRACKING_ENABLED Type: BOOLEAN
Column name: CARRIER Type: TEXT
Sample rows:
[{'MESSAGE_VARIATION_API_ID': 'j5uvwemwdRPtkS', 'BROWSER': 'LNi6eLq', 'APP_ID': 'cavgwlQbKmE', 'SEND_ID': 'IHsWBtGQnt2evg', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'PLATFORM': 'android', 'APP_GROUP_API_ID': '89DbzhTflGYFCr', 'APP_API_ID': 'ZB5yvGAeChjb72', 'CAMPAIGN_API_ID': 'nI684v4sRoHNo4L', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'ID': 'k0xxl1lWnQSEBO', 'DISPATCH_ID': 'kIi1UfF3L1AKvP', 'TIME': 1680692760, 'SF_CREATED_AT': '2021-12-14 11:16:05.085000-08:00', 'CAMPAIGN_ID': 'WSlZXCVUyYDoQUv', 'MESSAGE_VARIATION_ID': 'LJa5UttXS2tXm4e', 'USER_ID': '1rv16rYZPX39xog', 'AD_TRACKING_ENABLED': True, 'CARRIER': 'hymSNGT'}, {'MESSAGE_VARIATION_API_ID': '32w4XgBOtK89Ey', 'BROWSER': 'fN7A1EZ', 'APP_ID': 'cavgwlQbKmE', 'SEND_ID': 'QuHojAUzkgD00t', 'DEVICE_MODEL': 'HUAWEI P30 PRO', 'PLATFORM': 'android', 'APP_GROUP_API_ID': 'KehmPvL3zdg9HJ', 'APP_API_ID': 'AoaSnzVPoyi9qt', 'CAMPAIGN_API_ID': 'PatOhqckTtbqLNw', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'ID': 'Yxq7VT0hvgsK5l', 'DISPATCH_ID': 'Mi6C1pRV6XovY9', 'TIME': 1665197106, 'SF_CREATED_AT': '2021-12-14 11:14:44.058000-08:00', 'CAMPAIGN_ID': 'Bf1YIuBI9fcL5yn', 'MESSAGE_VARIATION_ID': 'ikc1ihVyegYVyea', 'USER_ID': '1JLoJg1YnzkhVP4', 'AD_TRACKING_ENABLED': True, 'CARRIER': 'DcqD1Ox'}, {'MESSAGE_VARIATION_API_ID': 'dC64X56si7MtgA', 'BROWSER': 'lVsBLGh', 'APP_ID': 'cavgwlQbKmE', 'SEND_ID': 'S4Hkpp4Zd7U9L1', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'PLATFORM': 'ios', 'APP_GROUP_API_ID': 'VhotVy5sDC3oyw', 'APP_API_ID': 'doCBBzEepqnKuz', 'CAMPAIGN_API_ID': '7GZfe64AFcwkU5d', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'ID': 'J66KgIZyKe2QYe', 'DISPATCH_ID': 'iePwUnpN7anCKX', 'TIME': 1674701843, 'SF_CREATED_AT': '2021-12-14 11:15:56.813000-08:00', 'CAMPAIGN_ID': '20hyfGkLDTbBhkT', 'MESSAGE_VARIATION_ID': 'hx4ZnyHDE8PDtgr', 'USER_ID': '2dy83kVW0nfIfZK', 'AD_TRACKING_ENABLED': True, 'CARRIER': 'ikZ9nxX'}, {'MESSAGE_VARIATION_API_ID': 'A45JdaMb4FhkqU', 'BROWSER': 'yQk54RQ', 'APP_ID': 'WleeR6PnBPb', 'SEND_ID': '8sReru9Fm7U4Qn', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'PLATFORM': 'ios', 'APP_GROUP_API_ID': 'LimSTJ7isqbHxL', 'APP_API_ID': 'LEWyHi9bPKgte5', 'CAMPAIGN_API_ID': 'lmdIk2aAjaC30mn', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'ID': 'L6395n3LUuWWYe', 'DISPATCH_ID': 'CgCkHyIYWZgaMK', 'TIME': 1685727688, 'SF_CREATED_AT': '2021-12-14 11:14:48.032000-08:00', 'CAMPAIGN_ID': 'i4OwymmArxThk37', 'MESSAGE_VARIATION_ID': 'W6zQjMY9tCt2miJ', 'USER_ID': '34CwwBsuhd45Rh3', 'AD_TRACKING_ENABLED': True, 'CARRIER': 'mYw394L'}, {'MESSAGE_VARIATION_API_ID': 'yrYV3hIVVzQWNr', 'BROWSER': 'Jdueg6T', 'APP_ID': 'WleeR6PnBPb', 'SEND_ID': 'bIbmaspMRqvBVi', 'DEVICE_MODEL': 'APPLE IPHONE XS MAX', 'PLATFORM': 'ios', 'APP_GROUP_API_ID': '1atq34rbW7OtwY', 'APP_API_ID': 'thm5friuOalK6Y', 'CAMPAIGN_API_ID': 'FykRGQs5JGT3YcA', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'ID': 'M9KQ9W4gawLjfR', 'DISPATCH_ID': 'XgNyJ3Vr6W4R49', 'TIME': 1692931610, 'SF_CREATED_AT': '2021-12-14 11:15:57.061000-08:00', 'CAMPAIGN_ID': 'rH0iMS25X0gWRqm', 'MESSAGE_VARIATION_ID': 'PLoyj5bET4GIwwM', 'USER_ID': '1wUkT0GXnWGNNfS', 'AD_TRACKING_ENABLED': True, 'CARRIER': 'BUrQSe2'}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_SHARED_VIEW
Column name: AD_TRACKING_ENABLED Type: BOOLEAN
Column name: MESSAGE_VARIATION_API_ID Type: TEXT
Column name: CAMPAIGN_ID Type: TEXT
Column name: USER_ID Type: TEXT
Column name: PLATFORM Type: TEXT
Column name: ID Type: TEXT
Column name: DEVICE_MODEL Type: TEXT
Column name: TIME Type: NUMBER
Sample rows:
[{'AD_TRACKING_ENABLED': True, 'MESSAGE_VARIATION_API_ID': 'qU1t8uBDTlIIvr', 'CAMPAIGN_ID': '1b4Crn3LDcPJFfY', 'USER_ID': '0GnuCJJGV8GgqmP', 'PLATFORM': 'android', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'TIME': 1680787636}, {'AD_TRACKING_ENABLED': True, 'MESSAGE_VARIATION_API_ID': 'frPf4siaAMQmRX', 'CAMPAIGN_ID': 'jM8YmNSJGUxvoI1', 'USER_ID': '1yO1KjvB6nmwYuo', 'PLATFORM': 'android', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'TIME': 1690223871}, {'AD_TRACKING_ENABLED': True, 'MESSAGE_VARIATION_API_ID': 'VzMasP7n4wuWTz', 'CAMPAIGN_ID': '35bKrd586cO6W5t', 'USER_ID': '0tAyMAhZlNUfF5L', 'PLATFORM': 'ios', 'DEVICE_MODEL': 'HUAWEI P30 PRO', 'TIME': 1680890081}, {'AD_TRACKING_ENABLED': True, 'MESSAGE_VARIATION_API_ID': 'utz6V6lNGrpdCY', 'CAMPAIGN_ID': 'p96a8Sw1kI8q51B', 'USER_ID': '1qDbLVkxWn1q1mH', 'PLATFORM': 'android', 'DEVICE_MODEL': 'SAMSUNG GALAXY NOTE 10/10 PLUS', 'TIME': 1691986557}, {'AD_TRACKING_ENABLED': True, 'MESSAGE_VARIATION_API_ID': 'WOHKpcfJkVgh0R', 'CAMPAIGN_ID': 'uWySmvwgvbwTJ3D', 'USER_ID': '1qrPDrAHrU6NB0p', 'PLATFORM': 'ios', 'DEVICE_MODEL': 'HUAWEI P30 PRO', 'TIME': 1691273523}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW
Column name: MESSAGE_VARIATION_ID Type: TEXT
Column name: SF_CREATED_AT Type: TIMESTAMP_LTZ
Column name: TIME Type: NUMBER
Column name: PLATFORM Type: TEXT
Column name: USER_ID Type: TEXT
Column name: ID Type: TEXT
Column name: APP_GROUP_ID Type: TEXT
Column name: AD_TRACKING_ENABLED Type: BOOLEAN
Column name: CAMPAIGN_ID Type: TEXT
Sample rows:
[{'MESSAGE_VARIATION_ID': 'dv7cyxmLjXAHLr1', 'SF_CREATED_AT': '2021-12-14 11:17:38.135000-08:00', 'PLATFORM': 'android', 'USER_ID': '1ozEahxyc2abh48', 'ID': 'l2pRHH03p3rNKQ', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'AD_TRACKING_ENABLED': True, 'CAMPAIGN_ID': 'WUWF171IL9Y8zT4'}, {'MESSAGE_VARIATION_ID': '4Gmnf9yXWnUsLEE', 'SF_CREATED_AT': '2021-12-14 11:17:38.333000-08:00', 'PLATFORM': 'android', 'USER_ID': '0XgcLFFDjphFiOX', 'ID': 'YamKzAZrlJSrpV', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'AD_TRACKING_ENABLED': True, 'CAMPAIGN_ID': '8Ih99pbTHK95mnc'}, {'MESSAGE_VARIATION_ID': '8zms93AOs32n6Fk', 'SF_CREATED_AT': '2021-12-14 11:17:38.135000-08:00', 'PLATFORM': 'ios', 'USER_ID': '1CNcSx4WjnmgQp1', 'ID': 'e9atU6myPmtS0K', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'AD_TRACKING_ENABLED': True, 'CAMPAIGN_ID': 'NNWSBRr6MaWCMK2'}, {'MESSAGE_VARIATION_ID': 'GamGQtsQEPlO9fJ', 'SF_CREATED_AT': '2021-12-14 11:18:00-08:00', 'PLATFORM': 'ios', 'USER_ID': '1DJMPvQ1CF3F9vu', 'ID': 'M2q9dBXWTaSuzt', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'AD_TRACKING_ENABLED': True, 'CAMPAIGN_ID': 'neE5WoL5K2uGAUy'}, {'MESSAGE_VARIATION_ID': 'pun9TLDiT2FuMMD', 'SF_CREATED_AT': '2021-12-14 11:17:55.430000-08:00', 'PLATFORM': 'ios', 'USER_ID': '30641y1RaIc6WbP', 'ID': 'DSRPpLtNks1KbX', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'AD_TRACKING_ENABLED': True, 'CAMPAIGN_ID': 'C7D49eFmKHwUNVY'}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_CAMPAIGNS_ENROLLINCONTROL_VIEW
Column name: APP_ID Type: TEXT
Column name: TIME Type: NUMBER
Column name: MESSAGE_VARIATION_ID Type: TEXT
Column name: USER_ID Type: TEXT
Column name: APP_GROUP_ID Type: TEXT
Column name: ID Type: TEXT
Column name: CAMPAIGN_ID Type: TEXT
Sample rows:
[{'APP_ID': 'cavgwlQbKmE', 'TIME': 1630486337, 'MESSAGE_VARIATION_ID': '4YDlo21KDnxfAkC', 'USER_ID': '1D67jDbDZ1s9nAI', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'CAMPAIGN_ID': 'UVCRPe5AIq7VwSx'}, {'APP_ID': 'cavgwlQbKmE', 'TIME': 1664767851, 'MESSAGE_VARIATION_ID': 'h9C0MgvmNZORUiW', 'USER_ID': '04EFw55bmRtHShh', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'CAMPAIGN_ID': 'R54gcVYRz9OJ6bI'}, {'APP_ID': 'WleeR6PnBPb', 'TIME': 1646166007, 'MESSAGE_VARIATION_ID': 'iB7OQSxudLTViuI', 'USER_ID': '2BTimyDzdioEd1g', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'CAMPAIGN_ID': '0PVzemOysFYy6yg'}, {'APP_ID': 'cavgwlQbKmE', 'TIME': 1676151296, 'MESSAGE_VARIATION_ID': 'cwx3BVcFYGWzAYc', 'USER_ID': '24AFGd5e8uDoXkJ', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'CAMPAIGN_ID': 'WnoNybWawFF9uFe'}, {'APP_ID': 'WleeR6PnBPb', 'TIME': 1643352534, 'MESSAGE_VARIATION_ID': 'd6grikJed9T9PSs', 'USER_ID': '0ubg8mmgolDToaz', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'CAMPAIGN_ID': 'sximVDY7BpbHNGv'}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW
Column name: MESSAGE_VARIATION_ID Type: TEXT
Column name: CAMPAIGN_ID Type: TEXT
Column name: SF_CREATED_AT Type: TIMESTAMP_LTZ
Column name: ID Type: TEXT
Column name: PLATFORM Type: TEXT
Column name: USER_ID Type: TEXT
Column name: TIME Type: NUMBER
Sample rows:
[{'MESSAGE_VARIATION_ID': '53NwKNR9MSRc5IH', 'CAMPAIGN_ID': '58h8RRp5cjh7dZr', 'SF_CREATED_AT': '2021-12-14 11:16:07.659000-08:00', 'PLATFORM': 'ios', 'USER_ID': '1dRCeEIuKZ8Esep'}, {'MESSAGE_VARIATION_ID': '0VPF1QZtOCDJq8O', 'CAMPAIGN_ID': 'NWWjVWwPX140u5s', 'SF_CREATED_AT': '2021-12-14 11:16:08.677000-08:00', 'PLATFORM': 'ios', 'USER_ID': '0tb7p0FKWQnBy1S'}, {'MESSAGE_VARIATION_ID': '7Yf7LLyMAzg1IUb', 'CAMPAIGN_ID': 'Sv3BmuYe2qJEWQS', 'SF_CREATED_AT': '2021-12-14 11:16:09.322000-08:00', 'PLATFORM': 'android', 'USER_ID': '1n6jqoooaPLONqP'}, {'MESSAGE_VARIATION_ID': 'Z8NEPdmuaukppii', 'CAMPAIGN_ID': 'HifherE5Tk7bAAn', 'SF_CREATED_AT': '2021-12-14 11:16:08.756000-08:00', 'PLATFORM': 'android', 'USER_ID': '2ccovMaIiTfhofK'}, {'MESSAGE_VARIATION_ID': 'Y98AKtTCAIVAUhg', 'CAMPAIGN_ID': '7JPBzPEEyxas2XK', 'SF_CREATED_AT': '2021-12-14 11:14:25.683000-08:00', 'PLATFORM': 'android', 'USER_ID': '2ex1BB4abO679Uw'}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_SHARED_VIEW
Column name: AD_TRACKING_ENABLED Type: BOOLEAN
Column name: PLATFORM Type: TEXT
Column name: APP_GROUP_ID Type: TEXT
Column name: USER_ID Type: TEXT
Column name: MESSAGE_VARIATION_API_ID Type: TEXT
Column name: ID Type: TEXT
Column name: CAMPAIGN_ID Type: TEXT
Column name: CARRIER Type: TEXT
Column name: BROWSER Type: TEXT
Column name: TIME Type: NUMBER
Column name: DEVICE_MODEL Type: TEXT
Sample rows:
[{'AD_TRACKING_ENABLED': True, 'PLATFORM': 'ios', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'USER_ID': '1l56ymrYc0Kr7L9', 'MESSAGE_VARIATION_API_ID': 'mOKZKQIMy4eoJK', 'CAMPAIGN_ID': 'yVtDpA2JCpTMloj', 'CARRIER': 'nSWyOLT', 'BROWSER': 'Z8c8boT', 'TIME': 1689750584, 'DEVICE_MODEL': 'APPLE IPHONE XS MAX'}, {'AD_TRACKING_ENABLED': True, 'PLATFORM': 'ios', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'USER_ID': '1ptY9FvxAY5xTvx', 'MESSAGE_VARIATION_API_ID': 'eY2iP8DyEu3fs7', 'CAMPAIGN_ID': 'U9HqCw7BrfPHydp', 'CARRIER': '78kEQ0c', 'BROWSER': 'cn5pbJp', 'TIME': 1693107569, 'DEVICE_MODEL': 'APPLE IPHONE XS MAX'}, {'AD_TRACKING_ENABLED': True, 'PLATFORM': 'android', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'USER_ID': '0pk0dTIPvIDBbKj', 'MESSAGE_VARIATION_API_ID': 'QFXKByYiF9Jwfs', 'CAMPAIGN_ID': 'Qja5gABJUx2WzNR', 'CARRIER': 'BJ8zcay', 'BROWSER': '6SIdUtz', 'TIME': 1684397837, 'DEVICE_MODEL': 'APPLE IPHONE XS MAX'}, {'AD_TRACKING_ENABLED': True, 'PLATFORM': 'ios', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'USER_ID': '07LAiBfAEhTqMuW', 'MESSAGE_VARIATION_API_ID': 'bp4gOxOrLdMKQE', 'CAMPAIGN_ID': 'iyDNPIoMgVrCScw', 'CARRIER': '2sE3lNu', 'BROWSER': 'LLVLj6N', 'TIME': 1691255796, 'DEVICE_MODEL': 'HUAWEI P30 PRO'}, {'AD_TRACKING_ENABLED': True, 'PLATFORM': 'android', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'USER_ID': '2OhG8HzLZKfSMv8', 'MESSAGE_VARIATION_API_ID': 'jJyqbh9XBjvThU', 'CAMPAIGN_ID': 'o5pJWezrug0ICjL', 'CARRIER': 'vUecmST', 'BROWSER': 'edWrZ4A', 'TIME': 1692812020, 'DEVICE_MODEL': 'HUAWEI P30 PRO'}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_SHARED_VIEW
Column name: PLATFORM Type: TEXT
Column name: USER_ID Type: TEXT
Column name: TIME Type: NUMBER
Column name: MESSAGE_VARIATION_API_ID Type: TEXT
Column name: ID Type: TEXT
Sample rows:
[{'PLATFORM': 'ios', 'USER_ID': '0lL7oak0UWagKyU', 'TIME': 1693362990, 'MESSAGE_VARIATION_API_ID': 'nvIZW4Gc4cWmo0'}, {'PLATFORM': 'android', 'USER_ID': '1XulAf3cAOSwB3W', 'TIME': 1685948542, 'MESSAGE_VARIATION_API_ID': '1rKOMlnzSQ7Wus'}, {'PLATFORM': 'android', 'USER_ID': '0BlSnAPNt8tfJkp', 'TIME': 1682498789, 'MESSAGE_VARIATION_API_ID': 'ootTeZZe20idd1'}, {'PLATFORM': 'android', 'USER_ID': '0CHNabJAxHe9IJA', 'TIME': 1675208701, 'MESSAGE_VARIATION_API_ID': 'OFdeH8ArLJJwXs'}, {'PLATFORM': 'android', 'USER_ID': '0GHEyFlipKACmHm', 'TIME': 1692450056, 'MESSAGE_VARIATION_API_ID': 'qW90WZ2a5RMfEV'}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_SHARED_VIEW
Column name: MESSAGE_VARIATION_API_ID Type: TEXT
Column name: TIME Type: NUMBER
Column name: ID Type: TEXT
Column name: PLATFORM Type: TEXT
Column name: CAMPAIGN_ID Type: TEXT
Column name: APP_GROUP_ID Type: TEXT
Column name: USER_ID Type: TEXT
Column name: AD_TRACKING_ENABLED Type: BOOLEAN
Sample rows:
[{'MESSAGE_VARIATION_API_ID': 'a3FcGsCQEUX6li', 'TIME': 1690642972, 'PLATFORM': 'android', 'CAMPAIGN_ID': 'eivJmWT6f2bB3F0', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'USER_ID': '1Vhr7od4uu4dGqg', 'AD_TRACKING_ENABLED': True}, {'MESSAGE_VARIATION_API_ID': 'ZpngLB2XrppT33', 'TIME': 1686292880, 'PLATFORM': 'ios', 'CAMPAIGN_ID': 'vWwH0WOV5wVCdpP', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'USER_ID': '1Vk4XLPTPNc0P5u', 'AD_TRACKING_ENABLED': True}, {'MESSAGE_VARIATION_API_ID': 'M3MYgVx8Y2oNb5', 'TIME': 1680917163, 'PLATFORM': 'android', 'CAMPAIGN_ID': 'zby0CTZmUsO1Yl3', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'USER_ID': '1W8FUwMymtpeQDX', 'AD_TRACKING_ENABLED': True}, {'MESSAGE_VARIATION_API_ID': 'ZwRSohifXoYcSa', 'TIME': 1685781311, 'PLATFORM': 'ios', 'CAMPAIGN_ID': 'xOLIHdZxDvrclPC', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'USER_ID': '1VZLZK4nwMZHyiP', 'AD_TRACKING_ENABLED': True}, {'MESSAGE_VARIATION_API_ID': 'OUzqdQOpsJqloO', 'TIME': 1655666409, 'PLATFORM': 'ios', 'CAMPAIGN_ID': 'n6VwXwof8M30u69', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'USER_ID': '1VwhzrGCYj4G7yZ', 'AD_TRACKING_ENABLED': True}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW
Column name: USER_ID Type: TEXT
Column name: MESSAGE_VARIATION_ID Type: TEXT
Column name: PLATFORM Type: TEXT
Column name: TIME Type: NUMBER
Column name: CAMPAIGN_ID Type: TEXT
Column name: APP_GROUP_ID Type: TEXT
Column name: AD_TRACKING_ENABLED Type: BOOLEAN
Column name: ID Type: TEXT
Sample rows:
[{'USER_ID': '2TcIEwF3b000naI', 'MESSAGE_VARIATION_ID': 'okWUvcJtNoLwKCo', 'PLATFORM': 'ios', 'TIME': 1689990591, 'CAMPAIGN_ID': 'WiLO2VZ0fj50DrT', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'AD_TRACKING_ENABLED': True}, {'USER_ID': '2TfnOwCCtafuJPi', 'MESSAGE_VARIATION_ID': 'YTg7alAK0JG0CDn', 'PLATFORM': 'ios', 'TIME': 1651389539, 'CAMPAIGN_ID': 'WGinxN5BQPYQofb', 'APP_GROUP_ID': 'JyWFOSKn8bq', 'AD_TRACKING_ENABLED': True}, {'USER_ID': '2UEp938n6Y3LWwN', 'MESSAGE_VARIATION_ID': 'xLjSkv862cKHQyu', 'PLATFORM': 'android', 'TIME': 1680812889, 'CAMPAIGN_ID': 'nxOMIJIzkPPj75z', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'AD_TRACKING_ENABLED': True}, {'USER_ID': '2TX8wX0YcPtzzLA', 'MESSAGE_VARIATION_ID': 'Q1FlJjDZHAmBqHq', 'PLATFORM': 'ios', 'TIME': 1664846591, 'CAMPAIGN_ID': 'VFYN9QWk6h6fmAn', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'AD_TRACKING_ENABLED': True}, {'USER_ID': '2TnYaz613nOVHyW', 'MESSAGE_VARIATION_ID': 'GfkzbQ99IDga7g6', 'PLATFORM': 'android', 'TIME': 1679999803, 'CAMPAIGN_ID': 'Jv0XoRCDYyNplqs', 'APP_GROUP_ID': 'OkIYT1HbF7u', 'AD_TRACKING_ENABLED': True}]

--------------------------------------------------
Table full name: BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_SHARED_VIEW
Column name: PLATFORM Type: TEXT
Column name: ID Type: TEXT
Column name: CAMPAIGN_ID Type: TEXT
Column name: USER_ID Type: TEXT
Column name: MESSAGE_VARIATION_API_ID Type: TEXT
Column name: TIME Type: NUMBER
Sample rows:
[{'PLATFORM': 'android', 'CAMPAIGN_ID': 'loPFcRNkEIeyDTC', 'USER_ID': '1ThK0Tfzzjo6C35', 'MESSAGE_VARIATION_API_ID': 'DJqv9T494HxaMM', 'TIME': 1665435755}, {'PLATFORM': 'ios', 'CAMPAIGN_ID': 'lPNNGio8wkxocHJ', 'USER_ID': '2iYSDGm3afLWJzp', 'MESSAGE_VARIATION_API_ID': 'bDL7fmDLfRbbdU', 'TIME': 1674733934}, {'PLATFORM': 'android', 'CAMPAIGN_ID': 'fau5DW9R3tXHpLb', 'USER_ID': '28xEpmvPj2cC2mO', 'MESSAGE_VARIATION_API_ID': 'm8bxZOrZZiNB12', 'TIME': 1674786226}, {'PLATFORM': 'android', 'CAMPAIGN_ID': 'zfAz0UFA42Op3XK', 'USER_ID': '0F3flaXfCmNzjLq', 'MESSAGE_VARIATION_API_ID': 'h6O2YytJwAIe0J', 'TIME': 1639910277}, {'PLATFORM': 'ios', 'CAMPAIGN_ID': 'HqlJhauAE0gMYa1', 'USER_ID': '1BgLSozIm7s93cI', 'MESSAGE_VARIATION_API_ID': '1IrLyFo2YUWIqP', 'TIME': 1663792947}]

--------------------------------------------------
External knowledge that might be helpful: 
# Push Notification Analysis

## Overview
This document details an SQL query that analyzes user responses to push notifications within the timeframe of 8:00 AM to 9:00 AM on June 1, 2023. It is designed to assess the impact and effectiveness of push notification campaigns across various metrics.

## Data Sources
The analysis utilizes four distinct subqueries pulling from push notification event views:
- **Send Events**
- **Bounce Events**
- **Open Events**
- **Influenced Open Events**

## Query Description
Each subquery counts and categorizes events based on the type of interaction (sent, bounced, opened, influenced open), along with detailed user and device information.

### Send Events
- **Table**: `USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW`
- **Columns**: ID, app group ID, user ID, campaign ID, message variation ID, platform, ad tracking enabled, event timestamp

### Bounce Events
- **Table**: `USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW`
- **Columns**: Same as Send Events

### Open Events
- **Table**: `USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW`
- **Columns**: Same as Send Events plus carrier, browser, and device model

### Influenced Open Events
- **Table**: `USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW`
- **Columns**: Same as Open Events

## Results Aggregation
The final output of the query is grouped by:
- App Group ID
- Campaign ID
- User ID
- Message Variation ID
- Platform
- Ad Tracking Enabled
- Device Information (Carrier, Browser, Device Model)

### Metrics Included
- `push_notification_sends`: Total number of notifications sent.
- `unique_push_notification_sends`: Number of unique users who received notifications.
- `push_notification_bounced`: Total number of notifications that bounced.
- `unique_push_notification_bounced`: Number of unique users who received bounced notifications.
- `push_notification_open`: Total number of notifications opened.
- `unique_push_notification_opened`: Number of unique users who opened notifications.
- `push_notification_influenced_open`: Total number of indirectly opened notifications.
- `unique_push_notification_influenced_open`: Number of unique users who opened notifications indirectly.

## Conclusion
This analysis provides valuable insights into the reach and responsiveness of users to push notifications, helping to guide future marketing strategies and campaign optimizations.

The table structure information is ({database name: {schema name: [table name]}}): 
{'BRAZE_USER_EVENT_DEMO_DATASET': {'PUBLIC': ['USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_OPEN_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW', 'USERS_CAMPAIGNS_ENROLLINCONTROL_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_SEND_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_SHARED_VIEW']}}

Some few-shot examples after column exploration may be helpful:
Query:
--Description: 1) Inspect raw push-notification “send” events that occurred between 08:00 and 09:00 UTC on 1-Jun-2023.
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "APP_GROUP_ID",
    "AD_TRACKING_ENABLED",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
Answer:
ID,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,APP_GROUP_ID,AD_TRACKING_ENABLED,TIME
CTIY0Wgh9t1mZo,33JXzkDPuOIH9K3,iCU1rgIA4Su6K9u,W8QOJOzUiP7c4tw,ios,JyWFOSKn8bq,True,1685607585
zFpyZLpJpf0UMb,0ouZEQXOkJDHXcv,Wip7esv4UPxpBsi,50dqL10dQgxaWsJ,ios,OkIYT1HbF7u,True,1685606587
zph8HGB61143cB,0q1lmKgiDNMobQM,hXItjc228BPRN26,23srNEIeDv9OJNl,android,JyWFOSKn8bq,True,1685607648
GuKXGzrywU0cD5,2X3JSrxsMXNPQC9,rigyzC8DgiJjJMb,SZBTcgaralR0if8,ios,JyWFOSKn8bq,True,1685606624
lIXnarJMQekvM5,2XvPD
Query:
--Description: 2) List distinct users who received at least one push notification in that hour.
SELECT DISTINCT 
    "USER_ID"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
Answer:
USER_ID
0PvoRdl9lZaQKwX
1Hj35eXKXQLEQIO
12DanSBoMB4kW6F
1AcVMmDxHOf2XyD
1e7Rf8t6rQszkwC
2yVdWfrA5lBzKCj
0jq5SR09SlnzErs
1FEvjqau40IbUd9
2lSkFlA9Tg1ev9g
34PkInSOZzK1hrh
1fOWJhwxWPJNIJn
21HQIrlhZei9YKK
1qS4AirfNQk5dzB
0bV7i4JK7XmdiY8
1yp3K98es5FNj4j
2qAu8ymZyFko95t
0QffmxHtPu0Cziw
32uStZ8t4NhzWV5
06ogPB4SAEwPIjg
1r97Qq8Jts1IqEl
Query:
--Description: 3) Examine bounce events in the same time window to see which notifications failed.
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "APP_GROUP_ID",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
Answer:
ID,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,APP_GROUP_ID,TIME
QYMW1PkxzW3vSt,1zoENQchq3gFHhg,dXG6PLAuKAJv3vK,s9E0leDLYGJQWKO,ios,JyWFOSKn8bq,1685606766
zfCMY99jFz6kQS,1nJeGx4kpRerTwG,oGXu06hgprN7n4A,SXUeIlnkGQu5Vd4,ios,JyWFOSKn8bq,1685607881
JYRhU35U88i58e,0l76sh9jpU6Cbib,cfMm7suIWeZEivg,ZyIqigV69RjgSQq,android,OkIYT1HbF7u,1685609820
titie50rUtSSXY,17FxHaQWRvFhF85,7F3cNEq4u3NieO4,G9QPvVZwLE2tHfF,android,OkIYT1HbF7u,1685606518
K0FNM6v5OJTtoG,0SFfhUjBu3FoBK8,7PZvMEgW7LpaTuu,Gu2xbWlsu
Query:
--Description: 4) Look at open events (users actually tapped the push) during the hour, including device data.
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "DEVICE_MODEL",
    "CARRIER",
    "BROWSER",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
Answer:
ID,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,DEVICE_MODEL,CARRIER,BROWSER,TIME
Lpxa1x1wMewQpP,2qqe884u221g2Mw,FC2IvzYewW5DjGI,yxzrtvaHxJQcPaD,ios,HUAWEI P30 PRO,rklf1h9,QJl5KtT,1685609976
qiouWxHfjBI91j,0YDFJlKpftZeqLT,OXay4LwHYCEoFmF,Wfum4MMLTn0x1O1,android,HUAWEI P30 PRO,F7lgCub,n58ctaR,1685609485
sQ6RKm6zvZus3G,32P1daRhKQHjkdi,2Y8NMPufhGqDBnt,APOd7pDrAgk3x2r,android,HUAWEI P30 PRO,FWmpdw4,llu0KtH,1685609710
ACMm5VkJSyt8gz,1WnGcZaTkLcrQqy,9wdjgrSzrY6rPO2,UaB6AaKigC5CBQp,android,HUA
Query:
--Description: 5) Retrieve the different mobile carriers associated with openings in that hour.
SELECT DISTINCT 
    "CARRIER"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
Answer:
CARRIER
84XSIdX
eBnsMip
4KGqSEF
7l0pa6O
IbjpnaO
XJKcsFb
lXEM4R5
LaUSLDu
5NVSL5d
xF2MnhC
TSvIOce
CCPLXPK
xQBCauw
CuTGasv
ve6mFcq
BQltGAT
wlAcZkP
l3X7SNl
GyzIiY0
ds9Se1F
Query:
--Description: 6) Inspect “influenced open” events (user opened the app within attrib-window after seeing push).
SELECT 
    "ID",
    "USER_ID",
    "CAMPAIGN_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM",
    "TIME"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
Answer:
ID,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,TIME
CvHJ95obFRWUDr,26xMHPvA2p8om1Z,caerM3W3Stan0XB,BqNgpebG2pkR6gU,ios,1685607168
E2xFhztJQod9aQ,26OtS2Ln3Oi3rKO,snp4CvlFBlk627P,HcmDZ87pEPjC0EN,android,1685608178
5L3Le8WLMDCoZ4,0iFjSjbugTja0jg,bb1QRT5WBTib0O9,Z4eKwlh0f1b7gFc,ios,1685609577
A0AIcxIHfn7rbe,1LHhR33oELcUwLd,aTY8MFvXklm8itQ,lNFDPEK5fgCso7A,ios,1685608904
cvxHkn0dIIlgUc,2WtZW1CO8wRBxYw,n6VwXwof8M30u69,QAoUXQNLOJUAAeF,ios,1685609942
cBdyA6xfGRNSpp,267SO6HU34o48UF,1Q04JOZsSoO
Query:
--Description: 7) Aggregate: number of sends by platform for the one-hour window.
SELECT 
    "PLATFORM",
    COUNT(*)                       AS "push_notification_sends"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW
WHERE "TIME" BETWEEN 1685606400 AND 1685610000
GROUP BY "PLATFORM"
LIMIT 20;
Answer:
PLATFORM,push_notification_sends
android,516
ios,484
Query:
--Description: 8) Join sends with opens to see which sends were actually opened (sample 20 rows).
SELECT 
    s."ID"                         AS "send_id",
    s."USER_ID",
    s."CAMPAIGN_ID",
    s."MESSAGE_VARIATION_ID",
    s."PLATFORM",
    o."ID"                         AS "open_id",
    o."TIME"                       AS "open_time"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW  s
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW o
      ON  s."USER_ID"              = o."USER_ID"
      AND s."MESSAGE_VARIATION_ID" = o."MESSAGE_VARIATION_ID"
      AND o."TIME" BETWEEN 1685606400 AND 1685610000
WHERE s."TIME" BETWEEN 1685606400 AND 1685610000
LIMIT 20;
Answer:
send_id,USER_ID,CAMPAIGN_ID,MESSAGE_VARIATION_ID,PLATFORM,open_id,open_time
jTGNiZ8se73DAF,2cm2glsWU2DFHJD,,,ios,,
nyYgZBcfm7ygdF,1VF5dEHv5I2EsFs,6xxajDsJRL6ZeF3,vQ3NDVRTyOg30Ny,android,,
mhdH40f1q7Sl08,1EKfBfPmfxDhJNE,yNMmI42vFKxZ2V9,mJJzPQuZzsqNesB,android,,
QaKmaVe8xXKLpl,20wsj5Ba1BFTAWl,H6hyiXzIv8PV0uC,1gBd6WlvvNpUlAy,android,,
c1WZT9Gohf5ess,0Xpn1yhtPduJJ3T,nHZJVE8EZ0iB214,tRnMAS0OyH1dlKd,android,,
j9bupKvBimJZ0Z,1mZR2xjhv1E6ac2,UtQUXPEmftaiufe,PAgKq2CXwlF3UOS,ios,,
Query:
--Description: 9) Campaign-level open-vs-send counts in the time window (top 20).
SELECT
    s."CAMPAIGN_ID",
    COUNT(*)                                     AS "push_notification_sends",
    COUNT(o."ID")                                AS "push_notification_open"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW  s
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW o
      ON  s."USER_ID"              = o."USER_ID"
      AND s."MESSAGE_VARIATION_ID" = o."MESSAGE_VARIATION_ID"
      AND o."TIME" BETWEEN 1685606400 AND 1685610000
WHERE s."TIME" BETWEEN 1685606400 AND 1685610000
GROUP BY s."CAMPAIGN_ID"
LIMIT 20;
Answer:
CAMPAIGN_ID,push_notification_sends,push_notification_open
FUdoMRQ8oFBrvAX,1,0
SvbotUAPk4qcgQ3,2,0
YKEAaOdr1t1lNzm,2,0
1dkgJlITBhtnyZM,1,0
QQYIfRMmHKSs2HF,1,0
yuSxBN2ge1Q9DJD,1,0
ViBabKznJzt7Xg1,2,0
2Y8NMPufhGqDBnt,1,1
lb76acinztTr7gZ,1,0
6ajlu7AXDZHqJZF,1,0
JfK57cru3r7WFJ1,1,0
2unqYg8qHdzS2Sf,1,0
4lkKgoBBDAUIkth,1,0
zf5l7j3SzK429lQ,1,0
FNgu4XVcWV0UKBj,1,0
M0RTv3IG0DLZYp4,1,0
nO4z0ephi8zTOVs,1,0
Rtd0yeF6ZkduUbu,1,0
Y2I4tgHp9vJQB4v,1,0
dgHzDlkaWY9Omiv,1,1
Query:
--Description: 10) Consolidated metrics (sends, bounces, opens, influenced opens) for each campaign in the hour.
SELECT
    COALESCE(s."CAMPAIGN_ID", b."CAMPAIGN_ID", o."CAMPAIGN_ID", i."CAMPAIGN_ID") AS "CAMPAIGN_ID",
    COUNT(DISTINCT s."ID")  AS "push_notification_sends",
    COUNT(DISTINCT b."ID")  AS "push_notification_bounced",
    COUNT(DISTINCT o."ID")  AS "push_notification_open",
    COUNT(DISTINCT i."ID")  AS "push_notification_influenced_open"
FROM BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW           s
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW    b
       ON s."CAMPAIGN_ID" = b."CAMPAIGN_ID"
      AND b."TIME" BETWEEN 1685606400 AND 1685610000
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW      o
       ON s."CAMPAIGN_ID" = o."CAMPAIGN_ID"
      AND o."TIME" BETWEEN 1685606400 AND 1685610000
LEFT JOIN BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW i
       ON s."CAMPAIGN_ID" = i."CAMPAIGN_ID"
      AND i."TIME" BETWEEN 1685606400 AND 1685610000
WHERE s."TIME" BETWEEN 1685606400 AND 1685610000
GROUP BY COALESCE(s."CAMPAIGN_ID", b."CAMPAIGN_ID", o."CAMPAIGN_ID", i."CAMPAIGN_ID")
LIMIT 20;
Answer:
CAMPAIGN_ID,push_notification_sends,push_notification_bounced,push_notification_open,push_notification_influenced_open
kJkDHA6hCVPcXrB,1,0,0,0
tjvU8ERKUMQF1UW,1,0,0,0
Dkef4xy74r6ahbv,1,0,0,0
fKLQBAx6erJq0jj,2,0,0,0
9WCto5H6icJrEiR,1,0,0,0
mn2mJObtjkZcmQ0,2,0,0,0
nOFh8UGZKeC7nel,1,0,0,0
duyzRD4I9tPcE1o,1,0,0,0
3Rruj0m4G9UPZug,1,0,0,0
PyBOvgK3494tCqj,1,0,0,0
nMX89IzrSiYu7i7,1,0,0,0
lBP78Ef9uM584Vc,1,0,1,0
diJ3f8yv9xtFMhQ,1,0,0,0
eXHW492uzMtiZ6v,3,1,0,0
HICoq7JY9vQTAZ8,1,0,0,0
lgSER
Task: Examine user engagement with push notifications within a specified one-hour window on June 1, 2023.

Please think step by step and answer only one complete SQL in snowflake dialect in ```sql``` format.
SQL usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'BRAZE_USER_EVENT_DEMO_DATASET': {'PUBLIC': ['USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_OPEN_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW', 'USERS_CAMPAIGNS_ENROLLINCONTROL_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_IOSFOREGROUND_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_SEND_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_SHARED_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW', 'USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_SHARED_VIEW']}}

When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
If the task description does not specify the number of decimal places, retain all decimals to four places.

[Self-refine]
2025-05-07 07:33:56 - Thread-830 (execute) - INFO - [Try to run SQL in self-refine]
```sql
/* -------------------------------------------------------------------------
   Examine user engagement with push notifications that occurred between
   08:00 UTC and 09:00 UTC on 01-Jun-2023 (epoch 1685606400 – 1685610000).

   The query produces one row per combination of
       APP_GROUP_ID · CAMPAIGN_ID · USER_ID · MESSAGE_VARIATION_ID · PLATFORM
   and returns consolidated counts for:
       – sends
       – bounces
       – opens
       – influenced opens
   together with key user-/device-level context.
------------------------------------------------------------------------- */
WITH
/* 1 ───────────────────────────────── PUSH NOTIFICATION SENDS ───────────────── */
send_events AS (
    SELECT
        "APP_GROUP_ID",
        "CAMPAIGN_ID",
        "USER_ID",
        "MESSAGE_VARIATION_ID",
        "PLATFORM",
        "AD_TRACKING_ENABLED",
        COUNT(*)                     AS "push_notification_sends"
    FROM   BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_SEND_VIEW
    WHERE  "TIME" BETWEEN 1685606400 AND 1685610000
    GROUP  BY
        "APP_GROUP_ID",
        "CAMPAIGN_ID",
        "USER_ID",
        "MESSAGE_VARIATION_ID",
        "PLATFORM",
        "AD_TRACKING_ENABLED"
),

/* 2 ───────────────────────────────── PUSH NOTIFICATION BOUNCES ─────────────── */
bounce_events AS (
    SELECT
        "APP_GROUP_ID",
        "CAMPAIGN_ID",
        "USER_ID",
        "MESSAGE_VARIATION_ID",
        "PLATFORM",
        "AD_TRACKING_ENABLED",
        COUNT(*)                     AS "push_notification_bounced"
    FROM   BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_BOUNCE_VIEW
    WHERE  "TIME" BETWEEN 1685606400 AND 1685610000
    GROUP  BY
        "APP_GROUP_ID",
        "CAMPAIGN_ID",
        "USER_ID",
        "MESSAGE_VARIATION_ID",
        "PLATFORM",
        "AD_TRACKING_ENABLED"
),

/* 3 ───────────────────────────────── PUSH NOTIFICATION OPENS ───────────────── */
open_events AS (
    SELECT
        "APP_GROUP_ID",
        "CAMPAIGN_ID",
        "USER_ID",
        "MESSAGE_VARIATION_ID",
        "PLATFORM",
        "AD_TRACKING_ENABLED",
        MAX("DEVICE_MODEL")          AS "DEVICE_MODEL",
        MAX("CARRIER")               AS "CARRIER",
        MAX("BROWSER")               AS "BROWSER",
        COUNT(*)                     AS "push_notification_open"
    FROM   BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_OPEN_VIEW
    WHERE  "TIME" BETWEEN 1685606400 AND 1685610000
    GROUP  BY
        "APP_GROUP_ID",
        "CAMPAIGN_ID",
        "USER_ID",
        "MESSAGE_VARIATION_ID",
        "PLATFORM",
        "AD_TRACKING_ENABLED"
),

/* 4 ─────────────────────────────── INFLUENCED OPENS ────────────────────────── */
influenced_open_events AS (
    SELECT
        /* This view does not include APP_GROUP_ID or AD_TRACKING_ENABLED */
        NULL                         AS "APP_GROUP_ID",
        "CAMPAIGN_ID",
        "USER_ID",
        "MESSAGE_VARIATION_ID",
        "PLATFORM",
        NULL                         AS "AD_TRACKING_ENABLED",
        COUNT(*)                     AS "push_notification_influenced_open"
    FROM   BRAZE_USER_EVENT_DEMO_DATASET.PUBLIC.USERS_MESSAGES_PUSHNOTIFICATION_INFLUENCEDOPEN_VIEW
    WHERE  "TIME" BETWEEN 1685606400 AND 1685610000
    GROUP  BY
        "CAMPAIGN_ID",
        "USER_ID",
        "MESSAGE_VARIATION_ID",
        "PLATFORM"
)

/* 5 ──────────────────────────────── CONSOLIDATED VIEW ──────────────────────── */
SELECT
    /* dimensional columns */
    COALESCE(s."APP_GROUP_ID",  b."APP_GROUP_ID",  o."APP_GROUP_ID",  i."APP_GROUP_ID")                 AS "APP_GROUP_ID",
    COALESCE(s."CAMPAIGN_ID",   b."CAMPAIGN_ID",   o."CAMPAIGN_ID",   i."CAMPAIGN_ID")                  AS "CAMPAIGN_ID",
    COALESCE(s."USER_ID",       b."USER_ID",       o."USER_ID",       i."USER_ID")                      AS "USER_ID",
    COALESCE(s."MESSAGE_VARIATION_ID", b."MESSAGE_VARIATION_ID", o."MESSAGE_VARIATION_ID", i."MESSAGE_VARIATION_ID")
                                                                                                        AS "MESSAGE_VARIATION_ID",
    COALESCE(s."PLATFORM",      b."PLATFORM",      o."PLATFORM",      i."PLATFORM")                     AS "PLATFORM",
    COALESCE(s."AD_TRACKING_ENABLED", b."AD_TRACKING_ENABLED", o."AD_TRACKING_ENABLED", i."AD_TRACKING_ENABLED")
                                                                                                        AS "AD_TRACKING_ENABLED",
    /* device context (only present for open events) */
    o."DEVICE_MODEL",
    o."CARRIER",
    o."BROWSER",

    /* engagement metrics */
    COALESCE(s."push_notification_sends",           0) AS "push_notification_sends",
    COALESCE(b."push_notification_bounced",         0) AS "push_notification_bounced",
    COALESCE(o."push_notification_open",            0) AS "push_notification_open",
    COALESCE(i."push_notification_influenced_open", 0) AS "push_notification_influenced_open"
FROM   send_events                AS s
FULL   OUTER JOIN bounce_events   AS b
       ON  s."APP_GROUP_ID"         = b."APP_GROUP_ID"
       AND s."CAMPAIGN_ID"          = b."CAMPAIGN_ID"
       AND s."USER_ID"              = b."USER_ID"
       AND s."MESSAGE_VARIATION_ID" = b."MESSAGE_VARIATION_ID"
       AND s."PLATFORM"             = b."PLATFORM"
FULL   OUTER JOIN open_events     AS o
       ON  COALESCE(s."APP_GROUP_ID",  b."APP_GROUP_ID")          = o."APP_GROUP_ID"
       AND COALESCE(s."CAMPAIGN_ID",   b."CAMPAIGN_ID")           = o."CAMPAIGN_ID"
       AND COALESCE(s."USER_ID",       b."USER_ID")               = o."USER_ID"
       AND COALESCE(s."MESSAGE_VARIATION_ID", b."MESSAGE_VARIATION_ID")
                                                                  = o."MESSAGE_VARIATION_ID"
       AND COALESCE(s."PLATFORM",      b."PLATFORM")              = o."PLATFORM"
FULL   OUTER JOIN influenced_open_events AS i
       ON  COALESCE(s."CAMPAIGN_ID",   b."CAMPAIGN_ID",   o."CAMPAIGN_ID")   = i."CAMPAIGN_ID"
       AND COALESCE(s."USER_ID",       b."USER_ID",       o."USER_ID")       = i."USER_ID"
       AND COALESCE(s."MESSAGE_VARIATION_ID", b."MESSAGE_VARIATION_ID", o."MESSAGE_VARIATION_ID")
                                                                             = i."MESSAGE_VARIATION_ID"
       AND COALESCE(s."PLATFORM",      b."PLATFORM",      o."PLATFORM")      = i."PLATFORM"
ORDER BY
    "APP_GROUP_ID",
    "CAMPAIGN_ID",
    "USER_ID",
    "MESSAGE_VARIATION_ID",
    "PLATFORM";
```
[Try to run SQL in self-refine]
2025-05-07 07:33:59 - Thread-830 (execute) - INFO - Total iteration counts: 0
