2025-07-01 04:05:20 - Thread-1 (execute) - INFO - [Exploration]
```sql
-- Description: Retrieve the distinct CPC codes in the PUBLICATIONS table to understand the hierarchy and availability of "A61" category.
SELECT DISTINCT f.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 20;
```

```sql
-- Description: Filter the records specifically related to category 'A61' in the PUBLICATIONS table using CPC codes.
SELECT DISTINCT f.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
LIMIT 20;
```

```sql
-- Description: Retrieve all relevant details of patents under CPC category 'A61' to identify the assignees related to this category.
SELECT t."family_id", t."assignee_harmonized", f.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
LIMIT 20;
```

```sql
-- Description: Find out distinct assignees who have filed applications in the 'A61' category.
SELECT DISTINCT t."assignee_harmonized"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
LIMIT 20;
```

```sql
-- Description: Count the number of applications filed by each assignee under 'A61' category to determine the assignee with the most filings.
SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
GROUP BY t."assignee_harmonized"
ORDER BY "application_count" DESC
LIMIT 20;
```

```sql
-- Description: Retrieve the filing dates of applications for the top assignee (most applications) under 'A61' category.
SELECT t."filing_date", COUNT(*) AS "applications"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = 'TOP_ASSIGNEE' -- Replace 'TOP_ASSIGNEE' with the name of the assignee retrieved from previous query
GROUP BY t."filing_date"
ORDER BY "applications" DESC
LIMIT 20;
```

```sql
-- Description: Retrieve distinct application numbers of patents filed by the top assignee with the most records in 'A61' category.
SELECT DISTINCT t."application_number"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = 'TOP_ASSIGNEE' -- Replace 'TOP_ASSIGNEE' as obtained previously
LIMIT 20;
```

```sql
-- Description: Retrieve the year and the number of applications filed by the top assignee in 'A61' to analyze yearly trends.
SELECT YEAR(DATE_FROM_PARTS((t."filing_date" / 10000)::INT, ((t."filing_date" % 10000) / 100)::INT, (t."filing_date" % 100)::INT)) AS "year", COUNT(*) AS "applications"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = 'TOP_ASSIGNEE' -- Replace the placeholder with exact name
GROUP BY "year"
ORDER BY "applications" DESC
LIMIT 20;
```

```sql
-- Description: Retrieve family IDs of patents filed under 'A61' by the top assignee with the most filings.
SELECT DISTINCT t."family_id"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = 'TOP_ASSIGNEE' -- Replace the placeholder with top assignee's name
LIMIT 20;
```

```sql
-- Description: Retrieve publication details for patents under 'A61' filed in the year with the most applications associated with the top assignee.
SELECT t."publication_number", t."application_number", t."country_code", t."publication_date", t."title_localized"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = 'TOP_ASSIGNEE' -- Replace with the name of the top assignee
  AND YEAR(DATE_FROM_PARTS((t."filing_date" / 10000)::INT, ((t."filing_date" % 10000) / 100)::INT, (t."filing_date" % 100)::INT)) = 'TARGET_YEAR' -- Replace TARGET_YEAR with the year identified earlier
LIMIT 20;
```
[Exploration]
2025-07-01 04:05:20 - Thread-1 (execute) - INFO - [Try to execute]
-- Description: Retrieve the distinct CPC codes in the PUBLICATIONS table to understand the hierarchy and availability of "A61" category.
SELECT DISTINCT f.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 20;
[Try to execute]
2025-07-01 04:05:21 - Thread-1 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Retrieve the distinct CPC codes in the PUBLICATIONS table to understand the hierarchy and availability of "A61" category.
SELECT DISTINCT f.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 20;
Results:
cpc_code
A61M5/30
H03M13/2789
A61P25/06
A61K2039/58
A61P21/02
A61K9/4866
C25D9/10
B29C66/524
B24C1/02
B65D71/504
C12P7/44
C07K9/00
C10N2040/32
H04L61/00
C10M129/95
B23K2103/54
A61P17/00
H01M50/284
A61K38/39
C12N2320/33

[Successfully executed]
2025-07-01 04:05:21 - Thread-1 (execute) - INFO - [Try to execute]
-- Description: Filter the records specifically related to category 'A61' in the PUBLICATIONS table using CPC codes.
SELECT DISTINCT f.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
LIMIT 20;
[Try to execute]
2025-07-01 04:05:22 - Thread-1 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Filter the records specifically related to category 'A61' in the PUBLICATIONS table using CPC codes.
SELECT DISTINCT f.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
LIMIT 20;
Results:
cpc_code
A61M2205/52
A61P21/00
A61P17/12
A61B8/485
A61B8/5253
A61P13/08
A61B1/00135
A61P17/00
A61K9/0017
A61K31/7088
A61B6/484
A61M16/04
A61P29/00
A61B8/08
A61B5/1126
A61M16/06
A61B1/053
A61P25/04
A61P33/10
A61K47/14

[Successfully executed]
2025-07-01 04:05:22 - Thread-1 (execute) - INFO - [Try to execute]
-- Description: Retrieve all relevant details of patents under CPC category 'A61' to identify the assignees related to this category.
SELECT t."family_id", t."assignee_harmonized", f.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
LIMIT 20;
[Try to execute]
2025-07-01 04:05:31 - Thread-1 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Retrieve all relevant details of patents under CPC category 'A61' to identify the assignees related to this category.
SELECT t."family_id", t."assignee_harmonized", f.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
LIMIT 20;
Results:
family_id,assignee_harmonized,cpc_code
79024315,[],A61F9/00838
79024315,[],A61F9/00827
79024315,[],A61F2009/00872
79024315,[],A61F2009/00897
79024315,[],A61F2009/00872
82157418,[],A61P1/08
82157418,[],A61K31/675
82157418,[],A61K31/675
82157418,[],A61K31/661
82157418,[],A61K45/06
82157418,[],A61K31/473
82157418,[],A61K31/4178
82157418,[],A61K31/439
82157418,[],A61K31/4184
82157418,[],A61K31/46
82157418,[],A61K31/473

[Successfully executed]
2025-07-01 04:05:31 - Thread-1 (execute) - INFO - [Try to execute]
-- Description: Find out distinct assignees who have filed applications in the 'A61' category.
SELECT DISTINCT t."assignee_harmonized"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
LIMIT 20;
[Try to execute]
2025-07-01 04:05:44 - Thread-1 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Find out distinct assignees who have filed applications in the 'A61' category.
SELECT DISTINCT t."assignee_harmonized"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
LIMIT 20;
Results:
assignee_harmonized
"[
  {
    ""country_code"": """",
    ""name"": ""UNIV PENNSYLVANIA""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GLOBUS MEDICAL INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LEO PHARMA AS""
  }
]"
"[
  {
    ""country_code"": ""IN"",
    ""name"": ""RANBAXY LAB LTD""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PROCTER & GAMBLE""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""CORNSWEET TOM N""
  },
  {
    

[Successfully executed]
2025-07-01 04:05:44 - Thread-1 (execute) - INFO - [Try to execute]
-- Description: Count the number of applications filed by each assignee under 'A61' category to determine the assignee with the most filings.
SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
GROUP BY t."assignee_harmonized"
ORDER BY "application_count" DESC
LIMIT 20;
[Try to execute]
2025-07-01 04:05:44 - Thread-1 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Count the number of applications filed by each assignee under 'A61' category to determine the assignee with the most filings.
SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
GROUP BY t."assignee_harmonized"
ORDER BY "application_count" DESC
LIMIT 20;
Results:
assignee_harmonized,application_count
[],56002
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PROCTER & GAMBLE""
  }
]",2302
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""NOVARTIS AG""
  }
]",1629
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COVIDIEN LP""
  }
]",1304
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER""
  }
]",1279
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""OREAL""
  }
]",1212
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""HOFF

[Successfully executed]
2025-07-01 04:05:44 - Thread-1 (execute) - INFO - [Try to execute]
-- Description: Retrieve the filing dates of applications for the top assignee (most applications) under 'A61' category.
SELECT t."filing_date", COUNT(*) AS "applications"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = 'TOP_ASSIGNEE' -- Replace 'TOP_ASSIGNEE' with the name of the assignee retrieved from previous query
GROUP BY t."filing_date"
ORDER BY "applications" DESC
LIMIT 20;
[Try to execute]
2025-07-01 04:06:01 - Thread-1 (execute) - INFO - [Error occurred]
No data found for the specified query.

[Error occurred]
2025-07-01 04:07:01 - Thread-1 (execute) - INFO - [Corrected SQL]
### Thinking Process:
1. The earlier error indicates overly narrow filtering, specifically due to the explicit condition for a single assignee (`t."assignee_harmonized" = 'TOP_ASSIGNEE'`), which likely resulted in no data being returned.
2. To resolve this, we need to focus on dynamically determining the top assignee from the 'A61' category based on the number of applications before drilling into filing dates.
3. The current goal is to revise the query to dynamically find filing trends for applications by the actual top-performing assignee without hardcoding the assignee.
4. Thus, we will create a query that identifies the top assignee with the maximum applications and calculates their filing trends in descending order of applications.

```sql
-- Description: Retrieve the filing dates and application counts of the top assignee with the most filings under the 'A61' category.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
)
SELECT t."filing_date", COUNT(*) AS "applications"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
GROUP BY t."filing_date"
ORDER BY "applications" DESC
LIMIT 20;
```
[Corrected SQL]
2025-07-01 04:09:32 - Thread-1 (execute) - INFO - [Results for corrected sql]
filing_date,applications
20140313,183
20211028,177
20120507,162
20150820,150
0,137
20131204,121
20190906,116
20170629,112
20161019,112
20020613,110
20161123,107
20130830,106
20150326,106
20061012,104
20170508,103
20181213,99
20100319,94
20060524,92
19980326,91
20130201,91

[Results for corrected sql]
2025-07-01 04:10:32 - Thread-1 (execute) - INFO - [Corrected other sqls]
```sql
-- Description: Retrieve distinct application numbers of patents filed by the top assignee with the most records in the 'A61' category.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
)
SELECT DISTINCT t."application_number"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
LIMIT 20;
```

```sql
-- Description: Retrieve the year and the number of applications filed by the top assignee in the 'A61' category to analyze yearly trends.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
)
SELECT YEAR(DATE_FROM_PARTS((t."filing_date" / 10000)::INT, ((t."filing_date" % 10000) / 100)::INT, (t."filing_date" % 100)::INT)) AS "year", COUNT(*) AS "applications"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
GROUP BY "year"
ORDER BY "applications" DESC
LIMIT 20;
```

```sql
-- Description: Retrieve family IDs of patents filed under the 'A61' category by the top assignee with the most filings.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
)
SELECT DISTINCT t."family_id"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
LIMIT 20;
```

```sql
-- Description: Retrieve publication details for patents under the 'A61' category filed in the year with the most applications associated with the top assignee.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
),
TopYear AS (
    SELECT YEAR(DATE_FROM_PARTS((t."filing_date" / 10000)::INT, ((t."filing_date" % 10000) / 100)::INT, (t."filing_date" % 100)::INT)) AS "year"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
      AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
    GROUP BY "year"
    ORDER BY COUNT(*) DESC
    LIMIT 1
)
SELECT t."publication_number", t."application_number", t."country_code", t."publication_date", t."title_localized"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
  AND YEAR(DATE_FROM_PARTS((t."filing_date" / 10000)::INT, ((t."filing_date" % 10000) / 100)::INT, (t."filing_date" % 100)::INT)) = (SELECT "year" FROM TopYear)
LIMIT 20;
```
[Corrected other sqls]
2025-07-01 04:10:32 - Thread-1 (execute) - INFO - [Successfully corrected]
Successfully executed. SQL:
-- Description: Retrieve the filing dates of applications for the top assignee (most applications) under 'A61' category.
SELECT t."filing_date", COUNT(*) AS "applications"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = 'TOP_ASSIGNEE' -- Replace 'TOP_ASSIGNEE' with the name of the assignee retrieved from previous query
GROUP BY t."filing_date"
ORDER BY "applications" DESC
LIMIT 20;
Results:
filing_date,applications
20140313,183
20211028,177
20120507,162
20150820,150
0,137
20131204,121
20190906,116
20170629,112
20161019,112
20020613,110
20161123,107
20130830,106
20150326,106
20061012,104
20170508,103
20181213,99
20100319,94
20060524,92
19980326,91
20130201,91

[Successfully corrected]
2025-07-01 04:10:32 - Thread-1 (execute) - INFO - [Try to execute]
-- Description: Retrieve distinct application numbers of patents filed by the top assignee with the most records in the 'A61' category.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
)
SELECT DISTINCT t."application_number"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
LIMIT 20;
[Try to execute]
2025-07-01 04:13:04 - Thread-1 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Retrieve distinct application numbers of patents filed by the top assignee with the most records in the 'A61' category.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
)
SELECT DISTINCT t."application_number"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
LIMIT 20;
Results:
application_number
US-438653D-A
JP-2013529470-A
JP-2013546219-A
JP-2020568129-A
BE-160541-A
JP-2002572997-A
JP-2015535027-A
US-202118268251-A
KR-20020033768-A
JP-2019552771-A
BE-486193D-A
SK-38595-A
JP-2023533533-A
US-49398404-A
BE-345960D-A
BE-632555D-A
US-207103D-A
JP-2017254941-A
JP-2012534058-A
JP-10395673-A

[Successfully executed]
2025-07-01 04:13:04 - Thread-1 (execute) - INFO - [Try to execute]
-- Description: Retrieve the year and the number of applications filed by the top assignee in the 'A61' category to analyze yearly trends.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
)
SELECT YEAR(DATE_FROM_PARTS((t."filing_date" / 10000)::INT, ((t."filing_date" % 10000) / 100)::INT, (t."filing_date" % 100)::INT)) AS "year", COUNT(*) AS "applications"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
GROUP BY "year"
ORDER BY "applications" DESC
LIMIT 20;
[Try to execute]
2025-07-01 04:13:48 - Thread-1 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Retrieve the year and the number of applications filed by the top assignee in the 'A61' category to analyze yearly trends.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
)
SELECT YEAR(DATE_FROM_PARTS((t."filing_date" / 10000)::INT, ((t."filing_date" % 10000) / 100)::INT, (t."filing_date" % 100)::INT)) AS "year", COUNT(*) AS "applications"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
GROUP BY "year"
ORDER BY "applications" DESC
LIMIT 20;
Results:
year,applications
2016,3648
2017,3540
2018,3284
2015,3199
2019,2798
2014,2668
2013,2638
2002,2265
2021,2258
2011,2158
2020,2133
2012,2020
2004,1934
2003,1895
2009,1894
2010,1747
2006,1562
2001,1537
2022,1420
2005,1320

[Successfully executed]
2025-07-01 04:13:48 - Thread-1 (execute) - INFO - [Try to execute]
-- Description: Retrieve family IDs of patents filed under the 'A61' category by the top assignee with the most filings.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
)
SELECT DISTINCT t."family_id"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
LIMIT 20;
[Try to execute]
2025-07-01 04:14:00 - Thread-1 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Retrieve family IDs of patents filed under the 'A61' category by the top assignee with the most filings.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
)
SELECT DISTINCT t."family_id"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
LIMIT 20;
Results:
family_id
40341833
27758881
51220489
27732449
50483406
56014607
8854904
40688848
32045865
56355774
59361448
24353148
42697268
70463639
14730225
24998889
56692619
56564049
60117814
6522064

[Successfully executed]
2025-07-01 04:14:00 - Thread-1 (execute) - INFO - [Try to execute]
-- Description: Retrieve publication details for patents under the 'A61' category filed in the year with the most applications associated with the top assignee.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
),
TopYear AS (
    SELECT YEAR(DATE_FROM_PARTS((t."filing_date" / 10000)::INT, ((t."filing_date" % 10000) / 100)::INT, (t."filing_date" % 100)::INT)) AS "year"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
      AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
    GROUP BY "year"
    ORDER BY COUNT(*) DESC
    LIMIT 1
)
SELECT t."publication_number", t."application_number", t."country_code", t."publication_date", t."title_localized"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
  AND YEAR(DATE_FROM_PARTS((t."filing_date" / 10000)::INT, ((t."filing_date" % 10000) / 100)::INT, (t."filing_date" % 100)::INT)) = (SELECT "year" FROM TopYear)
LIMIT 20;
[Try to execute]
2025-07-01 04:14:26 - Thread-1 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Retrieve publication details for patents under the 'A61' category filed in the year with the most applications associated with the top assignee.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
),
TopYear AS (
    SELECT YEAR(DATE_FROM_PARTS((t."filing_date" / 10000)::INT, ((t."filing_date" % 10000) / 100)::INT, (t."filing_date" % 100)::INT)) AS "year"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
      AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
    GROUP BY "year"
    ORDER BY COUNT(*) DESC
    LIMIT 1
)
SELECT t."publication_number", t."application_number", t."country_code", t."publication_date", t."title_localized"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
  AND YEAR(DATE_FROM_PARTS((t."filing_date" / 10000)::INT, ((t."filing_date" % 10000) / 100)::INT, (t."filing_date" % 100)::INT)) = (SELECT "year" FROM TopYear)
LIMIT 20;
Results:
publication_number,application_number,country_code,publication_date,title_localized
JP-WO2016178380-A1,JP-2017516591-A,JP,20171130,"[
  {
    ""language"": ""ja"",
    ""text"": ""化粧料組成物"",
    ""truncated"": false
  }
]"
JP-WO2016178380-A1,JP-2017516591-A,JP,20171130,"[
  {
    ""language"": ""ja"",
    ""text"": ""化粧料組成物"",
    ""truncated"": false
  }
]"
JP-WO2016178380-A1,JP-2017516591-A,JP,20171130,"[
  {
    ""language"": ""ja"",
    ""text"": ""化粧料組成物"",
    ""truncated"": false
  }
]"

[Successfully executed]
2025-07-01 04:14:26 - Thread-1 (execute) - INFO - itercount: 0
2025-07-01 04:14:26 - Thread-1 (execute) - INFO - [Self-refine]
Table full name: PATENTS.PATENTS.DISCLOSURES_13
Column name: serial_cleaned Type: TEXT
Column name: patent_owner_harmonized Type: TEXT
Column name: record_id Type: TEXT
Column name: family_id Type: TEXT
Column name: third_party Type: TEXT
Column name: date Type: NUMBER
Sample rows:
[{'family_id': '22549751', 'record_id': 'REC00002', 'patent_owner_harmonized': '3M', 'date': 19751124, 'third_party': '0', 'serial_cleaned': ''}, {'family_id': '23170520', 'record_id': 'REC00001', 'patent_owner_harmonized': '3M', 'date': 19751124, 'third_party': '0', 'serial_cleaned': ''}, {'family_id': '23170520', 'record_id': 'REC00006', 'patent_owner_harmonized': '3M', 'date': 19890711, 'third_party': '0', 'serial_cleaned': ''}, {'family_id': '22549751', 'record_id': 'REC00008', 'patent_owner_harmonized': '3M', 'date': 19890906, 'third_party': '0', 'serial_cleaned': ''}, {'family_id': '23418274', 'record_id': 'REC00024', 'patent_owner_harmonized': 'Agilent Technologies', 'date': 20020606, 'third_party': '0', 'serial_cleaned': ''}]
--------------------------------------------------
Table full name: PATENTS.PATENTS.PUBLICATIONS
Column name: application_number_formatted Type: TEXT Description: Application number, formatted to the patent office format where possible.
Column name: application_number Type: TEXT Description: Patent application number (DOCDB compatible), eg: 'US-87124404-A'. This may not always be set.
Column name: cpc Type: VARIANT Description: Two-letter language code for this text
Column name: publication_date Type: NUMBER Description: Two-letter language code for this text
Column name: ipc Type: VARIANT Description: Localized text
Column name: filing_date Type: NUMBER Description: Is this text truncated?
Column name: assignee Type: VARIANT Description: Localized text
Column name: fi Type: VARIANT Description: Is this text truncated?
Column name: inventor_harmonized Type: VARIANT Description: For US publications only, the claims in HTML
Column name: inventor Type: VARIANT Description: Is this text truncated?
Column name: application_kind Type: TEXT Description: High-level kind of the application: A=patent; U=utility; P=provision; W= PCT; F=design; T=translation.
Column name: assignee_harmonized Type: VARIANT Description: Two-letter language code for this text
Column name: title_localized Type: VARIANT Description: The publication titles in different languages
Column name: family_id Type: TEXT Description: Family ID (simple family). Grouping on family ID will return all publications associated with a simple patent family (all publications share the same priority claims).
Column name: publication_number Type: TEXT Description: Patent publication number (DOCDB compatible), eg: 'US-7650331-B1'
Column name: country_code Type: TEXT Description: Country code, eg: 'US', 'EP', etc
Sample rows:
[{'publication_number': 'DE-69611147-T2', 'application_number': 'DE-69611147-T', 'country_code': 'DE', 'application_kind': 'T', 'application_number_formatted': 'DE1996611147', 'family_id': '9483724', 'title_localized': '[\n  {\n    "language": "de",\n    "text": "Schloss vom Typ eines entkuppelbaren Rotors",\n    "truncated": false\n  }\n]', 'publication_date': 20010621, 'filing_date': 19961015, 'inventor_harmonized': '[\n  {\n    "country_code": "FR",\n    "name": "MENAGER CHRISTOPHE"\n  },\n  {\n    "country_code": "FR",\n    "name": "CANARD LOUIS"\n  },\n  {\n    "country_code": "FR",\n    "name": "CADOUOT PATRICK"\n  },\n  {\n    "country_code": "FR",\n    "name": "GOURDIN DOMINIQUE"\n  }\n]', 'assignee': '[\n  "Valeo Securite Habitacle, Creteil Cedex"\n]', 'assignee_harmonized': '[\n  {\n    "country_code": "FR",\n    "name": "VALEO SECURITE HABITACLE"\n  }\n]', 'ipc': '[\n  {\n    "code": "E05B17/04",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "E05B17/00",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  }\n]', 'cpc': '[\n  {\n    "code": "E05B77/00",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "E05B17/0058",\n    "first": true,\n    "inventive": true,\n    "tree": []\n  }\n]'}, {'publication_number': 'DE-69630331-T2', 'application_number': 'DE-69630331-T', 'country_code': 'DE', 'application_kind': 'T', 'application_number_formatted': 'DE1996630331', 'family_id': '23689246', 'title_localized': '[\n  {\n    "language": "de",\n    "text": "Verfahren zur gesicherten Sitzungsschlüsselerzeugung und zur Authentifizierung",\n    "truncated": false\n  }\n]', 'publication_date': 20040729, 'filing_date': 19960416, 'inventor_harmonized': '[\n  {\n    "country_code": "CA",\n    "name": "VANSTONE SCOTT A WATERLOO"\n  },\n  {\n    "country_code": "US",\n    "name": "MENEZES ALFRED JOHN AUBURN"\n  },\n  {\n    "country_code": "CA",\n    "name": "MINGHUA QU"\n  }\n]', 'assignee': '[\n  "Certicom Corp., Mississauga"\n]', 'assignee_harmonized': '[\n  {\n    "country_code": "CA",\n    "name": "CERTICOM CORP"\n  }\n]', 'ipc': '[\n  {\n    "code": "H04L9/08",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "G06F7/72",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  }\n]', 'cpc': '[\n  {\n    "code": "G06F7/725",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "H04L9/0844",\n    "first": true,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "H04L9/0838",\n    "first": true,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "H04L9/0844",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "G06F7/725",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  }\n]'}, {'publication_number': 'DE-69636755-T2', 'application_number': 'DE-69636755-T', 'country_code': 'DE', 'application_kind': 'T', 'application_number_formatted': 'DE1996636755', 'family_id': '8224764', 'title_localized': '[\n  {\n    "language": "de",\n    "text": "Immortalisierte menschliche Epithelzell-Linie",\n    "truncated": false\n  }\n]', 'publication_date': 20071011, 'filing_date': 19961224, 'inventor_harmonized': '[\n  {\n    "country_code": "CH",\n    "name": "OFFORD CAVIN ELIZABETH"\n  },\n  {\n    "country_code": "CH",\n    "name": "TROMVOUKIS YVONNE"\n  },\n  {\n    "country_code": "CH",\n    "name": "PFEIFER ANDREA M A"\n  },\n  {\n    "country_code": "US",\n    "name": "SHARIF NAJ"\n  }\n]', 'assignee': '[\n  "Société des Produits Nestlé S.A."\n]', 'assignee_harmonized': '[\n  {\n    "country_code": "CH",\n    "name": "NESTLE SA"\n  }\n]', 'ipc': '[\n  {\n    "code": "C12N5/10",\n    "first": true,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "G01N33/50",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "C12R1/91",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "C12N15/09",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "C12N5/00",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "A61K35/44",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "G01N33/48",\n    "first": true,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "C12Q1/68",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "C12N5/071",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  }\n]', 'cpc': '[\n  {\n    "code": "C12N2503/02",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "C12N5/0621",\n    "first": true,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "C12N2503/02",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "C12N2510/04",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "C12N5/0621",\n    "first": true,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "C12N2510/04",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  }\n]'}, {'publication_number': 'DE-69728658-T2', 'application_number': 'DE-69728658-T', 'country_code': 'DE', 'application_kind': 'T', 'application_number_formatted': 'DE1997628658', 'family_id': '24437397', 'title_localized': '[\n  {\n    "language": "de",\n    "text": "Lithographische dünne filmstruktur und diese enthaltende druckplatte",\n    "truncated": false\n  }\n]', 'publication_date': 20040812, 'filing_date': 19970115, 'inventor_harmonized': '[\n  {\n    "country_code": "US",\n    "name": "FISHER P"\n  },\n  {\n    "country_code": "US",\n    "name": "PHILLIPS W"\n  },\n  {\n    "country_code": "US",\n    "name": "DAVIS F"\n  },\n  {\n    "country_code": "US",\n    "name": "LEGALLEE CHARLOTTE"\n  }\n]', 'assignee': '[\n  "Presstek, Inc."\n]', 'assignee_harmonized': '[\n  {\n    "country_code": "US",\n    "name": "PRESSTEK INC"\n  }\n]', 'ipc': '[\n  {\n    "code": "B32B15/04",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "B41C1/10",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "B41N1/00",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "B41N1/14",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "B32B27/20",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "B32B7/02",\n    "first": true,\n    "inventive": true,\n    "tree": []\n  }\n]', 'cpc': '[\n  {\n    "code": "B32B15/04",\n    "first": true,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "Y10T428/12674",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "B32B27/20",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "Y10T428/31678",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "Y10T428/12458",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "Y10T428/31678",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "Y10T428/12458",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "B32B15/20",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "Y10T428/31504",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "B41N1/00",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "B32B15/09",\n    "first": true,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "B32B2367/00",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "B32B27/20",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "Y10T428/12493",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "B32B15/043",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "B32B27/36",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "B32B27/08",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "B32B15/04",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "Y10T428/12493",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "Y10T428/12674",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "B41C1/1033",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "B41N1/00",\n    "first": false,\n    "inventive": true,\n    "tree": []\n  },\n  {\n    "code": "Y10T428/12528",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "Y10T428/31504",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "B41C1/1033",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "B32B2311/24",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  },\n  {\n    "code": "Y10T428/12528",\n    "first": false,\n    "inventive": false,\n    "tree": []\n  }\n]'}, {'publication_number': 'DE-69807539-T2', 'application_number': 'DE-69807539-T', 'country_code': 'DE', 'application_kind': 'T', 'application_number_formatted': 'DE1998607539', 'family_id': '11877005', 'title_localized': '[\n  {\n    "language": "de",\n    "text": "Automatisches Analysegerät",\n    "truncated": false\n  }\n]', 'publication_date': 20030116, 'filing_date': 19980120, 'inventor_harmonized': '[\n  {\n    "country_code": "JP",\n    "name": "HANAWA MASAAKI"\n  },\n  {\n    "country_code": "JP",\n    "name": "MITSUMAKI HIROSHI"\n  },\n  {\n    "country_code": "JP",\n    "name": "OHISH
--------------------------------------------------
Table full name: PATENTS.PATENTS.CPC_DEFINITION
Column name: status Type: TEXT
Column name: level Type: FLOAT
Column name: titleFull Type: TEXT
Column name: symbol Type: TEXT
Column name: synonyms Type: VARIANT
Sample rows:
[{'level': 9.0, 'status': 'published', 'symbol': 'A01K2227/108', 'synonyms': '[]', 'titleFull': 'Swine'}, {'level': 9.0, 'status': 'published', 'symbol': 'A01K2227/105', 'synonyms': '[]', 'titleFull': 'Murine'}, {'level': 9.0, 'status': 'published', 'symbol': 'A01K2227/107', 'synonyms': '[]', 'titleFull': 'Rabbit'}, {'level': 9.0, 'status': 'published', 'symbol': 'A01K2267/025', 'synonyms': '[]', 'titleFull': 'Animal producing cells or organs for transplantation'}, {'level': 9.0, 'status': 'published', 'symbol': 'A01K2267/0306', 'synonyms': '[]', 'titleFull': 'Animal model for genetic diseases'}]
--------------------------------------------------
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'PATENTS': {'PATENTS': ['DISCLOSURES_13', 'PUBLICATIONS', 'CPC_DEFINITION']}}

Some few-shot examples after column exploration may be helpful:
Query:
-- Description: Retrieve the distinct CPC codes in the PUBLICATIONS table to understand the hierarchy and availability of "A61" category.
SELECT DISTINCT f.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 20;
Answer:
cpc_code
A61M5/30
H03M13/2789
A61P25/06
A61K2039/58
A61P21/02
A61K9/4866
C25D9/10
B29C66/524
B24C1/02
B65D71/504
C12P7/44
C07K9/00
C10N2040/32
H04L61/00
C10M129/95
B23K2103/54
A61P17/00
H01M50/284
A61K38/39
C12N2320/33
Query:
-- Description: Filter the records specifically related to category 'A61' in the PUBLICATIONS table using CPC codes.
SELECT DISTINCT f.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
LIMIT 20;
Answer:
cpc_code
A61M2205/52
A61P21/00
A61P17/12
A61B8/485
A61B8/5253
A61P13/08
A61B1/00135
A61P17/00
A61K9/0017
A61K31/7088
A61B6/484
A61M16/04
A61P29/00
A61B8/08
A61B5/1126
A61M16/06
A61B1/053
A61P25/04
A61P33/10
A61K47/14
Query:
-- Description: Retrieve all relevant details of patents under CPC category 'A61' to identify the assignees related to this category.
SELECT t."family_id", t."assignee_harmonized", f.value::VARIANT:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
LIMIT 20;
Answer:
family_id,assignee_harmonized,cpc_code
79024315,[],A61F9/00838
79024315,[],A61F9/00827
79024315,[],A61F2009/00872
79024315,[],A61F2009/00897
79024315,[],A61F2009/00872
82157418,[],A61P1/08
82157418,[],A61K31/675
82157418,[],A61K31/675
82157418,[],A61K31/661
82157418,[],A61K45/06
82157418,[],A61K31/473
82157418,[],A61K31/4178
82157418,[],A61K31/439
82157418,[],A61K31/4184
82157418,[],A61K31/46
82157418,[],A61K31/473
Query:
-- Description: Find out distinct assignees who have filed applications in the 'A61' category.
SELECT DISTINCT t."assignee_harmonized"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
LIMIT 20;
Answer:
assignee_harmonized
"[
  {
    ""country_code"": """",
    ""name"": ""UNIV PENNSYLVANIA""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""GLOBUS MEDICAL INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LEO PHARMA AS""
  }
]"
"[
  {
    ""country_code"": ""IN"",
    ""name"": ""RANBAXY LAB LTD""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PROCTER & GAMBLE""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""CORNSWEET TOM N""
  },
  {
    
Query:
-- Description: Count the number of applications filed by each assignee under 'A61' category to determine the assignee with the most filings.
SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
GROUP BY t."assignee_harmonized"
ORDER BY "application_count" DESC
LIMIT 20;
Answer:
assignee_harmonized,application_count
[],56002
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PROCTER & GAMBLE""
  }
]",2302
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""NOVARTIS AG""
  }
]",1629
"[
  {
    ""country_code"": ""US"",
    ""name"": ""COVIDIEN LP""
  }
]",1304
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PFIZER""
  }
]",1279
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""OREAL""
  }
]",1212
"[
  {
    ""country_code"": ""CH"",
    ""name"": ""HOFF
Query:
-- Description: Retrieve distinct application numbers of patents filed by the top assignee with the most records in the 'A61' category.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
)
SELECT DISTINCT t."application_number"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
LIMIT 20;
Answer:
application_number
US-438653D-A
JP-2013529470-A
JP-2013546219-A
JP-2020568129-A
BE-160541-A
JP-2002572997-A
JP-2015535027-A
US-202118268251-A
KR-20020033768-A
JP-2019552771-A
BE-486193D-A
SK-38595-A
JP-2023533533-A
US-49398404-A
BE-345960D-A
BE-632555D-A
US-207103D-A
JP-2017254941-A
JP-2012534058-A
JP-10395673-A
Query:
-- Description: Retrieve the year and the number of applications filed by the top assignee in the 'A61' category to analyze yearly trends.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
)
SELECT YEAR(DATE_FROM_PARTS((t."filing_date" / 10000)::INT, ((t."filing_date" % 10000) / 100)::INT, (t."filing_date" % 100)::INT)) AS "year", COUNT(*) AS "applications"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
GROUP BY "year"
ORDER BY "applications" DESC
LIMIT 20;
Answer:
year,applications
2016,3648
2017,3540
2018,3284
2015,3199
2019,2798
2014,2668
2013,2638
2002,2265
2021,2258
2011,2158
2020,2133
2012,2020
2004,1934
2003,1895
2009,1894
2010,1747
2006,1562
2001,1537
2022,1420
2005,1320
Query:
-- Description: Retrieve family IDs of patents filed under the 'A61' category by the top assignee with the most filings.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
)
SELECT DISTINCT t."family_id"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
LIMIT 20;
Answer:
family_id
40341833
27758881
51220489
27732449
50483406
56014607
8854904
40688848
32045865
56355774
59361448
24353148
42697268
70463639
14730225
24998889
56692619
56564049
60117814
6522064
Query:
-- Description: Retrieve publication details for patents under the 'A61' category filed in the year with the most applications associated with the top assignee.
WITH TopAssignee AS (
    SELECT t."assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY t."assignee_harmonized"
    ORDER BY "application_count" DESC
    LIMIT 1
),
TopYear AS (
    SELECT YEAR(DATE_FROM_PARTS((t."filing_date" / 10000)::INT, ((t."filing_date" % 10000) / 100)::INT, (t."filing_date" % 100)::INT)) AS "year"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
      AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
    GROUP BY "year"
    ORDER BY COUNT(*) DESC
    LIMIT 1
)
SELECT t."publication_number", t."application_number", t."country_code", t."publication_date", t."title_localized"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
  AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
  AND YEAR(DATE_FROM_PARTS((t."filing_date" / 10000)::INT, ((t."filing_date" % 10000) / 100)::INT, (t."filing_date" % 100)::INT)) = (SELECT "year" FROM TopYear)
LIMIT 20;
Answer:
publication_number,application_number,country_code,publication_date,title_localized
JP-WO2016178380-A1,JP-2017516591-A,JP,20171130,"[
  {
    ""language"": ""ja"",
    ""text"": ""化粧料組成物"",
    ""truncated"": false
  }
]"
JP-WO2016178380-A1,JP-2017516591-A,JP,20171130,"[
  {
    ""language"": ""ja"",
    ""text"": ""化粧料組成物"",
    ""truncated"": false
  }
]"
JP-WO2016178380-A1,JP-2017516591-A,JP,20171130,"[
  {
    ""language"": ""ja"",
    ""text"": ""化粧料組成物"",
    ""truncated"": false
  }
]"
Task: In which year did the assignee with the most applications in the patent category 'A61' file the most?
Another way to say it: In which year did the assignee with the most applications in the patent category 'A61' file the most?

Please think step by step and answer only one complete SQL in snowflake dialect in ```sql``` format.
SQL usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'PATENTS': {'PATENTS': ['DISCLOSURES_13', 'PUBLICATIONS', 'CPC_DEFINITION']}}

When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When asked something without stating name or id, return both of them. e.g. Which products ...? The answer should include product_name and product_id.
When asked percentage decrease, you should return a positive value. e.g. How many percentage points in 2021 decrease compared to ...? The answer should be a positive value indicating the decresed number. Try to use ABS().
If asked two tables, you should reply with the last one instead of combining two tables. e.g. Identifying the top five states ... examine the state that ranks fourth overall and identify its top five counties. You should only answer top five counties.
Use ST_DISTANCE to calculate distance between two geographic points for more accurate answer.
If the task description does not specify the number of decimal places, retain all decimals to four places.

[Self-refine]
2025-07-01 04:14:38 - Thread-1 (execute) - INFO - [Try to run SQL in self-refine]
```sql
WITH TopAssignee AS (
    SELECT "assignee_harmonized", COUNT(*) AS "application_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
    GROUP BY "assignee_harmonized"
    ORDER BY "application_count" DESC NULLS LAST
    LIMIT 1
),
YearlyApplicationCounts AS (
    SELECT 
        YEAR(DATE_FROM_PARTS((t."filing_date" / 10000)::INT, ((t."filing_date" % 10000) / 100)::INT, (t."filing_date" % 100)::INT)) AS "year", 
        COUNT(*) AS "applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
    WHERE f.value::VARIANT:"code"::STRING ILIKE 'A61%'
      AND t."assignee_harmonized" = (SELECT "assignee_harmonized" FROM TopAssignee)
    GROUP BY "year"
    ORDER BY "applications" DESC NULLS LAST
    LIMIT 1
)
SELECT * 
FROM YearlyApplicationCounts;
```
[Try to run SQL in self-refine]
2025-07-01 04:15:28 - Thread-1 (execute) - INFO - Total iteration counts: 0
