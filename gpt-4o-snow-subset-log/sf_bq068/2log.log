2025-07-01 04:26:15 - Thread-315 (execute) - INFO - [Exploration]
```sql
-- Description: List unique address types in CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS to understand the different types of addresses that need to be grouped.
SELECT DISTINCT "type" 
FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS 
LIMIT 20;
```

```sql
-- Description: List unique address types in CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS to ensure consistency in address types across both INPUTS and OUTPUTS.
SELECT DISTINCT "type" 
FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS 
LIMIT 20;
```

```sql
-- Description: Retrieve a sample of addresses and their values from CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS for March 2014 to analyze credits (positive balances).
SELECT o."addresses", o."value", o."block_timestamp", o."type"
FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
LIMIT 20;
```

```sql
-- Description: Retrieve a sample of addresses and their values from CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS for March 2014 to analyze debits (negative balances).
SELECT i."addresses", i."value", i."block_timestamp", i."type" 
FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
LIMIT 20;
```

```sql
-- Description: Aggregate total output (credits) by address and type from CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS for March 2014.
SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o 
WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
GROUP BY o."type", o."addresses"
LIMIT 20;
```

```sql
-- Description: Aggregate total input (debits) by address and type from CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS for March 2014.
SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
GROUP BY i."type", i."addresses"
LIMIT 20;
```

```sql
-- Description: Combine credits (OUTPUTS) and debits (INPUTS) to calculate final balances by address and type for March 2014.
WITH outputs AS (
  SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
  WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY o."type", o."addresses"
), inputs AS (
  SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
  WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY i."type", i."addresses"
)
SELECT o."type", o."addresses", COALESCE(o."total_credit", 0) - COALESCE(i."total_debit", 0) AS "final_balance"
FROM outputs o
LEFT JOIN inputs i ON o."addresses" = i."addresses" AND o."type" = i."type"
LIMIT 20;
```

```sql
-- Description: Find the maximum and minimum final balances across all addresses for each address type during March 2014.
WITH outputs AS (
  SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
  WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY o."type", o."addresses"
), inputs AS (
  SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
  WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY i."type", i."addresses"
), balances AS (
  SELECT o."type", o."addresses", COALESCE(o."total_credit", 0) - COALESCE(i."total_debit", 0) AS "final_balance"
  FROM outputs o
  LEFT JOIN inputs i ON o."addresses" = i."addresses" AND o."type" = i."type"
)
SELECT b."type", MAX(b."final_balance") AS "max_balance", MIN(b."final_balance") AS "min_balance"
FROM balances b
GROUP BY b."type"
LIMIT 20;
```

```sql
-- Description: Display all zero balances for a sanity check on addresses that may have no transactions during March 2014.
WITH outputs AS (
  SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
  WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY o."type", o."addresses"
), inputs AS (
  SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
  WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY i."type", i."addresses"
), balances AS (
  SELECT o."type", o."addresses", COALESCE(o."total_credit", 0) - COALESCE(i."total_debit", 0) AS "final_balance"
  FROM outputs o
  LEFT JOIN inputs i ON o."addresses" = i."addresses" AND o."type" = i."type"
)
SELECT b."type", b."addresses", b."final_balance"
FROM balances b
WHERE b."final_balance" = 0
LIMIT 20;
```
[Exploration]
2025-07-01 04:26:15 - Thread-315 (execute) - INFO - [Try to execute]
-- Description: List unique address types in CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS to understand the different types of addresses that need to be grouped.
SELECT DISTINCT "type" 
FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS 
LIMIT 20;
[Try to execute]
2025-07-01 04:26:16 - Thread-315 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: List unique address types in CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS to understand the different types of addresses that need to be grouped.
SELECT DISTINCT "type" 
FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS 
LIMIT 20;
Results:
type
pubkey
nonstandard
pubkeyhash
scripthash
multisig

[Successfully executed]
2025-07-01 04:26:16 - Thread-315 (execute) - INFO - [Try to execute]
-- Description: List unique address types in CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS to ensure consistency in address types across both INPUTS and OUTPUTS.
SELECT DISTINCT "type" 
FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS 
LIMIT 20;
[Try to execute]
2025-07-01 04:26:16 - Thread-315 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: List unique address types in CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS to ensure consistency in address types across both INPUTS and OUTPUTS.
SELECT DISTINCT "type" 
FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS 
LIMIT 20;
Results:
type
scripthash
multisig
pubkey
nonstandard
pubkeyhash

[Successfully executed]
2025-07-01 04:26:16 - Thread-315 (execute) - INFO - [Try to execute]
-- Description: Retrieve a sample of addresses and their values from CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS for March 2014 to analyze credits (positive balances).
SELECT o."addresses", o."value", o."block_timestamp", o."type"
FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
LIMIT 20;
[Try to execute]
2025-07-01 04:26:17 - Thread-315 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Retrieve a sample of addresses and their values from CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS for March 2014 to analyze credits (positive balances).
SELECT o."addresses", o."value", o."block_timestamp", o."type"
FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
LIMIT 20;
Results:
addresses,value,block_timestamp,type
"[
  ""bitcoincash:qr96r4uh8y4eldx3ggkd79f34h8n468q8vgp3mm4pd""
]",52230000.000000000,1396034046000000,pubkeyhash
"[
  ""bitcoincash:qpm9zl22svcy3kc68z8pes2n06pruxwhau4eft3n6a""
]",100000000.000000000,1394850267000000,pubkeyhash
"[
  ""bitcoincash:qzny7utejvw86269h4c5z3v0cg33skyj9q8saqupn0""
]",1708413.000000000,1394591450000000,pubkeyhash
"[
  ""bitcoincash:qrsgmesjgcmle9z94ku5ej8psjta0aqhuu98y40k8r""
]",233029.000000000,1395483085000000,pubkeyhash

[Successfully executed]
2025-07-01 04:26:17 - Thread-315 (execute) - INFO - [Try to execute]
-- Description: Retrieve a sample of addresses and their values from CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS for March 2014 to analyze debits (negative balances).
SELECT i."addresses", i."value", i."block_timestamp", i."type" 
FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
LIMIT 20;
[Try to execute]
2025-07-01 04:29:18 - Thread-315 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Retrieve a sample of addresses and their values from CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS for March 2014 to analyze debits (negative balances).
SELECT i."addresses", i."value", i."block_timestamp", i."type" 
FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
LIMIT 20;
Results:
addresses,value,block_timestamp,type
"[
  ""bitcoincash:qpk8ftszfkv8dp3lfmnnxg5yvuv2grsvvuju0umj84""
]",25000000.000000000,1394416101000000,pubkeyhash
"[
  ""bitcoincash:qq76e0ug4v0dnng3cm356samn0frhaujxcuhjdcp0y""
]",4950558.000000000,1394794367000000,pubkeyhash
"[
  ""bitcoincash:qpdd9n3ja6vxrumr9ftneg2ta6mwv7fupy06fvhwkq""
]",7368576.000000000,1396179633000000,pubkeyhash
"[
  ""bitcoincash:qrxqdhdc45dyd0gmky26pcjqa63x5vzwcclmga4a7x""
]",176969.000000000,1394580900000000,pubkeyhash

[Successfully executed]
2025-07-01 04:29:18 - Thread-315 (execute) - INFO - [Try to execute]
-- Description: Aggregate total output (credits) by address and type from CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS for March 2014.
SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o 
WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
GROUP BY o."type", o."addresses"
LIMIT 20;
[Try to execute]
2025-07-01 04:30:34 - Thread-315 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Aggregate total output (credits) by address and type from CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS for March 2014.
SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o 
WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
GROUP BY o."type", o."addresses"
LIMIT 20;
Results:
type,addresses,total_credit
pubkeyhash,"[
  ""bitcoincash:qqjtjuhcnqgtzqjky043ecal7xq2tczm2s7a2avzac""
]",490000.000000000
pubkeyhash,"[
  ""bitcoincash:qrryjv052fhuaj5hal7uqv8zeunxe9fqrv4ppc9jc8""
]",11480000.000000000
pubkeyhash,"[
  ""bitcoincash:qqta0y7gjztvfrkd7czkjh2uuf6gqe7dkyk0ea5r4z""
]",16708.000000000
pubkeyhash,"[
  ""bitcoincash:qzm6ds8ljeuvq5829cd5757q97fvn8tspyz6qu3zne""
]",12700000.000000000
pubkeyhash,"[
  ""bitcoincash:qz4m6upvt2dw9h8nn229sfj5eqhfdp6h7q0pwz0tuy""
]",244000

[Successfully executed]
2025-07-01 04:30:34 - Thread-315 (execute) - INFO - [Try to execute]
-- Description: Aggregate total input (debits) by address and type from CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS for March 2014.
SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
GROUP BY i."type", i."addresses"
LIMIT 20;
[Try to execute]
2025-07-01 04:33:03 - Thread-315 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Aggregate total input (debits) by address and type from CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS for March 2014.
SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
GROUP BY i."type", i."addresses"
LIMIT 20;
Results:
type,addresses,total_debit
pubkeyhash,"[
  ""bitcoincash:qz4htqsklj5a7qaz3fk50s59gzk23pfvgqtk55f4fs""
]",5999970000.000000000
pubkeyhash,"[
  ""bitcoincash:qznnjl4w5aydglau44c50jw2ydqd8g3awv2ja3zu37""
]",1057664.000000000
pubkeyhash,"[
  ""bitcoincash:qrcd6d5vch8r0qcpj3mfz4y0hxev3g9kjqdfn2mkfx""
]",92856089.000000000
pubkeyhash,"[
  ""bitcoincash:qrv6m2y9u5rmm40pucvqqj3yztgjjp3l0g9caqnv9w""
]",1004560.000000000
pubkeyhash,"[
  ""bitcoincash:qrqrv446c4d0lcp3lzfk2gws4gqyq0f4cs70d2rv9t""
]",10

[Successfully executed]
2025-07-01 04:33:03 - Thread-315 (execute) - INFO - [Try to execute]
-- Description: Combine credits (OUTPUTS) and debits (INPUTS) to calculate final balances by address and type for March 2014.
WITH outputs AS (
  SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
  WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY o."type", o."addresses"
), inputs AS (
  SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
  WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY i."type", i."addresses"
)
SELECT o."type", o."addresses", COALESCE(o."total_credit", 0) - COALESCE(i."total_debit", 0) AS "final_balance"
FROM outputs o
LEFT JOIN inputs i ON o."addresses" = i."addresses" AND o."type" = i."type"
LIMIT 20;
[Try to execute]
2025-07-01 04:34:28 - Thread-315 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Combine credits (OUTPUTS) and debits (INPUTS) to calculate final balances by address and type for March 2014.
WITH outputs AS (
  SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
  WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY o."type", o."addresses"
), inputs AS (
  SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
  WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY i."type", i."addresses"
)
SELECT o."type", o."addresses", COALESCE(o."total_credit", 0) - COALESCE(i."total_debit", 0) AS "final_balance"
FROM outputs o
LEFT JOIN inputs i ON o."addresses" = i."addresses" AND o."type" = i."type"
LIMIT 20;
Results:
type,addresses,final_balance
pubkeyhash,"[
  ""bitcoincash:qpnvtyh3vgmnhzqnh8metw55a466fgr0lvmw6d5dp0""
]",6876020.000000000
pubkeyhash,"[
  ""bitcoincash:qr3ff63fsutu0hdgjzwmrdusdeqzmzr0nyz33t0kv8""
]",18520319.000000000
pubkeyhash,"[
  ""bitcoincash:qpx0h7wclqjxhqdgxtazkhx0kfy709c9cutkzqnauz""
]",0E-9
pubkeyhash,"[
  ""bitcoincash:qp0pqushwg9spyg3srqkhtsq08lv4m4mh5dsgam64t""
]",10401566.000000000
pubkeyhash,"[
  ""bitcoincash:qqrf2vkcmuvuntm3kplg8l5us5t38r2szu5y6uucdh""
]",-229900.0000000

[Successfully executed]
2025-07-01 04:34:28 - Thread-315 (execute) - INFO - [Try to execute]
-- Description: Find the maximum and minimum final balances across all addresses for each address type during March 2014.
WITH outputs AS (
  SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
  WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY o."type", o."addresses"
), inputs AS (
  SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
  WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY i."type", i."addresses"
), balances AS (
  SELECT o."type", o."addresses", COALESCE(o."total_credit", 0) - COALESCE(i."total_debit", 0) AS "final_balance"
  FROM outputs o
  LEFT JOIN inputs i ON o."addresses" = i."addresses" AND o."type" = i."type"
)
SELECT b."type", MAX(b."final_balance") AS "max_balance", MIN(b."final_balance") AS "min_balance"
FROM balances b
GROUP BY b."type"
LIMIT 20;
[Try to execute]
2025-07-01 04:36:02 - Thread-315 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Find the maximum and minimum final balances across all addresses for each address type during March 2014.
WITH outputs AS (
  SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
  WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY o."type", o."addresses"
), inputs AS (
  SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
  WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY i."type", i."addresses"
), balances AS (
  SELECT o."type", o."addresses", COALESCE(o."total_credit", 0) - COALESCE(i."total_debit", 0) AS "final_balance"
  FROM outputs o
  LEFT JOIN inputs i ON o."addresses" = i."addresses" AND o."type" = i."type"
)
SELECT b."type", MAX(b."final_balance") AS "max_balance", MIN(b."final_balance") AS "min_balance"
FROM balances b
GROUP BY b."type"
LIMIT 20;
Results:
type,max_balance,min_balance
scripthash,50495618.000000000,190000.000000000
multisig,10920.000000000,10017.000000000
pubkeyhash,192112095138.000000000,-3500000000.000000000

[Successfully executed]
2025-07-01 04:36:03 - Thread-315 (execute) - INFO - [Try to execute]
-- Description: Display all zero balances for a sanity check on addresses that may have no transactions during March 2014.
WITH outputs AS (
  SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
  WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY o."type", o."addresses"
), inputs AS (
  SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
  WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY i."type", i."addresses"
), balances AS (
  SELECT o."type", o."addresses", COALESCE(o."total_credit", 0) - COALESCE(i."total_debit", 0) AS "final_balance"
  FROM outputs o
  LEFT JOIN inputs i ON o."addresses" = i."addresses" AND o."type" = i."type"
)
SELECT b."type", b."addresses", b."final_balance"
FROM balances b
WHERE b."final_balance" = 0
LIMIT 20;
[Try to execute]
2025-07-01 04:36:18 - Thread-315 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Display all zero balances for a sanity check on addresses that may have no transactions during March 2014.
WITH outputs AS (
  SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
  WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY o."type", o."addresses"
), inputs AS (
  SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
  WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY i."type", i."addresses"
), balances AS (
  SELECT o."type", o."addresses", COALESCE(o."total_credit", 0) - COALESCE(i."total_debit", 0) AS "final_balance"
  FROM outputs o
  LEFT JOIN inputs i ON o."addresses" = i."addresses" AND o."type" = i."type"
)
SELECT b."type", b."addresses", b."final_balance"
FROM balances b
WHERE b."final_balance" = 0
LIMIT 20;
Results:
type,addresses,final_balance
pubkeyhash,"[
  ""bitcoincash:qp0h05ftdsnpkvmkkd9p828f25nwry5f4stx4xq609""
]",0E-9
pubkeyhash,"[
  ""bitcoincash:qpsh49lwrarxx3hfz2xxv9mrfvtvwd23fg0s5c3z9r""
]",0E-9
pubkeyhash,"[
  ""bitcoincash:qrjlm8hry48d6pu635qq76hswapkr9k4aqzf4dheu7""
]",0E-9
pubkeyhash,"[
  ""bitcoincash:qruhth6737qf0l7waud6a4g9pr4p6v8wjg6st552rz""
]",0E-9
pubkeyhash,"[
  ""bitcoincash:qzpg384kltx5zfhc9dy7dpqmql6tac2tqccctyuq2g""
]",0E-9
pubkeyhash,"[
  ""bitcoincash:qqr0rdn0tf53luckjupd

[Successfully executed]
2025-07-01 04:36:18 - Thread-315 (execute) - INFO - itercount: 0
2025-07-01 04:36:18 - Thread-315 (execute) - INFO - [Self-refine]
Table full name: CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS
Column name: block_timestamp Type: NUMBER
Column name: block_number Type: NUMBER
Column name: index Type: NUMBER
Column name: type Type: TEXT
Column name: value Type: NUMBER
Column name: addresses Type: VARIANT
Column name: transaction_hash Type: TEXT
Sample rows:
[{'transaction_hash': '746dc1f7266897ac047acda6cee2ab97bb7bea7c76f330e51bd557f9a97a5000', 'block_number': 623082, 'block_timestamp': 1582183140000000, 'index': 1, 'type': 'pubkeyhash', 'addresses': '[\n  "bitcoincash:qqrxa0h9jqnc7v4wmj9ysetsp3y7w9l36u8gnnjulq"\n]', 'value': '2858.000000000'}, {'transaction_hash': '48d76f258b83d6aff8fd05073d61b353b87755cdb7f5a015cb3788920d3def23', 'block_number': 471165, 'block_timestamp': 1497401226000000, 'index': 2, 'type': 'pubkeyhash', 'addresses': '[\n  "bitcoincash:qz5unqrypp3egtllk8hnpd59908pzyaqcq2jzdt94w"\n]', 'value': '467719733.000000000'}, {'transaction_hash': '4be25dacc786858fc8fef0ce4708d5d715fe90b1f4978adbe640e0bf7adcad68', 'block_number': 676943, 'block_timestamp': 1614668599000000, 'index': 0, 'type': 'pubkeyhash', 'addresses': '[\n  "bitcoincash:qzrhtmvxt0n4s56nxgykc8yh7cvpu8f5lgkugrll2l"\n]', 'value': '8025.000000000'}, {'transaction_hash': 'dc76690f572dc2a21a21f0a36716b0bd275c8938c8598a75e40754b8beb28c3f', 'block_number': 469282, 'block_timestamp': 1496356283000000, 'index': 1, 'type': 'pubkeyhash', 'addresses': '[\n  "bitcoincash:qrj4cettzsd7fed9ygntvmqg0gjrkd69y58uwllamt"\n]', 'value': '4149800.000000000'}, {'transaction_hash': '99bf4b790b9c198ff9c4f793bd332959047865cca57379f989f0ac2948d4b3f6', 'block_number': 465437, 'block_timestamp': 1494247825000000, 'index': 1, 'type': 'pubkeyhash', 'addresses': '[\n  "bitcoincash:qzeqyndkua2vhltg7tsxqzfch3fav702zgxdf69x7a"\n]', 'value': '904900.000000000'}]
--------------------------------------------------
Table full name: CRYPTO.CRYPTO_BITCOIN_CASH.BLOCKS
Column name: timestamp Type: NUMBER Description: Block creation timestamp specified in block header
Column name: hash Type: TEXT Description: Hash of this block
Column name: transaction_count Type: NUMBER Description: Number of transactions included in this block
Column name: number Type: NUMBER Description: The number of the block
Sample rows:
[{'hash': '0000000000000004753bd3347b58e55805fb17fb28116ca91962bd32e0fefdb9', 'number': 266149, 'timestamp': 1382772110000000, 'transaction_count': 100}, {'hash': '0000000000000000a9a4b9e17411828902e555579256fa34e87a406496ec36ba', 'number': 263467, 'timestamp': 1381711472000000, 'transaction_count': 108}, {'hash': '000000000000000cb4fe468e60bf9f1dd14fcd16c17e9ae2e89fa669c6d30f32', 'number': 263453, 'timestamp': 1381707719000000, 'transaction_count': 118}, {'hash': '000000000000000a4b97c0c77d5144230012829dc6121a4a886d5840fc369ab8', 'number': 262389, 'timestamp': 1381235248000000, 'transaction_count': 232}, {'hash': '00000000000000079e66a8b7ccda1d0534a8eb27db601f45d2f052463fc836ad', 'number': 261763, 'timestamp': 1380938295000000, 'transaction_count': 321}]
--------------------------------------------------
Table full name: CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS
Column name: value Type: NUMBER
Column name: block_number Type: NUMBER
Column name: type Type: TEXT
Column name: addresses Type: VARIANT
Column name: transaction_hash Type: TEXT
Column name: block_timestamp Type: NUMBER
Column name: spent_transaction_hash Type: TEXT
Column name: spent_output_index Type: NUMBER
Column name: index Type: NUMBER
Sample rows:
[{'transaction_hash': '7b4edf428b218b71143f0c3cf1479a2481785e80db76d18d166fd2b117cf6a8f', 'block_number': 784607, 'block_timestamp': 1679241843000000, 'index': 0, 'spent_transaction_hash': '5939eab7fd0e0629dd4c6388a2d10cd2d697ee7a3bc82aa04c3d1d128e5861cd', 'spent_output_index': 0, 'type': 'scripthash', 'addresses': '[\n  "bitcoincash:pzh922lrxs2mzwe50dx6nt623hcnqqugdsx6v2esml"\n]', 'value': '1957308.000000000'}, {'transaction_hash': 'dee0cd3d4b11fa89d5d4a05ab1095db6727736ae1dd554f78eb28399104c9748', 'block_number': 371617, 'block_timestamp': 1440602603000000, 'index': 0, 'spent_transaction_hash': 'd0e069c1767cc4956428ff66eaeca35c810f8e9b73dc6990fa4d9df70b00c4c2', 'spent_output_index': 0, 'type': 'pubkeyhash', 'addresses': '[\n  "bitcoincash:qz6c6cga9j0hfx0r3fdsj0mdq55yklrn6v8k34kyl4"\n]', 'value': '13689300.000000000'}, {'transaction_hash': 'cb161add9ddce08aff3888568bca5f38203159c980adf46ebe3fa86d8e856e05', 'block_number': 546256, 'block_timestamp': 1535974586000000, 'index': 0, 'spent_transaction_hash': 'ce074f26621c105c0a0ee136b523f9f921c0fe5e86b8bec619af847ad0856087', 'spent_output_index': 1879, 'type': 'pubkeyhash', 'addresses': '[\n  "bitcoincash:qr4kjpuwzdxhcshkrgc6saqg9jj40dn2ssv7u6cv7n"\n]', 'value': '1399226.000000000'}, {'transaction_hash': 'f7d695c956fe52d869a06dd1ebc91ae6374c0d32003fef2b67b28fdeab142138', 'block_number': 546425, 'block_timestamp': 1536081903000000, 'index': 0, 'spent_transaction_hash': '544b33a7584a4aabc8c9254a489e779e5ffa1760f6b43efab707a45ab95ccfc0', 'spent_output_index': 0, 'type': 'pubkeyhash', 'addresses': '[\n  "bitcoincash:qr8jg0cvr0nzhtj6edxcd8uh2ses0jdlaqrpscdjat"\n]', 'value': '2856.000000000'}, {'transaction_hash': '28a3ab9adb65c37adf3c9b325915300880b386ec412e93cb2c56a02ea17a9714', 'block_number': 546015, 'block_timestamp': 1535829579000000, 'index': 0, 'spent_transaction_hash': '980a701e39d8085a1d229cc3e648f846188738632f3e6bd8fbc11eb0bcbf7d65', 'spent_output_index': 0, 'type': 'pubkeyhash', 'addresses': '[\n  "bitcoincash:qqgd5lxg8azugud4c32w8dty7q35nzwsag9aj7g50n"\n]', 'value': '6006.000000000'}]
--------------------------------------------------
Table full name: CRYPTO.CRYPTO_BITCOIN_CASH.TRANSACTIONS
Column name: block_number Type: NUMBER Description: Number of the block which contains this transaction
Column name: output_count Type: NUMBER Description: The number of outputs in the transaction
Column name: is_coinbase Type: BOOLEAN Description: true if this transaction is a coinbase transaction
Column name: block_timestamp Type: NUMBER Description: Timestamp of the block which contains this transaction
Column name: input_count Type: NUMBER Description: The number of inputs in the transaction
Column name: block_timestamp_month Type: DATE Description: Month of the block which contains this transaction
Column name: output_value Type: NUMBER Description: Total value of outputs in the transaction
Column name: hash Type: TEXT Description: The hash of this transaction
Column name: input_value Type: NUMBER Description: Total value of inputs in the transaction
Column name: lock_time Type: NUMBER Description: Earliest time that miners can include the transaction in their hashing of the Merkle root to attach it in the latest block of the blockchain
Sample rows:
[{'hash': '9550ead74f556be17c85fdb7e3cc145c823ed7f0b8e828de74dee0118c92aa91', 'block_number': 292659, 'block_timestamp': 1395888795000000, 'block_timestamp_month': '2014-03-01', 'input_count': 233, 'output_count': 2, 'input_value': '1082460011.000000000', 'output_value': '1082100011.000000000', 'is_coinbase': False}, {'hash': '7496715db2fe51ca3e66a10725c4aa8edd8f0bfd87fb33cf1e1f762bfd298849', 'block_number': 290204, 'block_timestamp': 1394630782000000, 'block_timestamp_month': '2014-03-01', 'input_count': 233, 'output_count': 1, 'input_value': '1554778291.000000000', 'output_value': '1554348291.000000000', 'is_coinbase': False}, {'hash': '04f13869c6768ec60104c7de98b361529f69a2cddda7df5bd22c33b671df7873', 'block_number': 471038, 'block_timestamp': 1497322790000000, 'block_timestamp_month': '2017-06-01', 'input_count': 241, 'output_count': 2, 'input_value': '307453572.000000000', 'output_value': '300411610.000000000', 'is_coinbase': False}, {'hash': 'ba6be87459d4b6b4cebe9c10cd0a8eea1a0bad3940d9997bf7dfc1aded3222dd', 'block_number': 290712, 'block_timestamp': 1394901707000000, 'block_timestamp_month': '2014-03-01', 'input_count': 243, 'output_count': 1, 'input_value': '1160000.000000000', 'output_value': '800000.000000000', 'is_coinbase': False}, {'hash': 'b074c19420b84b1cd2e07c15c75fa5d6c605716fb7141c388ad4e62764e49316', 'block_number': 331241, 'block_timestamp': 1416724700000000, 'block_timestamp_month': '2014-11-01', 'input_count': 246, 'output_count': 1, 'input_value': '339849450.000000000', 'output_value': '339459448.000000000', 'is_coinbase': False}]
--------------------------------------------------
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'CRYPTO': {'CRYPTO_BITCOIN_CASH': ['OUTPUTS', 'BLOCKS', 'INPUTS', 'TRANSACTIONS']}}

Some few-shot examples after column exploration may be helpful:
Query:
-- Description: List unique address types in CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS to understand the different types of addresses that need to be grouped.
SELECT DISTINCT "type" 
FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS 
LIMIT 20;
Answer:
type
pubkey
nonstandard
pubkeyhash
scripthash
multisig
Query:
-- Description: List unique address types in CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS to ensure consistency in address types across both INPUTS and OUTPUTS.
SELECT DISTINCT "type" 
FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS 
LIMIT 20;
Answer:
type
scripthash
multisig
pubkey
nonstandard
pubkeyhash
Query:
-- Description: Retrieve a sample of addresses and their values from CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS for March 2014 to analyze credits (positive balances).
SELECT o."addresses", o."value", o."block_timestamp", o."type"
FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
LIMIT 20;
Answer:
addresses,value,block_timestamp,type
"[
  ""bitcoincash:qr96r4uh8y4eldx3ggkd79f34h8n468q8vgp3mm4pd""
]",52230000.000000000,1396034046000000,pubkeyhash
"[
  ""bitcoincash:qpm9zl22svcy3kc68z8pes2n06pruxwhau4eft3n6a""
]",100000000.000000000,1394850267000000,pubkeyhash
"[
  ""bitcoincash:qzny7utejvw86269h4c5z3v0cg33skyj9q8saqupn0""
]",1708413.000000000,1394591450000000,pubkeyhash
"[
  ""bitcoincash:qrsgmesjgcmle9z94ku5ej8psjta0aqhuu98y40k8r""
]",233029.000000000,1395483085000000,pubkeyhash
Query:
-- Description: Retrieve a sample of addresses and their values from CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS for March 2014 to analyze debits (negative balances).
SELECT i."addresses", i."value", i."block_timestamp", i."type" 
FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
LIMIT 20;
Answer:
addresses,value,block_timestamp,type
"[
  ""bitcoincash:qpk8ftszfkv8dp3lfmnnxg5yvuv2grsvvuju0umj84""
]",25000000.000000000,1394416101000000,pubkeyhash
"[
  ""bitcoincash:qq76e0ug4v0dnng3cm356samn0frhaujxcuhjdcp0y""
]",4950558.000000000,1394794367000000,pubkeyhash
"[
  ""bitcoincash:qpdd9n3ja6vxrumr9ftneg2ta6mwv7fupy06fvhwkq""
]",7368576.000000000,1396179633000000,pubkeyhash
"[
  ""bitcoincash:qrxqdhdc45dyd0gmky26pcjqa63x5vzwcclmga4a7x""
]",176969.000000000,1394580900000000,pubkeyhash
Query:
-- Description: Aggregate total output (credits) by address and type from CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS for March 2014.
SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o 
WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
GROUP BY o."type", o."addresses"
LIMIT 20;
Answer:
type,addresses,total_credit
pubkeyhash,"[
  ""bitcoincash:qqjtjuhcnqgtzqjky043ecal7xq2tczm2s7a2avzac""
]",490000.000000000
pubkeyhash,"[
  ""bitcoincash:qrryjv052fhuaj5hal7uqv8zeunxe9fqrv4ppc9jc8""
]",11480000.000000000
pubkeyhash,"[
  ""bitcoincash:qqta0y7gjztvfrkd7czkjh2uuf6gqe7dkyk0ea5r4z""
]",16708.000000000
pubkeyhash,"[
  ""bitcoincash:qzm6ds8ljeuvq5829cd5757q97fvn8tspyz6qu3zne""
]",12700000.000000000
pubkeyhash,"[
  ""bitcoincash:qz4m6upvt2dw9h8nn229sfj5eqhfdp6h7q0pwz0tuy""
]",244000
Query:
-- Description: Aggregate total input (debits) by address and type from CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS for March 2014.
SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
  AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
GROUP BY i."type", i."addresses"
LIMIT 20;
Answer:
type,addresses,total_debit
pubkeyhash,"[
  ""bitcoincash:qz4htqsklj5a7qaz3fk50s59gzk23pfvgqtk55f4fs""
]",5999970000.000000000
pubkeyhash,"[
  ""bitcoincash:qznnjl4w5aydglau44c50jw2ydqd8g3awv2ja3zu37""
]",1057664.000000000
pubkeyhash,"[
  ""bitcoincash:qrcd6d5vch8r0qcpj3mfz4y0hxev3g9kjqdfn2mkfx""
]",92856089.000000000
pubkeyhash,"[
  ""bitcoincash:qrv6m2y9u5rmm40pucvqqj3yztgjjp3l0g9caqnv9w""
]",1004560.000000000
pubkeyhash,"[
  ""bitcoincash:qrqrv446c4d0lcp3lzfk2gws4gqyq0f4cs70d2rv9t""
]",10
Query:
-- Description: Combine credits (OUTPUTS) and debits (INPUTS) to calculate final balances by address and type for March 2014.
WITH outputs AS (
  SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
  WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY o."type", o."addresses"
), inputs AS (
  SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
  WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY i."type", i."addresses"
)
SELECT o."type", o."addresses", COALESCE(o."total_credit", 0) - COALESCE(i."total_debit", 0) AS "final_balance"
FROM outputs o
LEFT JOIN inputs i ON o."addresses" = i."addresses" AND o."type" = i."type"
LIMIT 20;
Answer:
type,addresses,final_balance
pubkeyhash,"[
  ""bitcoincash:qpnvtyh3vgmnhzqnh8metw55a466fgr0lvmw6d5dp0""
]",6876020.000000000
pubkeyhash,"[
  ""bitcoincash:qr3ff63fsutu0hdgjzwmrdusdeqzmzr0nyz33t0kv8""
]",18520319.000000000
pubkeyhash,"[
  ""bitcoincash:qpx0h7wclqjxhqdgxtazkhx0kfy709c9cutkzqnauz""
]",0E-9
pubkeyhash,"[
  ""bitcoincash:qp0pqushwg9spyg3srqkhtsq08lv4m4mh5dsgam64t""
]",10401566.000000000
pubkeyhash,"[
  ""bitcoincash:qqrf2vkcmuvuntm3kplg8l5us5t38r2szu5y6uucdh""
]",-229900.0000000
Query:
-- Description: Find the maximum and minimum final balances across all addresses for each address type during March 2014.
WITH outputs AS (
  SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
  WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY o."type", o."addresses"
), inputs AS (
  SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
  WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY i."type", i."addresses"
), balances AS (
  SELECT o."type", o."addresses", COALESCE(o."total_credit", 0) - COALESCE(i."total_debit", 0) AS "final_balance"
  FROM outputs o
  LEFT JOIN inputs i ON o."addresses" = i."addresses" AND o."type" = i."type"
)
SELECT b."type", MAX(b."final_balance") AS "max_balance", MIN(b."final_balance") AS "min_balance"
FROM balances b
GROUP BY b."type"
LIMIT 20;
Answer:
type,max_balance,min_balance
scripthash,50495618.000000000,190000.000000000
multisig,10920.000000000,10017.000000000
pubkeyhash,192112095138.000000000,-3500000000.000000000
Query:
-- Description: Display all zero balances for a sanity check on addresses that may have no transactions during March 2014.
WITH outputs AS (
  SELECT o."type", o."addresses", SUM(o."value") AS "total_credit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
  WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY o."type", o."addresses"
), inputs AS (
  SELECT i."type", i."addresses", SUM(i."value") AS "total_debit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
  WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY i."type", i."addresses"
), balances AS (
  SELECT o."type", o."addresses", COALESCE(o."total_credit", 0) - COALESCE(i."total_debit", 0) AS "final_balance"
  FROM outputs o
  LEFT JOIN inputs i ON o."addresses" = i."addresses" AND o."type" = i."type"
)
SELECT b."type", b."addresses", b."final_balance"
FROM balances b
WHERE b."final_balance" = 0
LIMIT 20;
Answer:
type,addresses,final_balance
pubkeyhash,"[
  ""bitcoincash:qp0h05ftdsnpkvmkkd9p828f25nwry5f4stx4xq609""
]",0E-9
pubkeyhash,"[
  ""bitcoincash:qpsh49lwrarxx3hfz2xxv9mrfvtvwd23fg0s5c3z9r""
]",0E-9
pubkeyhash,"[
  ""bitcoincash:qrjlm8hry48d6pu635qq76hswapkr9k4aqzf4dheu7""
]",0E-9
pubkeyhash,"[
  ""bitcoincash:qruhth6737qf0l7waud6a4g9pr4p6v8wjg6st552rz""
]",0E-9
pubkeyhash,"[
  ""bitcoincash:qzpg384kltx5zfhc9dy7dpqmql6tac2tqccctyuq2g""
]",0E-9
pubkeyhash,"[
  ""bitcoincash:qqr0rdn0tf53luckjupd
Task: Using double-entry bookkeeping principles by treating transaction inputs as debits (negative values) and outputs as credits (positive values) for all Bitcoin Cash transactions between 2014-03-01 and 2014-04-01, how can we calculate the maximum and minimum final balances grouped by address type from these transactions?
Another way to say it: What are the maximum and minimum balances across all addresses for different address types on Bitcoin Cash during March 2014?

Please think step by step and answer only one complete SQL in snowflake dialect in ```sql``` format.
SQL usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'CRYPTO': {'CRYPTO_BITCOIN_CASH': ['OUTPUTS', 'BLOCKS', 'INPUTS', 'TRANSACTIONS']}}

When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When asked something without stating name or id, return both of them. e.g. Which products ...? The answer should include product_name and product_id.
When asked percentage decrease, you should return a positive value. e.g. How many percentage points in 2021 decrease compared to ...? The answer should be a positive value indicating the decresed number. Try to use ABS().
If asked two tables, you should reply with the last one instead of combining two tables. e.g. Identifying the top five states ... examine the state that ranks fourth overall and identify its top five counties. You should only answer top five counties.
Use ST_DISTANCE to calculate distance between two geographic points for more accurate answer.
If the task description does not specify the number of decimal places, retain all decimals to four places.

[Self-refine]
2025-07-01 04:36:27 - Thread-315 (execute) - INFO - [Try to run SQL in self-refine]
```sql
WITH outputs AS (
  SELECT 
    o."type", 
    o."addresses", 
    SUM(o."value") AS "total_credit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.OUTPUTS o
  WHERE o."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND o."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY o."type", o."addresses"
),
inputs AS (
  SELECT 
    i."type", 
    i."addresses", 
    SUM(i."value") AS "total_debit"
  FROM CRYPTO.CRYPTO_BITCOIN_CASH.INPUTS i
  WHERE i."block_timestamp" >= 1393632000000000 -- Start of March 2014 in microseconds
    AND i."block_timestamp" < 1396310400000000 -- Start of April 2014 in microseconds
  GROUP BY i."type", i."addresses"
),
balances AS (
  SELECT 
    o."type", 
    o."addresses", 
    COALESCE(o."total_credit", 0) - COALESCE(i."total_debit", 0) AS "final_balance"
  FROM outputs o
  FULL OUTER JOIN inputs i 
    ON o."addresses" = i."addresses" 
    AND o."type" = i."type"
)
SELECT 
  b."type", 
  MAX(b."final_balance") AS "max_balance", 
  MIN(b."final_balance") AS "min_balance"
FROM balances b
GROUP BY b."type"
ORDER BY b."type";
```
[Try to run SQL in self-refine]
2025-07-01 04:36:33 - Thread-315 (execute) - INFO - Total iteration counts: 0
