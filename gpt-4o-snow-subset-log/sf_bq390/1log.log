2025-07-01 04:40:28 - Thread-458 (execute) - INFO - [Exploration]
```sql
-- Description: Query distinct StudyInstanceUIDs for the "qin_prostate_repeatability" collection.
SELECT DISTINCT "StudyInstanceUID", "collection_id"
FROM IDC.IDC_V17.DICOM_ALL
WHERE "collection_id" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
```

```sql
-- Description: Check if T2-weighted axial MR imaging is present by filtering SeriesDescription with a fuzzy match that includes "T2-weighted" and "axial".
SELECT DISTINCT "StudyInstanceUID", "SeriesDescription", "Modality"
FROM IDC.IDC_V17.DICOM_ALL
WHERE "SeriesDescription" ILIKE '%t2%weighted%' AND "SeriesDescription" ILIKE '%axial%'
  AND "collection_id" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
```

```sql
-- Description: Query distinct AnatomicRegion and its details for segmentation analysis and confirmation of "Peripheral zone."
SELECT DISTINCT t."StudyInstanceUID", t."SOPInstanceUID", 
                f.value::VARIANT:"CodeMeaning"::STRING AS "AnatomicRegionMeaning"
FROM IDC.IDC_V17.SEGMENTATIONS t, LATERAL FLATTEN(input => t."AnatomicRegion") f
WHERE f.value::VARIANT:"CodeMeaning"::STRING ILIKE '%Peripheral zone%'
LIMIT 20;
```

```sql
-- Description: Narrow down to segmentation records linked to "qin_prostate_repeatability" collection.
SELECT DISTINCT "StudyInstanceUID", "segmented_SeriesInstanceUID", "SegmentedPropertyType"
FROM IDC.IDC_V17.SEGMENTATIONS
WHERE "segmented_SeriesInstanceUID" IS NOT NULL
  AND "PatientID" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
```

```sql
-- Description: Join DICOM_ALL and SEGMENTATIONS to find studies that match T2-weighted axial MR imaging and segmentation on "Peripheral zone."
SELECT DISTINCT da."StudyInstanceUID"
FROM IDC.IDC_V17.DICOM_ALL da
JOIN IDC.IDC_V17.SEGMENTATIONS se
ON da."SeriesInstanceUID" = se."SeriesInstanceUID"
WHERE da."SeriesDescription" ILIKE '%t2%weighted%' AND da."SeriesDescription" ILIKE '%axial%'
  AND se."SegmentedPropertyType" ILIKE '%peripheral zone%'
  AND da."collection_id" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
```

```sql
-- Description: Explore specific segmentation metadata to ensure matching with "Peripheral zone."
SELECT DISTINCT "StudyInstanceUID", f.value::VARIANT:"CodeMeaning"::STRING AS "PropertyTypeMeaning"
FROM IDC.IDC_V17.SEGMENTATIONS, LATERAL FLATTEN (input => "SegmentedPropertyType") f
WHERE f.value::VARIANT:"CodeMeaning"::STRING ILIKE '%Peripheral zone%'
LIMIT 20;
```

```sql
-- Description: Check SEGMENTATIONS table to confirm linkage with T2-weighted axial MR Studies via SeriesInstanceUID.
SELECT DISTINCT se."StudyInstanceUID", se."FrameOfReferenceUID", se."SeriesInstanceUID", da."SeriesDescription"
FROM IDC.IDC_V17.SEGMENTATIONS se
JOIN IDC.IDC_V17.DICOM_ALL da
ON da."SeriesInstanceUID" = se."segmented_SeriesInstanceUID"
WHERE da."SeriesDescription" ILIKE '%t2%weighted%' AND da."SeriesDescription" ILIKE '%axial%'
  AND da."collection_id" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
```

```sql
-- Description: Use DICOM_METADATA_CURATED_SERIES_LEVEL for modality analysis and ensure "MR" modality in study series linked to segmentation.
SELECT DISTINCT "SeriesInstanceUID", "Modality"
FROM IDC.IDC_V17.DICOM_METADATA_CURATED_SERIES_LEVEL
WHERE "Modality" = 'MR'
  AND "SeriesInstanceUID" IN
    (SELECT DISTINCT "SeriesInstanceUID" 
     FROM IDC.IDC_V17.SEGMENTATIONS
     WHERE "SegmentedPropertyType" ILIKE '%peripheral zone%')
LIMIT 20;
```

```sql
-- Description: Query studies containing both T2-weighted MR imaging and "Peripheral zone" segmentation by joining SEGMENTATIONS and DICOM_METADATA.
SELECT DISTINCT dm."StudyInstanceUID"
FROM IDC.IDC_V17.DICOM_METADATA dm
JOIN IDC.IDC_V17.SEGMENTATIONS sg
ON dm."SeriesInstanceUID" = sg."SeriesInstanceUID"
WHERE dm."SeriesDescription" ILIKE '%t2%weighted%' AND dm."SeriesDescription" ILIKE '%axial%'
  AND sg."SegmentedPropertyType" ILIKE '%Peripheral zone%'
LIMIT 20;
```

```sql
-- Description: Leverage AUXILIARY_METADATA to cross-reference SeriesInstanceUIDs back to StudyInstanceUIDs in qin_prostate_repeatability.
SELECT DISTINCT am."StudyInstanceUID", am."SeriesInstanceUID"
FROM IDC.IDC_V17.AUXILIARY_METADATA am
WHERE am."StudyInstanceUID" IN
    (SELECT DISTINCT da."StudyInstanceUID"
     FROM IDC.IDC_V17.DICOM_ALL da
     JOIN IDC.IDC_V17.SEGMENTATIONS sg
     ON da."SeriesInstanceUID" = sg."SeriesInstanceUID"
     WHERE da."SeriesDescription" ILIKE '%t2%weighted%' AND da."SeriesDescription" ILIKE '%axial%'
       AND sg."SegmentedPropertyType" ILIKE '%peripheral zone%')
LIMIT 20;
```
[Exploration]
2025-07-01 04:40:28 - Thread-458 (execute) - INFO - [Try to execute]
-- Description: Query distinct StudyInstanceUIDs for the "qin_prostate_repeatability" collection.
SELECT DISTINCT "StudyInstanceUID", "collection_id"
FROM IDC.IDC_V17.DICOM_ALL
WHERE "collection_id" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
[Try to execute]
2025-07-01 04:40:30 - Thread-458 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Query distinct StudyInstanceUIDs for the "qin_prostate_repeatability" collection.
SELECT DISTINCT "StudyInstanceUID", "collection_id"
FROM IDC.IDC_V17.DICOM_ALL
WHERE "collection_id" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
Results:
StudyInstanceUID,collection_id
1.3.6.1.4.1.14519.5.2.1.3671.4754.181478254003851548055481596513,qin_prostate_repeatability
1.3.6.1.4.1.14519.5.2.1.3671.4754.240823776621155108064488841063,qin_prostate_repeatability
1.3.6.1.4.1.14519.5.2.1.3671.4754.194890890650697728529329442454,qin_prostate_repeatability
1.3.6.1.4.1.14519.5.2.1.3671.4754.266963586071007736606548226859,qin_prostate_repeatability
1.3.6.1.4.1.14519.5.2.1.3671.4754.173585825705285812758858023242,qin_prostate_repeatability
1.3

[Successfully executed]
2025-07-01 04:40:30 - Thread-458 (execute) - INFO - [Try to execute]
-- Description: Check if T2-weighted axial MR imaging is present by filtering SeriesDescription with a fuzzy match that includes "T2-weighted" and "axial".
SELECT DISTINCT "StudyInstanceUID", "SeriesDescription", "Modality"
FROM IDC.IDC_V17.DICOM_ALL
WHERE "SeriesDescription" ILIKE '%t2%weighted%' AND "SeriesDescription" ILIKE '%axial%'
  AND "collection_id" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
[Try to execute]
2025-07-01 04:40:31 - Thread-458 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Check if T2-weighted axial MR imaging is present by filtering SeriesDescription with a fuzzy match that includes "T2-weighted" and "axial".
SELECT DISTINCT "StudyInstanceUID", "SeriesDescription", "Modality"
FROM IDC.IDC_V17.DICOM_ALL
WHERE "SeriesDescription" ILIKE '%t2%weighted%' AND "SeriesDescription" ILIKE '%axial%'
  AND "collection_id" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
Results:
StudyInstanceUID,SeriesDescription,Modality
1.3.6.1.4.1.14519.5.2.1.3671.4754.288453744990673175783381845880,T2 Weighted Axial,MR
1.3.6.1.4.1.14519.5.2.1.3671.4754.568383070573576760578239627478,T2 Weighted Axial,MR
1.3.6.1.4.1.14519.5.2.1.3671.4754.962865348146140991373362412648,T2 Weighted Axial,MR
1.3.6.1.4.1.14519.5.2.1.3671.4754.133806669697115873569905534398,T2 Weighted Axial,MR
1.3.6.1.4.1.14519.5.2.1.3671.4754.864607788085827202303582199118,T2 Weighted Axial,MR
1.3.6.1.4.1.14519.5.

[Successfully executed]
2025-07-01 04:40:31 - Thread-458 (execute) - INFO - [Try to execute]
-- Description: Query distinct AnatomicRegion and its details for segmentation analysis and confirmation of "Peripheral zone."
SELECT DISTINCT t."StudyInstanceUID", t."SOPInstanceUID", 
                f.value::VARIANT:"CodeMeaning"::STRING AS "AnatomicRegionMeaning"
FROM IDC.IDC_V17.SEGMENTATIONS t, LATERAL FLATTEN(input => t."AnatomicRegion") f
WHERE f.value::VARIANT:"CodeMeaning"::STRING ILIKE '%Peripheral zone%'
LIMIT 20;
[Try to execute]
2025-07-01 04:40:32 - Thread-458 (execute) - INFO - [Error occurred]
No data found for the specified query.

[Error occurred]
2025-07-01 04:41:04 - Thread-458 (execute) - INFO - [Corrected SQL]
To address the issue of empty results from the previous query, we need to step back and explore the data more broadly to potentially capture useful information without being overly specific. The earlier query filtered strictly for "Peripheral zone." This condition might be too restrictive due to variations in how the term is labeled. Therefore, we will simplify the query by focusing only on the `AnatomicRegion` field, extracting all distinct `CodeMeaning` values to identify all the possible anatomical regions related to the `SEGMENTATIONS` table. This will help us determine if relevant data exists and if the term "Peripheral zone" or similar terms are present in the dataset.

Here is the SQL query:

```sql
-- Description: Broaden the query to list all distinct "CodeMeaning" values in the "AnatomicRegion" column to explore segmentation data
-- and identify potential anatomical regions, without filtering specific terms such as "Peripheral zone."
SELECT DISTINCT f.value::VARIANT:"CodeMeaning"::STRING AS "AnatomicRegionMeaning"
FROM IDC.IDC_V17.SEGMENTATIONS t, LATERAL FLATTEN(input => t."AnatomicRegion") f
LIMIT 20;
```
[Corrected SQL]
2025-07-01 04:41:05 - Thread-458 (execute) - INFO - [Results for corrected sql]
AnatomicRegionMeaning
""

[Results for corrected sql]
2025-07-01 04:41:36 - Thread-458 (execute) - INFO - [Corrected other sqls]
```sql
-- Description: Narrow down to segmentation records linked to "qin_prostate_repeatability" collection by simplifying conditions. 
-- Instead of filtering by "segmented_SeriesInstanceUID" and "SegmentedPropertyType," list distinct records related to the collection.
SELECT DISTINCT "StudyInstanceUID", "segmented_SeriesInstanceUID", "SegmentedPropertyType"
FROM IDC.IDC_V17.SEGMENTATIONS
WHERE "PatientID" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
```

```sql
-- Description: Broaden the query for studies containing T2-weighted axial MR imaging by removing segmentation filtering on "Peripheral zone" 
-- and listing all related segmentation data for the "qin_prostate_repeatability" collection.
SELECT DISTINCT da."StudyInstanceUID"
FROM IDC.IDC_V17.DICOM_ALL da
JOIN IDC.IDC_V17.SEGMENTATIONS se
ON da."SeriesInstanceUID" = se."SeriesInstanceUID"
WHERE da."SeriesDescription" ILIKE '%t2%weighted%' AND da."SeriesDescription" ILIKE '%axial%'
  AND da."collection_id" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
```

```sql
-- Description: Explore segmentation metadata broadly without filtering "Peripheral zone." List distinct "CodeMeaning" values 
-- from the "SegmentedPropertyType" field to identify possible labeled types.
SELECT DISTINCT f.value::VARIANT:"CodeMeaning"::STRING AS "PropertyTypeMeaning"
FROM IDC.IDC_V17.SEGMENTATIONS, LATERAL FLATTEN (input => "SegmentedPropertyType") f
LIMIT 20;
```

```sql
-- Description: Simplify the query to check linkage between segmented studies and T2-weighted axial MR imaging by discarding specific mentions of "Peripheral zone."
SELECT DISTINCT se."StudyInstanceUID", se."FrameOfReferenceUID", se."SeriesInstanceUID", da."SeriesDescription"
FROM IDC.IDC_V17.SEGMENTATIONS se
JOIN IDC.IDC_V17.DICOM_ALL da
ON da."SeriesInstanceUID" = se."segmented_SeriesInstanceUID"
WHERE da."SeriesDescription" ILIKE '%t2%weighted%' AND da."SeriesDescription" ILIKE '%axial%'
  AND da."collection_id" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
```

```sql
-- Description: Simplify the use of modality analysis by listing all segmentation-related series in DICOM_METADATA_CURATED_SERIES_LEVEL. 
-- Remove filtering on "Peripheral zone."
SELECT DISTINCT "SeriesInstanceUID", "Modality"
FROM IDC.IDC_V17.DICOM_METADATA_CURATED_SERIES_LEVEL
WHERE "Modality" = 'MR'
LIMIT 20;
```

```sql
-- Description: Broaden query for studies containing T2-weighted axial MR imaging by removing specific segmentation filtering on "Peripheral zone."
SELECT DISTINCT dm."StudyInstanceUID"
FROM IDC.IDC_V17.DICOM_METADATA dm
JOIN IDC.IDC_V17.SEGMENTATIONS sg
ON dm."SeriesInstanceUID" = sg."SeriesInstanceUID"
WHERE dm."SeriesDescription" ILIKE '%t2%weighted%' AND dm."SeriesDescription" ILIKE '%axial%'
LIMIT 20;
```

```sql
-- Description: Simplify auxiliary metadata use by cross-referencing StudyInstanceUIDs and SeriesInstanceUIDs in segmentation data 
-- without filtering for "Peripheral zone."
SELECT DISTINCT am."StudyInstanceUID", am."SeriesInstanceUID"
FROM IDC.IDC_V17.AUXILIARY_METADATA am
WHERE am."StudyInstanceUID" IN
    (SELECT DISTINCT da."StudyInstanceUID"
     FROM IDC.IDC_V17.DICOM_ALL da
     JOIN IDC.IDC_V17.SEGMENTATIONS sg
     ON da."SeriesInstanceUID" = sg."SeriesInstanceUID"
     WHERE da."SeriesDescription" ILIKE '%t2%weighted%' AND da."SeriesDescription" ILIKE '%axial%')
LIMIT 20;
```
[Corrected other sqls]
2025-07-01 04:41:36 - Thread-458 (execute) - INFO - [Successfully corrected]
Successfully executed. SQL:
-- Description: Query distinct AnatomicRegion and its details for segmentation analysis and confirmation of "Peripheral zone."
SELECT DISTINCT t."StudyInstanceUID", t."SOPInstanceUID", 
                f.value::VARIANT:"CodeMeaning"::STRING AS "AnatomicRegionMeaning"
FROM IDC.IDC_V17.SEGMENTATIONS t, LATERAL FLATTEN(input => t."AnatomicRegion") f
WHERE f.value::VARIANT:"CodeMeaning"::STRING ILIKE '%Peripheral zone%'
LIMIT 20;
Results:
AnatomicRegionMeaning
""

[Successfully corrected]
2025-07-01 04:41:36 - Thread-458 (execute) - INFO - [Try to execute]
-- Description: Narrow down to segmentation records linked to "qin_prostate_repeatability" collection by simplifying conditions. 
-- Instead of filtering by "segmented_SeriesInstanceUID" and "SegmentedPropertyType," list distinct records related to the collection.
SELECT DISTINCT "StudyInstanceUID", "segmented_SeriesInstanceUID", "SegmentedPropertyType"
FROM IDC.IDC_V17.SEGMENTATIONS
WHERE "PatientID" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
[Try to execute]
2025-07-01 04:41:37 - Thread-458 (execute) - INFO - [Error occurred]
No data found for the specified query.

[Error occurred]
2025-07-01 04:41:58 - Thread-458 (execute) - INFO - [Corrected SQL]
To solve the issue of a query returning no data, the problem likely arises from the restrictive `PatientID` filter. By removing the filter, we can examine the underlying data to confirm whether the table contains any values in the relevant fields (`StudyInstanceUID`, `segmented_SeriesInstanceUID`, and `SegmentedPropertyType`). This is a logical first step to determine if the table itself has valid data and to decide on further refinement for the query.

Here is the corrected and simplified query:

```sql
-- Description: Remove the filter on "PatientID" to retrieve any available data in the segmentation records.
-- This approach allows exploration of whether records exist in the SEGMENTATIONS table without restrictions.
SELECT DISTINCT "StudyInstanceUID", "segmented_SeriesInstanceUID", "SegmentedPropertyType"
FROM IDC.IDC_V17.SEGMENTATIONS
LIMIT 20;
```
[Corrected SQL]
2025-07-01 04:41:59 - Thread-458 (execute) - INFO - [Results for corrected sql]
StudyInstanceUID,segmented_SeriesInstanceUID,SegmentedPropertyType
1.3.6.1.4.1.14519.5.2.1.7009.2403.255880211066317598774127436949,,"{
  ""AnatomicRegionModifierSequence"": [],
  ""CodeMeaning"": ""FDG-Avid Tumor"",
  ""CodeValue"": ""C168968"",
  ""CodingSchemeDesignator"": ""NCIt"",
  ""SegmentedPropertyTypeModifierCodeSequence"": []
}"
1.3.6.1.4.1.14519.5.2.1.6655.2359.347530668916195093993314226855,,"{
  ""AnatomicRegionModifierSequence"": [],
  ""CodeMeaning"": ""FDG-Avid Tumor"",
  ""Co

[Results for corrected sql]
2025-07-01 04:42:23 - Thread-458 (execute) - INFO - [Corrected other sqls]
```sql
-- Description: Remove filtering conditions on "Peripheral zone" and the "qin_prostate_repeatability" collection to explore 
-- all available segmentation records and their linkage with T2-weighted axial MR imaging studies broadly.
SELECT DISTINCT da."StudyInstanceUID"
FROM IDC.IDC_V17.DICOM_ALL da
JOIN IDC.IDC_V17.SEGMENTATIONS se
ON da."SeriesInstanceUID" = se."SeriesInstanceUID"
WHERE da."SeriesDescription" ILIKE '%t2%weighted%' AND da."SeriesDescription" ILIKE '%axial%'
LIMIT 20;
```

```sql
-- Description: Broaden the scope of segmentation metadata exploration by removing the term "Peripheral zone" as a filter 
-- and retrieving all distinct "CodeMeaning" values from the "SegmentedPropertyType" field to examine possible types.
SELECT DISTINCT f.value::VARIANT:"CodeMeaning"::STRING AS "PropertyTypeMeaning"
FROM IDC.IDC_V17.SEGMENTATIONS, LATERAL FLATTEN (input => "SegmentedPropertyType") f
LIMIT 20;
```

```sql
-- Description: Simplify the query to check general linkage between segmented studies and T2-weighted axial MR imaging 
-- without specific references to the "Peripheral zone" or the "qin_prostate_repeatability" collection.
SELECT DISTINCT se."StudyInstanceUID", se."FrameOfReferenceUID", se."SeriesInstanceUID", da."SeriesDescription"
FROM IDC.IDC_V17.SEGMENTATIONS se
JOIN IDC.IDC_V17.DICOM_ALL da
ON da."SeriesInstanceUID" = se."segmented_SeriesInstanceUID"
WHERE da."SeriesDescription" ILIKE '%t2%weighted%' AND da."SeriesDescription" ILIKE '%axial%'
LIMIT 20;
```

```sql
-- Description: Remove specific filtering on "Peripheral zone" to broadly list segmentation-related series with the "MR" modality 
-- and explore valid data in the DICOM_METADATA_CURATED_SERIES_LEVEL table.
SELECT DISTINCT "SeriesInstanceUID", "Modality"
FROM IDC.IDC_V17.DICOM_METADATA_CURATED_SERIES_LEVEL
WHERE "Modality" = 'MR'
LIMIT 20;
```

```sql
-- Description: Remove specific segmentation filtering for "Peripheral zone" to explore all studies containing T2-weighted axial MR imaging 
-- without narrowing down segmentation records to a particular type.
SELECT DISTINCT dm."StudyInstanceUID"
FROM IDC.IDC_V17.DICOM_METADATA dm
JOIN IDC.IDC_V17.SEGMENTATIONS sg
ON dm."SeriesInstanceUID" = sg."SeriesInstanceUID"
WHERE dm."SeriesDescription" ILIKE '%t2%weighted%' AND dm."SeriesDescription" ILIKE '%axial%'
LIMIT 20;
```

```sql
-- Description: Simplify the query for auxiliary metadata by removing unnecessary segmentation filtering conditions like "Peripheral zone." 
-- This explores general cross-referencing of StudyInstanceUIDs and SeriesInstanceUIDs mapped in the segmentation data.
SELECT DISTINCT am."StudyInstanceUID", am."SeriesInstanceUID"
FROM IDC.IDC_V17.AUXILIARY_METADATA am
WHERE am."StudyInstanceUID" IN
    (SELECT DISTINCT da."StudyInstanceUID"
     FROM IDC.IDC_V17.DICOM_ALL da
     JOIN IDC.IDC_V17.SEGMENTATIONS sg
     ON da."SeriesInstanceUID" = sg."SeriesInstanceUID"
     WHERE da."SeriesDescription" ILIKE '%t2%weighted%' AND da."SeriesDescription" ILIKE '%axial%')
LIMIT 20;
```
[Corrected other sqls]
2025-07-01 04:42:23 - Thread-458 (execute) - INFO - [Successfully corrected]
Successfully executed. SQL:
-- Description: Narrow down to segmentation records linked to "qin_prostate_repeatability" collection by simplifying conditions. 
-- Instead of filtering by "segmented_SeriesInstanceUID" and "SegmentedPropertyType," list distinct records related to the collection.
SELECT DISTINCT "StudyInstanceUID", "segmented_SeriesInstanceUID", "SegmentedPropertyType"
FROM IDC.IDC_V17.SEGMENTATIONS
WHERE "PatientID" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
Results:
StudyInstanceUID,segmented_SeriesInstanceUID,SegmentedPropertyType
1.3.6.1.4.1.14519.5.2.1.7009.2403.255880211066317598774127436949,,"{
  ""AnatomicRegionModifierSequence"": [],
  ""CodeMeaning"": ""FDG-Avid Tumor"",
  ""CodeValue"": ""C168968"",
  ""CodingSchemeDesignator"": ""NCIt"",
  ""SegmentedPropertyTypeModifierCodeSequence"": []
}"
1.3.6.1.4.1.14519.5.2.1.6655.2359.347530668916195093993314226855,,"{
  ""AnatomicRegionModifierSequence"": [],
  ""CodeMeaning"": ""FDG-Avid Tumor"",
  ""Co

[Successfully corrected]
2025-07-01 04:42:23 - Thread-458 (execute) - INFO - itercount: 0
2025-07-01 04:42:23 - Thread-458 (execute) - INFO - [Self-refine]
Table full name: IDC.IDC_V17.DICOM_METADATA
Column name: SeriesInstanceUID Type: TEXT
Column name: Type Type: TEXT
Column name: SeriesDescription Type: TEXT
Column name: ImageType Type: VARIANT
Column name: FrameOfReferenceUID Type: TEXT
Column name: SOPInstanceUID Type: TEXT
Column name: Modality Type: TEXT
Column name: BodyPartExamined Type: TEXT
Column name: StudyInstanceUID Type: TEXT
Column name: PatientID Type: TEXT
Column name: UID Type: TEXT
Sample rows:
[{'ImageType': '[\n  "DERIVED",\n  "PRIMARY",\n  "VOLUME",\n  "NONE"\n]', 'SOPInstanceUID': '1.3.6.1.4.1.5962.99.1.154767222.292368839.1640832307062.7.0', 'Modality': 'SM', 'SeriesDescription': 'HE tumor', 'PatientID': 'C3N-01088', 'BodyPartExamined': None, 'StudyInstanceUID': '2.25.58706717250894429958007117275973416179', 'SeriesInstanceUID': '1.3.6.1.4.1.5962.99.1.154767222.292368839.1640832307062.2.0', 'FrameOfReferenceUID': '1.3.6.1.4.1.5962.99.1.154767222.292368839.1640832307062.5.0'}, {'ImageType': '[\n  "DERIVED",\n  "PRIMARY",\n  "OVERVIEW",\n  "NONE"\n]', 'SOPInstanceUID': '1.3.6.1.4.1.5962.99.1.154767222.292368839.1640832307062.35.0', 'Modality': 'SM', 'SeriesDescription': 'HE tumor', 'PatientID': 'C3N-01088', 'BodyPartExamined': None, 'StudyInstanceUID': '2.25.58706717250894429958007117275973416179', 'SeriesInstanceUID': '1.3.6.1.4.1.5962.99.1.154767222.292368839.1640832307062.2.0', 'FrameOfReferenceUID': '1.3.6.1.4.1.5962.99.1.154767222.292368839.1640832307062.5.0'}, {'ImageType': '[\n  "DERIVED",\n  "PRIMARY",\n  "LABEL",\n  "NONE"\n]', 'SOPInstanceUID': '1.3.6.1.4.1.5962.99.1.2133926228.1619968177.1655696367956.37.0', 'Modality': 'SM', 'SeriesDescription': 'HE tumor', 'PatientID': 'C3N-01088', 'BodyPartExamined': None, 'StudyInstanceUID': '2.25.58706717250894429958007117275973416179', 'SeriesInstanceUID': '1.3.6.1.4.1.5962.99.1.154767222.292368839.1640832307062.2.0', 'FrameOfReferenceUID': '1.3.6.1.4.1.5962.99.1.2133926228.1619968177.1655696367956.7.0'}, {'ImageType': '[\n  "DERIVED",\n  "PRIMARY",\n  "OVERVIEW",\n  "NONE"\n]', 'SOPInstanceUID': '1.3.6.1.4.1.5962.99.1.157627571.692579403.1640835167411.42.0', 'Modality': 'SM', 'SeriesDescription': 'HE tumor', 'PatientID': 'C3N-01088', 'BodyPartExamined': None, 'StudyInstanceUID': '2.25.58706717250894429958007117275973416179', 'SeriesInstanceUID': '1.3.6.1.4.1.5962.99.1.157627571.692579403.1640835167411.2.0', 'FrameOfReferenceUID': '1.3.6.1.4.1.5962.99.1.157627571.692579403.1640835167411.5.0'}, {'ImageType': '[\n  "DERIVED",\n  "PRIMARY",\n  "VOLUME",\n  "NONE"\n]', 'SOPInstanceUID': '1.3.6.1.4.1.5962.99.1.157627571.692579403.1640835167411.7.0', 'Modality': 'SM', 'SeriesDescription': 'HE tumor', 'PatientID': 'C3N-01088', 'BodyPartExamined': None, 'StudyInstanceUID': '2.25.58706717250894429958007117275973416179', 'SeriesInstanceUID': '1.3.6.1.4.1.5962.99.1.157627571.692579403.1640835167411.2.0', 'FrameOfReferenceUID': '1.3.6.1.4.1.5962.99.1.157627571.692579403.1640835167411.5.0'}]
--------------------------------------------------
Table full name: IDC.IDC_V17.DICOM_METADATA_CURATED
Column name: BodyPartExamined Type: TEXT Description: Curated value of BodyPartExamined following the manually created mapping. For the mapping details, please refer to the query referenced in the series description.
Column name: SOPInstanceUID Type: TEXT Description: DICOM SOPInstanceUID
Sample rows:
[{'SOPInstanceUID': '1.3.6.1.4.1.14519.5.2.1.1620.1225.337801122878670074294531806897', 'BodyPartExamined': None}, {'SOPInstanceUID': '1.3.6.1.4.1.5962.99.1.2140475088.421872551.1655702916816.37.0', 'BodyPartExamined': None}, {'SOPInstanceUID': '1.3.6.1.4.1.5962.99.1.3388672280.250944349.1639771244824.22.0', 'BodyPartExamined': None}, {'SOPInstanceUID': '1.3.6.1.4.1.5962.99.1.285798320.1466497774.1640963338160.42.0', 'BodyPartExamined': None}, {'SOPInstanceUID': '1.2.276.0.7230010.3.1.4.481037312.39574.1685071533.519153', 'BodyPartExamined': None}]
--------------------------------------------------
Table full name: IDC.IDC_V17.AUXILIARY_METADATA
Column name: collection_name Type: TEXT Description: Collection name as used externally by IDC webapp
Column name: SOPInstanceUID Type: TEXT Description: DICOM instance containing this instance version
Column name: collection_id Type: TEXT Description: Collection ID as used internally by IDC webapp and accepted by the IDC API
Column name: StudyInstanceUID Type: TEXT Description: DICOM study containing this instance
Column name: SeriesInstanceUID Type: TEXT Description: DICOM series containing this instance
Sample rows:
[{'collection_name': 'ACRIN-6698', 'collection_id': 'acrin_6698', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7695.4164.205849350381621543824875482470', 'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7695.4164.100929779510512848238254512097', 'SOPInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7695.4164.784850890634822414222832957135'}, {'collection_name': 'ACRIN-6698', 'collection_id': 'acrin_6698', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7695.4164.205849350381621543824875482470', 'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7695.4164.100929779510512848238254512097', 'SOPInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7695.4164.166527479339466134062467856450'}, {'collection_name': 'ACRIN-6698', 'collection_id': 'acrin_6698', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7695.4164.205849350381621543824875482470', 'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7695.4164.100929779510512848238254512097', 'SOPInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7695.4164.227440160180778953226675332234'}, {'collection_name': 'ACRIN-6698', 'collection_id': 'acrin_6698', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7695.4164.205849350381621543824875482470', 'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7695.4164.100929779510512848238254512097', 'SOPInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7695.4164.267897853011778859581783671016'}, {'collection_name': 'ACRIN-6698', 'collection_id': 'acrin_6698', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7695.4164.205849350381621543824875482470', 'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7695.4164.100929779510512848238254512097', 'SOPInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7695.4164.331545318411104179804799741788'}]
--------------------------------------------------
Table full name: IDC.IDC_V17.DICOM_ALL
Column name: PatientID Type: TEXT Description: Patient ID assigned by submitter of this data
Column name: UID Type: TEXT
Column name: Modality Type: TEXT
Column name: SeriesDescription Type: TEXT
Column name: SOPInstanceUID Type: TEXT
Column name: collection_id Type: TEXT Description: The ID of the collection containing this instance as expected by the IDC web app and API. Duplicate of the idc_webapp_collection_id column.
Column name: ImageType Type: VARIANT
Column name: FrameOfReferenceUID Type: TEXT
Column name: StudyInstanceUID Type: TEXT
Column name: collection_name Type: TEXT Description: The ID of the collection containing this instance as expected by the TCIA API
Column name: SeriesInstanceUID Type: TEXT
Column name: Type Type: TEXT
Column name: BodyPartExamined Type: TEXT
Sample rows:
[{'collection_name': 'NLST', 'collection_id': 'nlst', 'PatientID': '115644', 'StudyInstanceUID': '1.2.840.113654.2.55.62621785606309318595425188615995118704', 'SeriesInstanceUID': '1.2.840.113654.2.55.286585074629136673697149467703631406338', 'SOPInstanceUID': '1.2.840.113654.2.55.232251254905686701117181565039442087865', 'ImageType': '[\n  "ORIGINAL",\n  "PRIMARY",\n  "AXIAL"\n]', 'Modality': 'CT', 'SeriesDescription': '1,OPA,GE,HSQX,STANDARD,310,2.5,120,56,0.1,1.5', 'BodyPartExamined': 'CHEST', 'FrameOfReferenceUID': '1.2.840.113654.2.55.285632087297227048789004062697777751240'}, {'collection_name': 'NLST', 'collection_id': 'nlst', 'PatientID': '125284', 'StudyInstanceUID': '1.2.840.113654.2.55.252823246291318780125419075611881707753', 'SeriesInstanceUID': '1.2.840.113654.2.55.206816254587970136084378013338289118172', 'SOPInstanceUID': '1.2.840.113654.2.55.281149784892428811639464384293629235745', 'ImageType': '[\n  "ORIGINAL",\n  "PRIMARY",\n  "AXIAL"\n]', 'Modality': 'CT', 'SeriesDescription': '1,OPA,GE,HSQX,STANDARD,310,2.5,120,56,0.1,1.5', 'BodyPartExamined': 'CHEST', 'FrameOfReferenceUID': '1.2.840.113654.2.55.289860117885059951581331984115968993773'}, {'collection_name': 'NLST', 'collection_id': 'nlst', 'PatientID': '111916', 'StudyInstanceUID': '1.2.840.113654.2.55.321739936466302978441987047842606358921', 'SeriesInstanceUID': '1.2.840.113654.2.55.177630169322150231721484650076633097612', 'SOPInstanceUID': '1.2.840.113654.2.55.169820662853239776981123072671212105735', 'ImageType': '[\n  "ORIGINAL",\n  "PRIMARY",\n  "AXIAL"\n]', 'Modality': 'CT', 'SeriesDescription': '1,OPA,GE,HSQX,STANDARD,350,2.5,120,56,0.1,1.5', 'BodyPartExamined': 'CHEST', 'FrameOfReferenceUID': '1.2.840.113654.2.55.157163729707117767734085490601447856377'}, {'collection_name': 'NLST', 'collection_id': 'nlst', 'PatientID': '105094', 'StudyInstanceUID': '1.2.840.113654.2.55.238810784403423496900404050276632823832', 'SeriesInstanceUID': '1.2.840.113654.2.55.241127592238091291973528290810645287066', 'SOPInstanceUID': '1.2.840.113654.2.55.195670402165839899895759391289032265317', 'ImageType': '[\n  "ORIGINAL",\n  "PRIMARY",\n  "AXIAL"\n]', 'Modality': 'CT', 'SeriesDescription': '1,OPA,GE,HSQX,STANDARD,350,2.5,120,56,0.1,1.5', 'BodyPartExamined': 'CHEST', 'FrameOfReferenceUID': '1.2.840.113654.2.55.307856552820635402859020226684702278502'}, {'collection_name': 'NLST', 'collection_id': 'nlst', 'PatientID': '131538', 'StudyInstanceUID': '1.2.840.113654.2.55.65506226137788125731294707744660637427', 'SeriesInstanceUID': '1.2.840.113654.2.55.256299343016283789104389095516984631610', 'SOPInstanceUID': '1.2.840.113654.2.55.85167056264528248627639073741729153183', 'ImageType': '[\n  "ORIGINAL",\n  "PRIMARY",\n  "AXIAL"\n]', 'Modality': 'CT', 'SeriesDescription': '1,OPA,GE,HSQX,STANDARD,350,2.5,120,56,0.1,1.5', 'BodyPartExamined': 'CHEST', 'FrameOfReferenceUID': '1.2.840.113654.2.55.149676308333004775782966424142666292260'}]
--------------------------------------------------
Table full name: IDC.IDC_V17.SEGMENTATIONS
Column name: SeriesInstanceUID Type: TEXT
Column name: StudyInstanceUID Type: TEXT
Column name: PatientID Type: TEXT
Column name: SegmentedPropertyCategory Type: VARIANT
Column name: SegmentAlgorithmType Type: TEXT
Column name: SegmentNumber Type: NUMBER
Column name: SegmentedPropertyType Type: VARIANT
Column name: SOPInstanceUID Type: TEXT
Column name: AnatomicRegion Type: VARIANT
Column name: segmented_SeriesInstanceUID Type: TEXT
Column name: FrameOfReferenceUID Type: TEXT
Sample rows:
[{'PatientID': 'Lung_Dx-A0190', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.6655.2359.347530668916195093993314226855', 'SeriesInstanceUID': '1.2.276.0.7230010.3.1.3.17436516.653383.1696970728.262449', 'SOPInstanceUID': '1.2.276.0.7230010.3.1.4.17436516.653383.1696970728.262450', 'FrameOfReferenceUID': '1.3.6.1.4.1.14519.5.2.1.6655.2359.138271048259053653884696768856', 'AnatomicRegion': '{\n  "CodeMeaning": "Lung",\n  "CodeValue": "39607008",\n  "CodingSchemeDesignator": "SCT"\n}', 'SegmentedPropertyCategory': '{\n  "CodeMeaning": "Radiologic Finding",\n  "CodeValue": "C35869",\n  "CodingSchemeDesignator": "NCIt"\n}', 'SegmentedPropertyType': '{\n  "AnatomicRegionModifierSequence": [],\n  "CodeMeaning": "FDG-Avid Tumor",\n  "CodeValue": "C168968",\n  "CodingSchemeDesignator": "NCIt",\n  "SegmentedPropertyTypeModifierCodeSequence": []\n}', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentNumber': 2, 'segmented_SeriesInstanceUID': None}, {'PatientID': 'ACRIN-NSCLC-FDG-PET-241', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7009.2403.310711020836741121756601412628', 'SeriesInstanceUID': '1.2.276.0.7230010.3.1.3.17436516.664776.1696970888.933027', 'SOPInstanceUID': '1.2.276.0.7230010.3.1.4.17436516.664776.1696970888.933028', 'FrameOfReferenceUID': '1.3.6.1.4.1.14519.5.2.1.7009.2403.331653382114194988162880540454', 'AnatomicRegion': '{\n  "CodeMeaning": "Lung",\n  "CodeValue": "39607008",\n  "CodingSchemeDesignator": "SCT"\n}', 'SegmentedPropertyCategory': '{\n  "CodeMeaning": "Radiologic Finding",\n  "CodeValue": "C35869",\n  "CodingSchemeDesignator": "NCIt"\n}', 'SegmentedPropertyType': '{\n  "AnatomicRegionModifierSequence": [],\n  "CodeMeaning": "FDG-Avid Tumor",\n  "CodeValue": "C168968",\n  "CodingSchemeDesignator": "NCIt",\n  "SegmentedPropertyTypeModifierCodeSequence": []\n}', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentNumber': 2, 'segmented_SeriesInstanceUID': None}, {'PatientID': 'R01-117', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.4334.1501.235943114230672958648726848000', 'SeriesInstanceUID': '1.2.276.0.7230010.3.1.3.17436516.666590.1696970914.61655', 'SOPInstanceUID': '1.2.276.0.7230010.3.1.4.17436516.666590.1696970914.61656', 'FrameOfReferenceUID': '1.3.6.1.4.1.14519.5.2.1.4334.1501.258477471729273768248128963850', 'AnatomicRegion': '{\n  "CodeMeaning": "Lung",\n  "CodeValue": "39607008",\n  "CodingSchemeDesignator": "SCT"\n}', 'SegmentedPropertyCategory': '{\n  "CodeMeaning": "Radiologic Finding",\n  "CodeValue": "C35869",\n  "CodingSchemeDesignator": "NCIt"\n}', 'SegmentedPropertyType': '{\n  "AnatomicRegionModifierSequence": [],\n  "CodeMeaning": "FDG-Avid Tumor",\n  "CodeValue": "C168968",\n  "CodingSchemeDesignator": "NCIt",\n  "SegmentedPropertyTypeModifierCodeSequence": []\n}', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentNumber': 2, 'segmented_SeriesInstanceUID': None}, {'PatientID': 'ACRIN-NSCLC-FDG-PET-241', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7009.2403.310711020836741121756601412628', 'SeriesInstanceUID': '1.2.276.0.7230010.3.1.3.17436516.651565.1696970702.349014', 'SOPInstanceUID': '1.2.276.0.7230010.3.1.4.17436516.651565.1696970702.349015', 'FrameOfReferenceUID': '1.3.6.1.4.1.14519.5.2.1.7009.2403.331653382114194988162880540454', 'AnatomicRegion': '{\n  "CodeMeaning": "Lung",\n  "CodeValue": "39607008",\n  "CodingSchemeDesignator": "SCT"\n}', 'SegmentedPropertyCategory': '{\n  "CodeMeaning": "Radiologic Finding",\n  "CodeValue": "C35869",\n  "CodingSchemeDesignator": "NCIt"\n}', 'SegmentedPropertyType': '{\n  "AnatomicRegionModifierSequence": [],\n  "CodeMeaning": "FDG-Avid Tumor",\n  "CodeValue": "C168968",\n  "CodingSchemeDesignator": "NCIt",\n  "SegmentedPropertyTypeModifierCodeSequence": []\n}', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentNumber': 2, 'segmented_SeriesInstanceUID': None}, {'PatientID': 'ACRIN-NSCLC-FDG-PET-134', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.7009.2403.109906860154809337892916956712', 'SeriesInstanceUID': '1.2.276.0.7230010.3.1.3.17436516.664189.1696970884.510051', 'SOPInstanceUID': '1.2.276.0.7230010.3.1.4.17436516.664189.1696970884.510052', 'FrameOfReferenceUID': '1.3.6.1.4.1.14519.5.2.1.7009.2403.137251274848917092866047430956', 'AnatomicRegion': '{\n  "CodeMeaning": "Lung",\n  "CodeValue": "39607008",\n  "CodingSchemeDesignator": "SCT"\n}', 'SegmentedPropertyCategory': '{\n  "CodeMeaning": "Radiologic Finding",\n  "CodeValue": "C35869",\n  "CodingSchemeDesignator": "NCIt"\n}', 'SegmentedPropertyType': '{\n  "AnatomicRegionModifierSequence": [],\n  "CodeMeaning": "FDG-Avid Tumor",\n  "CodeValue": "C168968",\n  "CodingSchemeDesignator": "NCIt",\n  "SegmentedPropertyTypeModifierCodeSequence": []\n}', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentNumber': 2, 'segmented_SeriesInstanceUID': None}]
--------------------------------------------------
Table full name: IDC.IDC_V17.DICOM_METADATA_CURATED_SERIES_LEVEL
Column name: SeriesInstanceUID Type: TEXT Description: DICOM SeriesInstanceUID
Column name: Modality Type: TEXT Description: DICOM Modality
Sample rows:
[{'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.2103.7010.269874.1.2', 'Modality': 'KO'}, {'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.2103.7010.269874.1.1', 'Modality': 'KO'}, {'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.2103.7010.237254.1.2', 'Modality': 'KO'}, {'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.2103.7010.263376.2.1', 'Modality': 'KO'}, {'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.2103.7010.135953.2.2', 'Modality': 'KO'}]
--------------------------------------------------
Table full name: IDC.IDC_V17.DICOM_PIVOT
Column name: BodyPartExamined Type: TEXT
Column name: Modality Type: TEXT
Column name: SeriesDescription Type: TEXT
Column name: SOPInstanceUID Type: TEXT
Column name: SegmentedPropertyTypeCodeSequence Type: TEXT
Column name: collection_id Type: TEXT
Column name: FrameOfReferenceUID Type: TEXT
Column name: SeriesInstanceUID Type: TEXT
Column name: StudyInstanceUID Type: TEXT
Column name: SegmentAlgorithmType Type: TEXT
Column name: ImageType Type: TEXT
Column name: PatientID Type: TEXT
Column name: SegmentNumber Type: NUMBER
Column name: primaryAnatomicStructure Type: TEXT
Sample rows:
[{'PatientID': 'UPENN-GBM-00513', 'BodyPartExamined': 'HEADNECK', 'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.185195136958159502142654387221547856729', 'SeriesDescription': 'ep2d_perf BOLUS_TERA', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.92084504364921012205012538829705733768', 'SOPInstanceUID': '1.3.6.1.4.1.14519.5.2.1.201644798538859159720916103279874451632', 'Modality': 'MR', 'collection_id': 'upenn_gbm', 'FrameOfReferenceUID': None, 'primaryAnatomicStructure': None, 'SegmentedPropertyTypeCodeSequence': None, 'SegmentNumber': None, 'SegmentAlgorithmType': None, 'ImageType': 'ORIGINAL, PRIMARY, PERFUSION, NONE, ND, NORM'}, {'PatientID': 'UPENN-GBM-00519', 'BodyPartExamined': 'HEADNECK', 'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.285201929497843344185967283825964169195', 'SeriesDescription': 'ep2d_perf BOLUS_TERA', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.285969882316463253344322862464631605069', 'SOPInstanceUID': '1.3.6.1.4.1.14519.5.2.1.284648789561114483507224549503882513471', 'Modality': 'MR', 'collection_id': 'upenn_gbm', 'FrameOfReferenceUID': None, 'primaryAnatomicStructure': None, 'SegmentedPropertyTypeCodeSequence': None, 'SegmentNumber': None, 'SegmentAlgorithmType': None, 'ImageType': 'ORIGINAL, PRIMARY, PERFUSION, NONE, ND, NORM'}, {'PatientID': 'UPENN-GBM-00416', 'BodyPartExamined': 'HEADNECK', 'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.75622442647298518363100372261560810525', 'SeriesDescription': 'ep2d_perf BOLUS_TERA', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.16570277643982576751137554563747012374', 'SOPInstanceUID': '1.3.6.1.4.1.14519.5.2.1.64715764737679289365432093996341540549', 'Modality': 'MR', 'collection_id': 'upenn_gbm', 'FrameOfReferenceUID': None, 'primaryAnatomicStructure': None, 'SegmentedPropertyTypeCodeSequence': None, 'SegmentNumber': None, 'SegmentAlgorithmType': None, 'ImageType': 'ORIGINAL, PRIMARY, PERFUSION, NONE, ND, NORM'}, {'PatientID': 'UPENN-GBM-00473', 'BodyPartExamined': 'HEADNECK', 'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.135489908748676184571973467902447917371', 'SeriesDescription': 'ep2d_perf BOLUS_TERA', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.152520037553718269187855913202992933964', 'SOPInstanceUID': '1.3.6.1.4.1.14519.5.2.1.114859382544420303794672772499243450451', 'Modality': 'MR', 'collection_id': 'upenn_gbm', 'FrameOfReferenceUID': None, 'primaryAnatomicStructure': None, 'SegmentedPropertyTypeCodeSequence': None, 'SegmentNumber': None, 'SegmentAlgorithmType': None, 'ImageType': 'ORIGINAL, PRIMARY, PERFUSION, NONE, ND, NORM'}, {'PatientID': 'UPENN-GBM-00459', 'BodyPartExamined': 'HEADNECK', 'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.152910459779232363967902946401636166563', 'SeriesDescription': 'ep2d_perf BOLUS_TERA', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.304279265306776379494650249168307485581', 'SOPInstanceUID': '1.3.6.1.4.1.14519.5.2.1.308657597317534610205545200298236188919', 'Modality': 'MR', 'collection_id': 'upenn_gbm', 'FrameOfReferenceUID': None, 'primaryAnatomicStructure': None, 'SegmentedPropertyTypeCodeSequence': None, 'SegmentNumber': None, 'SegmentAlgorithmType': None, 'ImageType': 'ORIGINAL, PRIMARY, PERFUSION, NONE, ND, NORM'}]
--------------------------------------------------
Table full name: IDC.IDC_V17.ORIGINAL_COLLECTIONS_METADATA
Column name: collection_name Type: TEXT Description: Collection name as used externally by IDC webapp
Column name: collection_id Type: TEXT Description: Collection ID as used internally by IDC webapp
Sample rows:
[{'collection_name': 'VICTRE', 'collection_id': 'victre'}, {'collection_name': 'QIN Breast DCE-MRI', 'collection_id': 'qin_breast_dce_mri'}, {'collection_name': 'Lung Phantom', 'collection_id': 'lung_phantom'}, {'collection_name': 'PDMR-BL0293-F563', 'collection_id': 'pdmr_bl0293_f563'}, {'collection_name': 'TCGA-SARC', 'collection_id': 'tcga_sarc'}]
--------------------------------------------------
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'IDC': {'IDC_V17': ['DICOM_METADATA', 'DICOM_METADATA_CURATED', 'AUXILIARY_METADATA', 'DICOM_ALL', 'SEGMENTATIONS', 'DICOM_METADATA_CURATED_SERIES_LEVEL', 'DICOM_PIVOT', 'ORIGINAL_COLLECTIONS_METADATA']}}

Some few-shot examples after column exploration may be helpful:
Query:
-- Description: Query distinct StudyInstanceUIDs for the "qin_prostate_repeatability" collection.
SELECT DISTINCT "StudyInstanceUID", "collection_id"
FROM IDC.IDC_V17.DICOM_ALL
WHERE "collection_id" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
Answer:
StudyInstanceUID,collection_id
1.3.6.1.4.1.14519.5.2.1.3671.4754.181478254003851548055481596513,qin_prostate_repeatability
1.3.6.1.4.1.14519.5.2.1.3671.4754.240823776621155108064488841063,qin_prostate_repeatability
1.3.6.1.4.1.14519.5.2.1.3671.4754.194890890650697728529329442454,qin_prostate_repeatability
1.3.6.1.4.1.14519.5.2.1.3671.4754.266963586071007736606548226859,qin_prostate_repeatability
1.3.6.1.4.1.14519.5.2.1.3671.4754.173585825705285812758858023242,qin_prostate_repeatability
1.3
Query:
-- Description: Check if T2-weighted axial MR imaging is present by filtering SeriesDescription with a fuzzy match that includes "T2-weighted" and "axial".
SELECT DISTINCT "StudyInstanceUID", "SeriesDescription", "Modality"
FROM IDC.IDC_V17.DICOM_ALL
WHERE "SeriesDescription" ILIKE '%t2%weighted%' AND "SeriesDescription" ILIKE '%axial%'
  AND "collection_id" ILIKE '%qin%prostate%repeatability%'
LIMIT 20;
Answer:
StudyInstanceUID,SeriesDescription,Modality
1.3.6.1.4.1.14519.5.2.1.3671.4754.288453744990673175783381845880,T2 Weighted Axial,MR
1.3.6.1.4.1.14519.5.2.1.3671.4754.568383070573576760578239627478,T2 Weighted Axial,MR
1.3.6.1.4.1.14519.5.2.1.3671.4754.962865348146140991373362412648,T2 Weighted Axial,MR
1.3.6.1.4.1.14519.5.2.1.3671.4754.133806669697115873569905534398,T2 Weighted Axial,MR
1.3.6.1.4.1.14519.5.2.1.3671.4754.864607788085827202303582199118,T2 Weighted Axial,MR
1.3.6.1.4.1.14519.5.
Task: In the "qin_prostate_repeatability" collection, please provide the distinct StudyInstanceUIDs for studies that include T2-weighted axial MR imaging and also contain anatomical structure segmentations labeled as "Peripheral zone."
Another way to say it: Please provide the study instance UIDs for studies that include both T2-weighted axial magnetic resonance imaging and anatomical structure segmentations of the peripheral zone, in prostate repeatability collection.

Please think step by step and answer only one complete SQL in snowflake dialect in ```sql``` format.
SQL usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'IDC': {'IDC_V17': ['DICOM_METADATA', 'DICOM_METADATA_CURATED', 'AUXILIARY_METADATA', 'DICOM_ALL', 'SEGMENTATIONS', 'DICOM_METADATA_CURATED_SERIES_LEVEL', 'DICOM_PIVOT', 'ORIGINAL_COLLECTIONS_METADATA']}}

When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When asked something without stating name or id, return both of them. e.g. Which products ...? The answer should include product_name and product_id.
When asked percentage decrease, you should return a positive value. e.g. How many percentage points in 2021 decrease compared to ...? The answer should be a positive value indicating the decresed number. Try to use ABS().
If asked two tables, you should reply with the last one instead of combining two tables. e.g. Identifying the top five states ... examine the state that ranks fourth overall and identify its top five counties. You should only answer top five counties.
Use ST_DISTANCE to calculate distance between two geographic points for more accurate answer.
If the task description does not specify the number of decimal places, retain all decimals to four places.

[Self-refine]
2025-07-01 04:42:29 - Thread-458 (execute) - INFO - [Try to run SQL in self-refine]
```sql
SELECT DISTINCT T2."StudyInstanceUID"
FROM IDC.IDC_V17.DICOM_ALL T2
JOIN IDC.IDC_V17.SEGMENTATIONS SEG
  ON T2."StudyInstanceUID" = SEG."StudyInstanceUID"
  AND T2."SeriesInstanceUID" = SEG."SeriesInstanceUID"
WHERE T2."collection_id" ILIKE '%qin%prostate%repeatability%'
  AND T2."SeriesDescription" ILIKE '%t2%weighted%' 
  AND T2."SeriesDescription" ILIKE '%axial%'
  AND SEG."SegmentedPropertyType" ILIKE '%Peripheral zone%';
```
[Try to run SQL in self-refine]
2025-07-01 04:42:30 - Thread-458 (execute) - INFO - Total iteration counts: 0
