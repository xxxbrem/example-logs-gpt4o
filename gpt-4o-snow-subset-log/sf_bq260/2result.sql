SELECT
    "gender",
    COUNT(CASE WHEN "age" = (SELECT MIN("age") 
                             FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE.USERS
                             WHERE "created_at" BETWEEN 1546300800000000 AND 1651363199000000) THEN 1 END) AS "Youngest_User_Count",
    COUNT(CASE WHEN "age" = (SELECT MAX("age") 
                             FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE.USERS
                             WHERE "created_at" BETWEEN 1546300800000000 AND 1651363199000000) THEN 1 END) AS "Oldest_User_Count"
FROM THELOOK_ECOMMERCE.THELOOK_ECOMMERCE.USERS
WHERE "created_at" BETWEEN 1546300800000000 AND 1651363199000000
GROUP BY "gender";