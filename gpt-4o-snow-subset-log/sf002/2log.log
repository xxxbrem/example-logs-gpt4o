2025-07-01 04:56:57 - Thread-915 (execute) - INFO - [Exploration]
```sql
-- Description: Start by checking which variables correspond to '% Insured (Estimated)' in the FDIC-related attributes table to identify the applicable variable identifier.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES"
WHERE "VARIABLE_NAME" ILIKE '%Insured%Estimated%' 
LIMIT 20;
```

```sql
-- Description: Verify the variable identifier discovered earlier to confirm its measurement type and frequency to ensure it's quarterly data and suitable for our calculations.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME", "MEASUREMENT_TYPE", "FREQUENCY" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES"
WHERE "VARIABLE_NAME" ILIKE '%Insured%Estimated%' 
LIMIT 20;
```

```sql
-- Description: Check all active banks with assets exceeding $10 billion as of December 31, 2022. Fetch bank names, FDIC certificates, and their total assets for validation.
SELECT DISTINCT e."NAME", e."FDIC_CERT", e."ID_RSSD", t."VALUE", t."DATE", t."VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t
ON e."ID_RSSD" = t."ID_RSSD"
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" ILIKE '%Assets%'
AND t."DATE" = '2022-12-31'
AND t."VALUE" > 10000000000
LIMIT 20;
```

```sql
-- Description: Retrieve the percentage of insured deposits for active banks with assets > $10 billion as of December 31, 2022, joining entities with the relevant timeseries.
SELECT DISTINCT e."NAME", e."FDIC_CERT", e."ID_RSSD", t."VALUE" AS "PERCENT_INSURED", t."DATE", t."VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t
ON e."ID_RSSD" = t."ID_RSSD"
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" ILIKE '%Insured%Estimated%'
AND t."DATE" = '2022-12-31'
AND t."VALUE" IS NOT NULL
LIMIT 20;
```

```sql
-- Description: Investigate other related variables for uninsured assets percentage computation, possibly indicated by 'Insured' combined with 'Uninsured' in timeseries.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME", "UNIT", "DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%Insured%' OR "VARIABLE_NAME" ILIKE '%Uninsured%'
LIMIT 20;
```

```sql
-- Description: Query for the top banks by uninsured asset percentages, calculated as (1 - value of Insured (Estimated)), for validation of rankings.
SELECT e."NAME", 
       e."FDIC_CERT", 
       e."ID_RSSD", 
       1 - t."VALUE" AS "UNINSURED_PERCENTAGE", 
       t."DATE"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t
ON e."ID_RSSD" = t."ID_RSSD"
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" ILIKE '%Insured%Estimated%'
AND t."DATE" = '2022-12-31'
ORDER BY "UNINSURED_PERCENTAGE" DESC
LIMIT 20;
```

```sql
-- Description: Double-checking any inconsistencies in values or missing data using another set of variables possibly linked to uninsured assets.
SELECT DISTINCT "ID_RSSD", "VARIABLE_NAME", "VALUE", "DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%Uninsured%'
AND "DATE" = '2022-12-31'
LIMIT 20;
```

```sql
-- Description: Retrieve only the relevant attributes of uninsured assets from the "FINANCIAL_INSTITUTION_ATTRIBUTES" table for alignment confirmation with timeseries.
SELECT DISTINCT "VARIABLE_NAME", "VARIABLE", "UNIT", "DEFINITION" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ATTRIBUTES"
WHERE "VARIABLE_NAME" ILIKE '%Insured%' OR "VARIABLE_NAME" ILIKE '%Uninsured%'
LIMIT 20;
```

```sql
-- Description: Ensure that the 'Insured (Estimated)' and total assets variables used in prior joins refer correctly to "FINANCIAL_INSTITUTION_TIMESERIES".
SELECT DISTINCT "ID_RSSD", "VARIABLE", "VARIABLE_NAME", "VALUE", "DATE", "UNIT" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE ("VARIABLE_NAME" ILIKE '%Insured%' OR "VARIABLE_NAME" ILIKE '%Assets%')
AND "DATE" = '2022-12-31'
LIMIT 20;
```

```sql
-- Description: Validate top banks by uninsured asset percentage, ensuring that only relevant columns are fetched for readability sorted by uninsured percentage.
SELECT e."NAME", 
       e."FDIC_CERT", 
       ROUND(1 - t."VALUE", 4) AS "UNINSURED_PERCENTAGE", 
       t."DATE"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t
ON e."ID_RSSD" = t."ID_RSSD"
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" ILIKE '%Insured%Estimated%'
AND t."DATE" = '2022-12-31'
ORDER BY "UNINSURED_PERCENTAGE" DESC
LIMIT 10;
```
[Exploration]
2025-07-01 04:56:57 - Thread-915 (execute) - INFO - [Try to execute]
-- Description: Start by checking which variables correspond to '% Insured (Estimated)' in the FDIC-related attributes table to identify the applicable variable identifier.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES"
WHERE "VARIABLE_NAME" ILIKE '%Insured%Estimated%' 
LIMIT 20;
[Try to execute]
2025-07-01 04:56:58 - Thread-915 (execute) - INFO - [Error occurred]
No data found for the specified query.

[Error occurred]
2025-07-01 04:57:15 - Thread-915 (execute) - INFO - [Corrected SQL]
To adjust for the issue of no data being found, the strategy shifts to exploring the structure of the data by searching for any pattern broadly related to "Insured." By simplifying the query, we aim to identify variables that might contain related keywords or concepts. The keyword `%Insured%` is chosen to increase the likelihood of finding relevant data without over-constraining the query.

```sql
-- Description: Simplify the search condition by looking for any variables containing the word 'Insured' in their names to identify relevant data points in the FDIC Summary of Deposits Attributes table.
SELECT "VARIABLE", "VARIABLE_NAME" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES"
WHERE "VARIABLE_NAME" LIKE '%Insured%' 
LIMIT 20;
```
[Corrected SQL]
2025-07-01 04:57:15 - Thread-915 (execute) - INFO - [Results for corrected sql]
VARIABLE,VARIABLE_NAME
INSBRDD,Demand Deposits in Insured Branches in Puerto Rico and US Territories & Possessions
INSBRTS,Time and Savings Deposits in Insured Branches in Puerto Rico and US Territories & Possessions

[Results for corrected sql]
2025-07-01 04:57:45 - Thread-915 (execute) - INFO - [Corrected other sqls]
```sql
-- Description: Verify the variable identifier by broadening the search to include any variable names containing the keyword 'Insured' to confirm its measurement type and frequency, ensuring it's suitable for quarterly data.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME", "MEASUREMENT_TYPE", "FREQUENCY" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES"
WHERE "VARIABLE_NAME" LIKE '%Insured%'
LIMIT 20;
```

```sql
-- Description: Retrieve all active banks with assets exceeding $10 billion as of December 31, 2022, ensuring a comprehensive search for large banks. The '%Assets%' condition is retained since it does not involve overly specific keywords.
SELECT DISTINCT e."NAME", e."FDIC_CERT", e."ID_RSSD", t."VALUE", t."DATE", t."VARIABLE_NAME" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e 
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t 
ON e."ID_RSSD" = t."ID_RSSD" 
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" LIKE '%Assets%' 
AND t."DATE" = '2022-12-31' 
AND t."VALUE" > 10000000000 
LIMIT 20;
```

```sql
-- Description: Broaden the search to retrieve the percentage of insured deposits for active banks with assets > $10 billion as of December 31, 2022, by focusing on variables containing 'Insured.'
SELECT DISTINCT e."NAME", e."FDIC_CERT", e."ID_RSSD", t."VALUE" AS "PERCENT_INSURED", t."DATE", t."VARIABLE_NAME" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e 
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t 
ON e."ID_RSSD" = t."ID_RSSD" 
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" LIKE '%Insured%' 
AND t."DATE" = '2022-12-31' 
AND t."VALUE" IS NOT NULL 
LIMIT 20;
```

```sql
-- Description: Investigate variables for uninsured assets percentage computation by searching for broader keywords like '%Insured%' or '%Uninsured%'.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME", "UNIT", "DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" 
WHERE "VARIABLE_NAME" LIKE '%Insured%' OR "VARIABLE_NAME" LIKE '%Uninsured%' 
LIMIT 20;
```

```sql
-- Description: Compute top banks by uninsured asset percentages, now using broadened criteria ('%Insured%') to avoid overly specific filters and increase matching possibilities.
SELECT e."NAME", 
       e."FDIC_CERT", 
       e."ID_RSSD", 
       1 - t."VALUE" AS "UNINSURED_PERCENTAGE", 
       t."DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e 
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t 
ON e."ID_RSSD" = t."ID_RSSD" 
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" LIKE '%Insured%' 
AND t."DATE" = '2022-12-31' 
ORDER BY "UNINSURED_PERCENTAGE" DESC 
LIMIT 20;
```

```sql
-- Description: Search for inconsistencies or missing data by focusing solely on variables containing the broadened keyword 'Uninsured'.
SELECT DISTINCT "ID_RSSD", "VARIABLE_NAME", "VALUE", "DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" 
WHERE "VARIABLE_NAME" LIKE '%Uninsured%' 
AND "DATE" = '2022-12-31' 
LIMIT 20;
```

```sql
-- Description: Retrieve related attributes for uninsured deposits by expanding the condition to search for broader keywords like '%Insured%' and '%Uninsured%' in the attributes table.
SELECT DISTINCT "VARIABLE_NAME", "VARIABLE", "UNIT", "DEFINITION" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ATTRIBUTES" 
WHERE "VARIABLE_NAME" LIKE '%Insured%' OR "VARIABLE_NAME" LIKE '%Uninsured%' 
LIMIT 20;
```

```sql
-- Description: Validate 'Insured' or 'Assets' variables in the financial institution timeseries table by using broadened keywords.
SELECT DISTINCT "ID_RSSD", "VARIABLE", "VARIABLE_NAME", "VALUE", "DATE", "UNIT" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" 
WHERE ("VARIABLE_NAME" LIKE '%Insured%' OR "VARIABLE_NAME" LIKE '%Assets%') 
AND "DATE" = '2022-12-31' 
LIMIT 20;
```

```sql
-- Description: Validate and rank top banks by uninsured percentages while broadening variables related to 'Insured' deposits in the timeseries data.
SELECT e."NAME", 
       e."FDIC_CERT", 
       ROUND(1 - t."VALUE", 4) AS "UNINSURED_PERCENTAGE", 
       t."DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e 
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t 
ON e."ID_RSSD" = t."ID_RSSD" 
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" LIKE '%Insured%' 
AND t."DATE" = '2022-12-31' 
ORDER BY "UNINSURED_PERCENTAGE" DESC 
LIMIT 10;
```
[Corrected other sqls]
2025-07-01 04:57:45 - Thread-915 (execute) - INFO - [Successfully corrected]
Successfully executed. SQL:
-- Description: Start by checking which variables correspond to '% Insured (Estimated)' in the FDIC-related attributes table to identify the applicable variable identifier.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES"
WHERE "VARIABLE_NAME" ILIKE '%Insured%Estimated%' 
LIMIT 20;
Results:
VARIABLE,VARIABLE_NAME
INSBRDD,Demand Deposits in Insured Branches in Puerto Rico and US Territories & Possessions
INSBRTS,Time and Savings Deposits in Insured Branches in Puerto Rico and US Territories & Possessions

[Successfully corrected]
2025-07-01 04:57:45 - Thread-915 (execute) - INFO - [Try to execute]
-- Description: Verify the variable identifier by broadening the search to include any variable names containing the keyword 'Insured' to confirm its measurement type and frequency, ensuring it's suitable for quarterly data.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME", "MEASUREMENT_TYPE", "FREQUENCY" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES"
WHERE "VARIABLE_NAME" LIKE '%Insured%'
LIMIT 20;
[Try to execute]
2025-07-01 04:57:45 - Thread-915 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Verify the variable identifier by broadening the search to include any variable names containing the keyword 'Insured' to confirm its measurement type and frequency, ensuring it's suitable for quarterly data.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME", "MEASUREMENT_TYPE", "FREQUENCY" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES"
WHERE "VARIABLE_NAME" LIKE '%Insured%'
LIMIT 20;
Results:
VARIABLE,VARIABLE_NAME,MEASUREMENT_TYPE,FREQUENCY
INSBRDD,Demand Deposits in Insured Branches in Puerto Rico and US Territories & Possessions,Institution,Annual
INSBRTS,Time and Savings Deposits in Insured Branches in Puerto Rico and US Territories & Possessions,Institution,Annual

[Successfully executed]
2025-07-01 04:57:45 - Thread-915 (execute) - INFO - [Try to execute]
-- Description: Retrieve all active banks with assets exceeding $10 billion as of December 31, 2022, ensuring a comprehensive search for large banks. The '%Assets%' condition is retained since it does not involve overly specific keywords.
SELECT DISTINCT e."NAME", e."FDIC_CERT", e."ID_RSSD", t."VALUE", t."DATE", t."VARIABLE_NAME" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e 
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t 
ON e."ID_RSSD" = t."ID_RSSD" 
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" LIKE '%Assets%' 
AND t."DATE" = '2022-12-31' 
AND t."VALUE" > 10000000000 
LIMIT 20;
[Try to execute]
2025-07-01 04:57:48 - Thread-915 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Retrieve all active banks with assets exceeding $10 billion as of December 31, 2022, ensuring a comprehensive search for large banks. The '%Assets%' condition is retained since it does not involve overly specific keywords.
SELECT DISTINCT e."NAME", e."FDIC_CERT", e."ID_RSSD", t."VALUE", t."DATE", t."VARIABLE_NAME" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e 
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t 
ON e."ID_RSSD" = t."ID_RSSD" 
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" LIKE '%Assets%' 
AND t."DATE" = '2022-12-31' 
AND t."VALUE" > 10000000000 
LIMIT 20;
Results:
NAME,FDIC_CERT,ID_RSSD,VALUE,DATE,VARIABLE_NAME
The Bank of New York Mellon,639,541101,129233000000.00000000000,2022-12-31,Total Risk Weighted Assets Adjusted
"Pacific Premier Bank, National Association",32172,431172,12787040000.00000000000,2022-12-31,Long-Term Assets (5+ Years)
USAA Federal Savings Bank,32188,619877,107744034800.00000000000,2022-12-31,Average Earning Assets
Customers Bank,34444,2354985,20619362000.00000000000,2022-12-31,"Average Assets, Quarterly"

[Successfully executed]
2025-07-01 04:57:48 - Thread-915 (execute) - INFO - [Try to execute]
-- Description: Broaden the search to retrieve the percentage of insured deposits for active banks with assets > $10 billion as of December 31, 2022, by focusing on variables containing 'Insured.'
SELECT DISTINCT e."NAME", e."FDIC_CERT", e."ID_RSSD", t."VALUE" AS "PERCENT_INSURED", t."DATE", t."VARIABLE_NAME" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e 
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t 
ON e."ID_RSSD" = t."ID_RSSD" 
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" LIKE '%Insured%' 
AND t."DATE" = '2022-12-31' 
AND t."VALUE" IS NOT NULL 
LIMIT 20;
[Try to execute]
2025-07-01 04:57:52 - Thread-915 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Broaden the search to retrieve the percentage of insured deposits for active banks with assets > $10 billion as of December 31, 2022, by focusing on variables containing 'Insured.'
SELECT DISTINCT e."NAME", e."FDIC_CERT", e."ID_RSSD", t."VALUE" AS "PERCENT_INSURED", t."DATE", t."VARIABLE_NAME" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e 
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t 
ON e."ID_RSSD" = t."ID_RSSD" 
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" LIKE '%Insured%' 
AND t."DATE" = '2022-12-31' 
AND t."VALUE" IS NOT NULL 
LIMIT 20;
Results:
NAME,FDIC_CERT,ID_RSSD,PERCENT_INSURED,DATE,VARIABLE_NAME
The Culbertson Bank,17589,1011852,10469000.00000000000,2022-12-31,Estimated Insured Deposits
Latimer State Bank,22839,51356,0E-11,2022-12-31,% Insured (Estimated) Ratio to Assets
Chelsea Groton Bank,18238,345309,822708000.00000000000,2022-12-31,Estimated Insured Deposits
"Patrons Bank, National Association",4170,634955,0.75159290000,2022-12-31,% Insured (Estimated)

[Successfully executed]
2025-07-01 04:57:52 - Thread-915 (execute) - INFO - [Try to execute]
-- Description: Investigate variables for uninsured assets percentage computation by searching for broader keywords like '%Insured%' or '%Uninsured%'.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME", "UNIT", "DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" 
WHERE "VARIABLE_NAME" LIKE '%Insured%' OR "VARIABLE_NAME" LIKE '%Uninsured%' 
LIMIT 20;
[Try to execute]
2025-07-01 04:57:54 - Thread-915 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Investigate variables for uninsured assets percentage computation by searching for broader keywords like '%Insured%' or '%Uninsured%'.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME", "UNIT", "DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" 
WHERE "VARIABLE_NAME" LIKE '%Insured%' OR "VARIABLE_NAME" LIKE '%Uninsured%' 
LIMIT 20;
Results:
VARIABLE,VARIABLE_NAME,UNIT,DATE
BROINS,Fully Insured Brokered Deposits,USD,2021-12-31
IBA,Insured offices of foreign banks,Percent,2008-09-30
BROINS,Fully Insured Brokered Deposits,USD,1989-03-31
ESTINS,% Insured (Estimated),Percent,1988-06-30
DEPINSR,Estimated Insured Deposits,Percent,1988-12-31
IBA,Insured offices of foreign banks,Percent,2008-06-30
DEPINSR,Estimated Insured Deposits,Percent,2008-09-30

[Successfully executed]
2025-07-01 04:57:54 - Thread-915 (execute) - INFO - [Try to execute]
-- Description: Compute top banks by uninsured asset percentages, now using broadened criteria ('%Insured%') to avoid overly specific filters and increase matching possibilities.
SELECT e."NAME", 
       e."FDIC_CERT", 
       e."ID_RSSD", 
       1 - t."VALUE" AS "UNINSURED_PERCENTAGE", 
       t."DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e 
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t 
ON e."ID_RSSD" = t."ID_RSSD" 
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" LIKE '%Insured%' 
AND t."DATE" = '2022-12-31' 
ORDER BY "UNINSURED_PERCENTAGE" DESC 
LIMIT 20;
[Try to execute]
2025-07-01 04:57:57 - Thread-915 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Compute top banks by uninsured asset percentages, now using broadened criteria ('%Insured%') to avoid overly specific filters and increase matching possibilities.
SELECT e."NAME", 
       e."FDIC_CERT", 
       e."ID_RSSD", 
       1 - t."VALUE" AS "UNINSURED_PERCENTAGE", 
       t."DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e 
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t 
ON e."ID_RSSD" = t."ID_RSSD" 
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" LIKE '%Insured%' 
AND t."DATE" = '2022-12-31' 
ORDER BY "UNINSURED_PERCENTAGE" DESC 
LIMIT 20;
Results:
NAME,FDIC_CERT,ID_RSSD,UNINSURED_PERCENTAGE,DATE
"American Exchange Bank, Lindsay, Oklahoma",2328,826451,1.00000000000,2022-12-31
The Culbertson Bank,17589,1011852,1.00000000000,2022-12-31
"American Exchange Bank, Lindsay, Oklahoma",2328,826451,1.00000000000,2022-12-31
Huntingdon Savings Bank,30031,646471,1.00000000000,2022-12-31
Hart County Bank and Trust Company,10145,456344,1.00000000000,2022-12-31

[Successfully executed]
2025-07-01 04:57:57 - Thread-915 (execute) - INFO - [Try to execute]
-- Description: Search for inconsistencies or missing data by focusing solely on variables containing the broadened keyword 'Uninsured'.
SELECT DISTINCT "ID_RSSD", "VARIABLE_NAME", "VALUE", "DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" 
WHERE "VARIABLE_NAME" LIKE '%Uninsured%' 
AND "DATE" = '2022-12-31' 
LIMIT 20;
[Try to execute]
2025-07-01 04:58:00 - Thread-915 (execute) - INFO - [Error occurred]
No data found for the specified query.

[Error occurred]
2025-07-01 04:58:18 - Thread-915 (execute) - INFO - [Corrected SQL]
The initial query was too specific, targeting only variables containing "Uninsured," which resulted in no data being found. To address this, I'll broaden the query scope by focusing on the keyword "Insured," as it is likely related to the same context and may help identify relevant data. Retaining the specific date condition allows us to filter results for December 31, 2022, ensuring the data aligns with the required timeframe while increasing the chances of retrieving useful results.

```sql
-- Description: Broaden the query by searching for variables containing the keyword 'Insured' instead of 'Uninsured,' ensuring relevance to December 31, 2022, to find related data points.
SELECT DISTINCT "ID_RSSD", "VARIABLE_NAME", "VALUE", "DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" 
WHERE "VARIABLE_NAME" LIKE '%Insured%' 
AND "DATE" = '2022-12-31' 
LIMIT 20;
```
[Corrected SQL]
2025-07-01 04:58:22 - Thread-915 (execute) - INFO - [Results for corrected sql]
ID_RSSD,VARIABLE_NAME,VALUE,DATE
451273,% Insured (Estimated) Ratio to Assets,0E-11,2022-12-31
494261,% Insured (Estimated),0.49812670000,2022-12-31
700430,Fully Insured Brokered Deposits,3747000.00000000000,2022-12-31
571135,Estimated Insured Deposits,0.73812250000,2022-12-31
451273,Fully Insured Brokered Deposits,0E-11,2022-12-31
700430,% Insured (Estimated) Ratio to Assets,0E-11,2022-12-31

[Results for corrected sql]
2025-07-01 04:58:32 - Thread-915 (execute) - INFO - [Corrected other sqls]
```sql
-- Description: Simplify the query for retrieving related attributes by focusing solely on variables containing the keyword 'Insured' instead of also including 'Uninsured.' This ensures broader results from the financial institution attributes table.
SELECT DISTINCT "VARIABLE_NAME", "VARIABLE", "UNIT", "DEFINITION" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ATTRIBUTES" 
WHERE "VARIABLE_NAME" LIKE '%Insured%' 
LIMIT 20;
```

```sql
-- Description: Validate 'Insured' or 'Assets' variables in the financial institution timeseries table by focusing primarily on the keyword 'Insured' and keeping the 'Assets' condition unchanged. This ensures broader data exploration while maintaining relevance.
SELECT DISTINCT "ID_RSSD", "VARIABLE", "VARIABLE_NAME", "VALUE", "DATE", "UNIT" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" 
WHERE ("VARIABLE_NAME" LIKE '%Insured%' OR "VARIABLE_NAME" LIKE '%Assets%') 
AND "DATE" = '2022-12-31' 
LIMIT 20;
```

```sql
-- Description: Broaden the filtering for top banks by uninsured percentages by ensuring the query references variables related to 'Insured' deposits, avoiding restrictive conditions that limit broader data matching.
SELECT e."NAME", 
       e."FDIC_CERT", 
       ROUND(1 - t."VALUE", 4) AS "UNINSURED_PERCENTAGE", 
       t."DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e 
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t 
ON e."ID_RSSD" = t."ID_RSSD" 
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" LIKE '%Insured%' 
AND t."DATE" = '2022-12-31' 
ORDER BY "UNINSURED_PERCENTAGE" DESC 
LIMIT 10;
```
[Corrected other sqls]
2025-07-01 04:58:32 - Thread-915 (execute) - INFO - [Successfully corrected]
Successfully executed. SQL:
-- Description: Search for inconsistencies or missing data by focusing solely on variables containing the broadened keyword 'Uninsured'.
SELECT DISTINCT "ID_RSSD", "VARIABLE_NAME", "VALUE", "DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" 
WHERE "VARIABLE_NAME" LIKE '%Uninsured%' 
AND "DATE" = '2022-12-31' 
LIMIT 20;
Results:
ID_RSSD,VARIABLE_NAME,VALUE,DATE
451273,% Insured (Estimated) Ratio to Assets,0E-11,2022-12-31
494261,% Insured (Estimated),0.49812670000,2022-12-31
700430,Fully Insured Brokered Deposits,3747000.00000000000,2022-12-31
571135,Estimated Insured Deposits,0.73812250000,2022-12-31
451273,Fully Insured Brokered Deposits,0E-11,2022-12-31
700430,% Insured (Estimated) Ratio to Assets,0E-11,2022-12-31

[Successfully corrected]
2025-07-01 04:58:32 - Thread-915 (execute) - INFO - itercount: 0
2025-07-01 04:58:32 - Thread-915 (execute) - INFO - [Self-refine]
Table full name: FINANCE__ECONOMICS.CYBERSYN.FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES
Column name: VARIABLE_NAME Type: TEXT Description: Human-readable description of the financial data variables tracked by the FDIC.
Column name: UNIT Type: TEXT Description: Unit in which the measure is recorded (e.g., USD YTD).
Column name: MEASURE Type: TEXT Description: Quantifiable attribute being recorded (e.g., Domestic Deposits).
Column name: VARIABLE Type: TEXT Description: Unique FDIC identifier for tracked financial data.
Column name: MEASUREMENT_TYPE Type: TEXT Description: Classification indicating the level at which the variable is tracked by the FDIC, either at the "Institution" or "Branch" level.
Column name: FREQUENCY Type: TEXT Description: How often the data is aggregated (e.g., Annual).
Sample rows:
[{'VARIABLE_NAME': 'Institutional Assets', 'UNIT': 'USD', 'VARIABLE': 'ASSET', 'MEASUREMENT_TYPE': 'Institution', 'FREQUENCY': 'Annual'}, {'VARIABLE_NAME': 'Institutional Domestic Deposits', 'UNIT': 'USD', 'VARIABLE': 'DEPDOM', 'MEASUREMENT_TYPE': 'Institution', 'FREQUENCY': 'Annual'}, {'VARIABLE_NAME': 'Institutional Deposits', 'UNIT': 'USD', 'VARIABLE': 'DEPSUM', 'MEASUREMENT_TYPE': 'Institution', 'FREQUENCY': 'Annual'}, {'VARIABLE_NAME': 'Branch Deposits', 'UNIT': 'USD', 'VARIABLE': 'DEPSUMBR', 'MEASUREMENT_TYPE': 'Branch', 'FREQUENCY': 'Annual'}, {'VARIABLE_NAME': 'Escrow Deposits', 'UNIT': 'USD', 'VARIABLE': 'ESCROW', 'MEASUREMENT_TYPE': 'Institution', 'FREQUENCY': 'Annual'}]
--------------------------------------------------
Table full name: FINANCE__ECONOMICS.CYBERSYN.FINANCIAL_INSTITUTION_ENTITIES
Column name: NAME Type: TEXT Description: Name of the bank
Column name: NAICS_CODE Type: TEXT Description: NAICS code of the primary activity conducted by an entity.
Column name: FDIC_CERT Type: NUMBER Description: A unique identifier for the financial institution assigned by the FDIC
Column name: START_DATE Type: TIMESTAMP_NTZ Description: First date for which the bank was open
Column name: ENTITY_TYPE Type: TEXT Description: The institution grouping for the bank (National Bank, Non-member Bank, etc.)
Column name: IS_ACTIVE Type: BOOLEAN Description: Status of the bank to determine active or closed
Column name: ID_RSSD Type: NUMBER Description: A unique identifier assigned by the Federal Reserve for the financial institution
Column name: CATEGORY Type: TEXT Description: Category for the entity
Column name: CHARTER_TYPE Type: TEXT Description: The particular charter assigned to the bank (Industrial Bank, Commercial Bank, etc.)
Sample rows:
[{'NAME': 'First Capital Bank', 'NAICS_CODE': '52211', 'FDIC_CERT': 34966, 'START_DATE': '1999-09-27 00:00:00', 'ENTITY_TYPE': 'State Member Bank', 'IS_ACTIVE': True, 'ID_RSSD': 2849463, 'CATEGORY': 'Bank', 'CHARTER_TYPE': 'Commercial Bank'}, {'NAME': 'The Bank of Princeton', 'NAICS_CODE': '52211', 'FDIC_CERT': 58513, 'START_DATE': '2007-04-23 00:00:00', 'ENTITY_TYPE': 'Non-member Bank', 'IS_ACTIVE': True, 'ID_RSSD': 3595271, 'CATEGORY': 'Bank', 'CHARTER_TYPE': 'Commercial Bank'}, {'NAME': 'Lone Star National Bank', 'NAICS_CODE': '52211', 'FDIC_CERT': 24347, 'START_DATE': '1983-01-24 00:00:00', 'ENTITY_TYPE': 'National Bank', 'IS_ACTIVE': True, 'ID_RSSD': 842460, 'CATEGORY': 'Bank', 'CHARTER_TYPE': 'Commercial Bank'}, {'NAME': "Citizens' Bank, Inc.", 'NAICS_CODE': '52211', 'FDIC_CERT': 23523, 'START_DATE': '1981-09-08 00:00:00', 'ENTITY_TYPE': 'Non-member Bank', 'IS_ACTIVE': True, 'ID_RSSD': 563336, 'CATEGORY': 'Bank', 'CHARTER_TYPE': 'Commercial Bank'}, {'NAME': 'Miners & Merchants Bank', 'NAICS_CODE': '52211', 'FDIC_CERT': 13018, 'START_DATE': '1902-06-10 00:00:00', 'ENTITY_TYPE': 'Non-member Bank', 'IS_ACTIVE': True, 'ID_RSSD': 913436, 'CATEGORY': 'Bank', 'CHARTER_TYPE': 'Commercial Bank'}]
--------------------------------------------------
Table full name: FINANCE__ECONOMICS.CYBERSYN.FINANCIAL_INSTITUTION_TIMESERIES
Column name: VARIABLE Type: TEXT Description: Unique identifier for a variable joinable to the timeseries table
Column name: ID_RSSD Type: TEXT Description: A unique identifier assigned by the Federal Reserve for the financial institution
Column name: VALUE Type: NUMBER Description: Numeric value for the given data point
Column name: DATE Type: DATE Description: Date associated with the value
Column name: VARIABLE_NAME Type: TEXT Description: Human-readable name for the variable
Column name: UNIT Type: TEXT Description: Unit of measure for the value, examples (e.g., percentage, USD)
Sample rows:
[{'VARIABLE': 'P3OTHLNR', 'ID_RSSD': '582971', 'VALUE': '0E-11', 'DATE': '1991-09-30', 'VARIABLE_NAME': 'Other Loans, Past Due 30 - 89 Days', 'UNIT': 'Percent'}, {'VARIABLE': 'DRLNLSQR', 'ID_RSSD': '1005655', 'VALUE': '0.00020890000', 'DATE': '2008-06-30', 'VARIABLE_NAME': 'Total Charge-Offs', 'UNIT': 'Percent'}, {'VARIABLE': 'CRCINUSQR', 'ID_RSSD': '568470', 'VALUE': '0E-11', 'DATE': '2015-06-30', 'VARIABLE_NAME': 'To Non-U.S. Addressees', 'UNIT': 'Percent'}, {'VARIABLE': 'EQCCOMPI', 'ID_RSSD': '321170', 'VALUE': None, 'DATE': '1990-03-31', 'VARIABLE_NAME': 'Other Comprehensive Income', 'UNIT': 'USD'}, {'VARIABLE': 'DEPIDOMR', 'ID_RSSD': '21658', 'VALUE': '0.78737600000', 'DATE': '2008-12-31', 'VARIABLE_NAME': 'Interest-Bearing Deposits in Domestic Offices', 'UNIT': 'Percent'}]
--------------------------------------------------
Table full name: FINANCE__ECONOMICS.CYBERSYN.FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES
Column name: VALUE Type: NUMBER Description: Value reported for the variable.
Column name: DATE Type: DATE Description: Date associated with the value.
Column name: FDIC_INSTITUTION_ID Type: TEXT Description: Unique FDIC ID of the institution that owns the branch. It is a unique number, sequentially added to the FDIC database for both banks and branches. This ID is updated with every merger or purchase of branches to reflect the most current owner.
Column name: UNIT Type: TEXT Description: Unit in which the measure is recorded (e.g., USD YTD).
Column name: VARIABLE Type: TEXT Description: Unique FDIC identifier for tracked financial data.
Column name: FDIC_BRANCH_ID Type: TEXT Description: FDIC's unique number for the bank or savings institution assigned by the FDIC in order to identify and track. The branch ID for the Headquarters branch is the same as the branch ID for the entire bank or savings institution.
Column name: VARIABLE_NAME Type: TEXT Description: Human-readable description of the financial data variables tracked by the FDIC.
Sample rows:
[{'VALUE': 119632, 'DATE': '2023-06-30', 'FDIC_INSTITUTION_ID': '2239', 'UNIT': 'USD', 'VARIABLE': 'DEPSUMBR', 'FDIC_BRANCH_ID': '286466', 'VARIABLE_NAME': 'Branch Deposits'}, {'VALUE': 59230, 'DATE': '2017-06-30', 'FDIC_INSTITUTION_ID': '6499', 'UNIT': 'USD', 'VARIABLE': 'DEPSUMBR', 'FDIC_BRANCH_ID': '6499', 'VARIABLE_NAME': 'Branch Deposits'}, {'VALUE': 35943, 'DATE': '2014-06-30', 'FDIC_INSTITUTION_ID': '417', 'UNIT': 'USD', 'VARIABLE': 'DEPSUMBR', 'FDIC_BRANCH_ID': '481396', 'VARIABLE_NAME': 'Branch Deposits'}, {'VALUE': 85928, 'DATE': '2016-06-30', 'FDIC_INSTITUTION_ID': '3123', 'UNIT': 'USD', 'VARIABLE': 'DEPSUMBR', 'FDIC_BRANCH_ID': '203999', 'VARIABLE_NAME': 'Branch Deposits'}, {'VALUE': 133714, 'DATE': '2007-06-30', 'FDIC_INSTITUTION_ID': '745', 'UNIT': 'USD', 'VARIABLE': 'ASSET', 'FDIC_BRANCH_ID': '745', 'VARIABLE_NAME': 'Institutional Assets'}]
--------------------------------------------------
Table full name: FINANCE__ECONOMICS.CYBERSYN.FINANCIAL_INSTITUTION_ATTRIBUTES
Column name: UNIT Type: TEXT Description: Unit of measure for the value, examples (e.g., percentage, USD)
Column name: DEFINITION Type: TEXT Description: Detailed description of the variable including calculation where applicable
Column name: VARIABLE Type: TEXT Description: Unique identifier for a variable joinable to the timeseries table
Column name: VARIABLE_NAME Type: TEXT Description: Human-readable name for the variable
Column name: FREQUENCY Type: TEXT Description: Measurement period (e.g., Annual, Quarterly)
Sample rows:
[{'UNIT': 'Percent', 'DEFINITION': 'Retained earnings from bank operations, net unrealized holding gains (losses) on available-for-sale securities, and cumulative foreign currency translation adjustments.', 'VARIABLE': 'EQUP', 'VARIABLE_NAME': 'Undivided Profits', 'FREQUENCY': 'Quarterly'}, {'UNIT': 'Percent', 'DEFINITION': 'Loan and lease financing receivables, net of unearned income, allowances, and reserves, as a percent of total assets.', 'VARIABLE': 'LNLSNTV', 'VARIABLE_NAME': 'Net Loans and Leases to Assets', 'FREQUENCY': 'YTD'}, {'UNIT': 'Percent', 'DEFINITION': 'Net amount of loans secured by junior liens on 1-4 family residential properties (which are held in domestic offices) that have been charged-off and debited to the allowance for loan and lease losses established by the institution. Prior to 2004, this item is not available for TFR Reporters . Calculated as NTRERSF2 / ASSET5', 'VARIABLE': 'NTRERSF2R', 'VARIABLE_NAME': 'Secured By Junior Liens', 'FREQUENCY': 'YTD'}, {'UNIT': 'USD', 'DEFINITION': 'That portion of financial standby letters of credit, foreign office guarantees, performance standby letters of credit, and foreign office guarantees (including cash collateral standby letters of credit) conveyed to others.', 'VARIABLE': 'LOCFPSBK', 'VARIABLE_NAME': 'Standby Letters of Credit Amount Conveyed To Others', 'FREQUENCY': 'YTD'}, {'UNIT': 'USD', 'DEFINITION': 'Loan Loss Allowance Included in Tier 2 Capital', 'VARIABLE': 'RB2LNRES', 'VARIABLE_NAME': 'Loan Loss Allowance Included in Tier 2 Capital', 'FREQUENCY': 'YTD'}]
--------------------------------------------------
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'FINANCE__ECONOMICS': {'CYBERSYN': ['FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES', 'FINANCIAL_INSTITUTION_ENTITIES', 'FINANCIAL_INSTITUTION_TIMESERIES', 'FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES', 'FINANCIAL_INSTITUTION_ATTRIBUTES']}}

Some few-shot examples after column exploration may be helpful:
Query:
-- Description: Verify the variable identifier by broadening the search to include any variable names containing the keyword 'Insured' to confirm its measurement type and frequency, ensuring it's suitable for quarterly data.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME", "MEASUREMENT_TYPE", "FREQUENCY" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES"
WHERE "VARIABLE_NAME" LIKE '%Insured%'
LIMIT 20;
Answer:
VARIABLE,VARIABLE_NAME,MEASUREMENT_TYPE,FREQUENCY
INSBRDD,Demand Deposits in Insured Branches in Puerto Rico and US Territories & Possessions,Institution,Annual
INSBRTS,Time and Savings Deposits in Insured Branches in Puerto Rico and US Territories & Possessions,Institution,Annual
Query:
-- Description: Retrieve all active banks with assets exceeding $10 billion as of December 31, 2022, ensuring a comprehensive search for large banks. The '%Assets%' condition is retained since it does not involve overly specific keywords.
SELECT DISTINCT e."NAME", e."FDIC_CERT", e."ID_RSSD", t."VALUE", t."DATE", t."VARIABLE_NAME" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e 
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t 
ON e."ID_RSSD" = t."ID_RSSD" 
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" LIKE '%Assets%' 
AND t."DATE" = '2022-12-31' 
AND t."VALUE" > 10000000000 
LIMIT 20;
Answer:
NAME,FDIC_CERT,ID_RSSD,VALUE,DATE,VARIABLE_NAME
The Bank of New York Mellon,639,541101,129233000000.00000000000,2022-12-31,Total Risk Weighted Assets Adjusted
"Pacific Premier Bank, National Association",32172,431172,12787040000.00000000000,2022-12-31,Long-Term Assets (5+ Years)
USAA Federal Savings Bank,32188,619877,107744034800.00000000000,2022-12-31,Average Earning Assets
Customers Bank,34444,2354985,20619362000.00000000000,2022-12-31,"Average Assets, Quarterly"
Query:
-- Description: Broaden the search to retrieve the percentage of insured deposits for active banks with assets > $10 billion as of December 31, 2022, by focusing on variables containing 'Insured.'
SELECT DISTINCT e."NAME", e."FDIC_CERT", e."ID_RSSD", t."VALUE" AS "PERCENT_INSURED", t."DATE", t."VARIABLE_NAME" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e 
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t 
ON e."ID_RSSD" = t."ID_RSSD" 
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" LIKE '%Insured%' 
AND t."DATE" = '2022-12-31' 
AND t."VALUE" IS NOT NULL 
LIMIT 20;
Answer:
NAME,FDIC_CERT,ID_RSSD,PERCENT_INSURED,DATE,VARIABLE_NAME
The Culbertson Bank,17589,1011852,10469000.00000000000,2022-12-31,Estimated Insured Deposits
Latimer State Bank,22839,51356,0E-11,2022-12-31,% Insured (Estimated) Ratio to Assets
Chelsea Groton Bank,18238,345309,822708000.00000000000,2022-12-31,Estimated Insured Deposits
"Patrons Bank, National Association",4170,634955,0.75159290000,2022-12-31,% Insured (Estimated)
Query:
-- Description: Investigate variables for uninsured assets percentage computation by searching for broader keywords like '%Insured%' or '%Uninsured%'.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME", "UNIT", "DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" 
WHERE "VARIABLE_NAME" LIKE '%Insured%' OR "VARIABLE_NAME" LIKE '%Uninsured%' 
LIMIT 20;
Answer:
VARIABLE,VARIABLE_NAME,UNIT,DATE
BROINS,Fully Insured Brokered Deposits,USD,2021-12-31
IBA,Insured offices of foreign banks,Percent,2008-09-30
BROINS,Fully Insured Brokered Deposits,USD,1989-03-31
ESTINS,% Insured (Estimated),Percent,1988-06-30
DEPINSR,Estimated Insured Deposits,Percent,1988-12-31
IBA,Insured offices of foreign banks,Percent,2008-06-30
DEPINSR,Estimated Insured Deposits,Percent,2008-09-30
Query:
-- Description: Compute top banks by uninsured asset percentages, now using broadened criteria ('%Insured%') to avoid overly specific filters and increase matching possibilities.
SELECT e."NAME", 
       e."FDIC_CERT", 
       e."ID_RSSD", 
       1 - t."VALUE" AS "UNINSURED_PERCENTAGE", 
       t."DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e 
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t 
ON e."ID_RSSD" = t."ID_RSSD" 
WHERE e."IS_ACTIVE" = TRUE 
AND t."VARIABLE_NAME" LIKE '%Insured%' 
AND t."DATE" = '2022-12-31' 
ORDER BY "UNINSURED_PERCENTAGE" DESC 
LIMIT 20;
Answer:
NAME,FDIC_CERT,ID_RSSD,UNINSURED_PERCENTAGE,DATE
"American Exchange Bank, Lindsay, Oklahoma",2328,826451,1.00000000000,2022-12-31
The Culbertson Bank,17589,1011852,1.00000000000,2022-12-31
"American Exchange Bank, Lindsay, Oklahoma",2328,826451,1.00000000000,2022-12-31
Huntingdon Savings Bank,30031,646471,1.00000000000,2022-12-31
Hart County Bank and Trust Company,10145,456344,1.00000000000,2022-12-31
Task: As of December 31, 2022, list the top 10 active banks with assets exceeding $10 billion, ranked by the highest percentage of uninsured assets, where the percentage is calculated as one minus the value of the '% Insured (Estimated)' variable from quarterly estimates. Provide the names of these banks and their respective percentages of uninsured assets.
Another way to say it: As of December 31, 2022, list the top 10 active large banks, each with assets over $10 billion, that have the highest percentage of uninsured assets based on quarterly estimates. Provide the names of these banks and their respective percentages of uninsured assets.

Please think step by step and answer only one complete SQL in snowflake dialect in ```sql``` format.
SQL usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'FINANCE__ECONOMICS': {'CYBERSYN': ['FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES', 'FINANCIAL_INSTITUTION_ENTITIES', 'FINANCIAL_INSTITUTION_TIMESERIES', 'FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES', 'FINANCIAL_INSTITUTION_ATTRIBUTES']}}

When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When asked something without stating name or id, return both of them. e.g. Which products ...? The answer should include product_name and product_id.
When asked percentage decrease, you should return a positive value. e.g. How many percentage points in 2021 decrease compared to ...? The answer should be a positive value indicating the decresed number. Try to use ABS().
If asked two tables, you should reply with the last one instead of combining two tables. e.g. Identifying the top five states ... examine the state that ranks fourth overall and identify its top five counties. You should only answer top five counties.
Use ST_DISTANCE to calculate distance between two geographic points for more accurate answer.
If the task description does not specify the number of decimal places, retain all decimals to four places.

[Self-refine]
2025-07-01 04:58:51 - Thread-915 (execute) - INFO - [Try to run SQL in self-refine]
```sql
SELECT e."NAME", 
       e."FDIC_CERT", 
       e."ID_RSSD", 
       1 - t."VALUE" AS "UNINSURED_PERCENTAGE", 
       t."DATE" 
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e 
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t 
ON e."ID_RSSD" = t."ID_RSSD" 
WHERE e."IS_ACTIVE" = TRUE 
  AND t."VARIABLE_NAME" = '% Insured (Estimated)' 
  AND t."DATE" = '2022-12-31' 
  AND e."ID_RSSD" IN (
      SELECT DISTINCT "ID_RSSD" 
      FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" 
      WHERE "VARIABLE_NAME" LIKE '%Assets%' 
        AND "DATE" = '2022-12-31' 
        AND "VALUE" > 10000000000
  )
ORDER BY "UNINSURED_PERCENTAGE" DESC NULLS LAST 
LIMIT 10;
```
[Try to run SQL in self-refine]
2025-07-01 04:58:55 - Thread-915 (execute) - INFO - Total iteration counts: 0
