2025-07-01 04:57:04 - Thread-920 (execute) - INFO - [Exploration]
```sql
-- Description: Fetch distinct variable identifiers along with their descriptions to identify the variable related to '% Insured (Estimated)' from the FINANCIAL_INSTITUTION_ATTRIBUTES table.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ATTRIBUTES"
LIMIT 20;
```

```sql
-- Description: Fetch distinct variable identifiers and their descriptions to confirm those available in the quarterly estimates as related to assets exceeding $10 billion.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME", "FREQUENCY"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ATTRIBUTES"
WHERE "VARIABLE_NAME" ILIKE '%asset%' OR "VARIABLE_NAME" ILIKE '%insured%'
LIMIT 20;
```

```sql
-- Description: Retrieve values from FINANCIAL_INSTITUTION_TIMESERIES to inspect the values for a potential '% Insured (Estimated)' variable based on previous queries.
SELECT DISTINCT "VARIABLE", "DATE", "VALUE", "UNIT"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE" = '<replace_with_identifier_for_percent_insured>'
AND "DATE" = '2022-12-31'
LIMIT 20;
```

```sql
-- Description: Retrieve data from FINANCIAL_INSTITUTION_ENTITIES to identify active banks with assets over $10 billion as of December 31, 2022.
SELECT DISTINCT "NAME", "FDIC_CERT", "ENTITY_TYPE", "IS_ACTIVE", "NAICS_CODE"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES"
WHERE "IS_ACTIVE" = TRUE
LIMIT 20;
```

```sql
-- Description: Fetch institution-level asset values as of December 31, 2022, for filtering banks with assets exceeding $10 billion.
SELECT DISTINCT "VARIABLE", "ID_RSSD", "VALUE", "DATE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%asset%'
AND "DATE" = '2022-12-31'
AND CAST("VALUE" AS FLOAT) > 10000000000
LIMIT 20;
```

```sql
-- Description: Combine institution IDs and assets with active banks for filtering purposes; this ensures we target banks with assets over $10 billion as of December 31, 2022.
SELECT DISTINCT t1."NAME", t1."FDIC_CERT", t2."ID_RSSD", t2."VALUE" AS "ASSETS", t2."VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
AND t2."DATE" = '2022-12-31'
AND CAST(t2."VALUE" AS FLOAT) > 10000000000
LIMIT 20;
```

```sql
-- Description: Fetch values for '% Insured (Estimated)' variable and calculate (1 - % insured) as the percentage of uninsured assets for active banks with assets over $10 billion.
-- Replace '<replace_with_identifier_for_percent_insured>' with the correct variable identifier for '% Insured (Estimated)'.
SELECT t1."NAME", t1."FDIC_CERT", t2."VALUE" AS "ASSETS", t3."VALUE" AS "PERCENT_INSURED", 
       (1 - CAST(t3."VALUE" AS FLOAT)) * 100 AS "PERCENT_UNINSURED"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
ON CAST(t1."ID_RSSD" AS TEXT) = t3."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
AND t2."DATE" = '2022-12-31'
AND CAST(t2."VALUE" AS FLOAT) > 10000000000
AND t3."VARIABLE" = '<replace_with_identifier_for_percent_insured>'
AND t3."DATE" = '2022-12-31'
LIMIT 20;
```

```sql
-- Description: Rank the top 10 banks based on the percentage of uninsured assets calculated above.
-- Replace '<replace_with_identifier_for_percent_insured>' with the correct variable identifier for '% Insured (Estimated)'.
SELECT t1."NAME", t1."FDIC_CERT", 
       (1 - CAST(t3."VALUE" AS FLOAT)) * 100 AS "PERCENT_UNINSURED", 
       ROW_NUMBER() OVER (ORDER BY (1 - CAST(t3."VALUE" AS FLOAT)) DESC) AS "RANK"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
ON CAST(t1."ID_RSSD" AS TEXT) = t3."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
AND t2."DATE" = '2022-12-31'
AND CAST(t2."VALUE" AS FLOAT) > 10000000000
AND t3."VARIABLE" = '<replace_with_identifier_for_percent_insured>'
AND t3."DATE" = '2022-12-31'
QUALIFY "RANK" <= 10;
```

```sql
-- Description: Final query to list the top 10 active banks with assets exceeding $10 billion as of December 31, 2022, along with their percentages of uninsured assets.
-- This assumes the previous queries identified the correct variable for '% Insured (Estimated)'.
SELECT t1."NAME", (1 - CAST(t3."VALUE" AS FLOAT)) * 100 AS "PERCENT_UNINSURED"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
ON CAST(t1."ID_RSSD" AS TEXT) = t3."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
AND t2."DATE" = '2022-12-31'
AND CAST(t2."VALUE" AS FLOAT) > 10000000000
AND t3."VARIABLE" = '<replace_with_identifier_for_percent_insured>'
AND t3."DATE" = '2022-12-31'
ORDER BY "PERCENT_UNINSURED" DESC
LIMIT 10;
``` 
[Exploration]
2025-07-01 04:57:04 - Thread-920 (execute) - INFO - [Try to execute]
-- Description: Fetch distinct variable identifiers along with their descriptions to identify the variable related to '% Insured (Estimated)' from the FINANCIAL_INSTITUTION_ATTRIBUTES table.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ATTRIBUTES"
LIMIT 20;
[Try to execute]
2025-07-01 04:57:05 - Thread-920 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Fetch distinct variable identifiers along with their descriptions to identify the variable related to '% Insured (Estimated)' from the FINANCIAL_INSTITUTION_ATTRIBUTES table.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ATTRIBUTES"
LIMIT 20;
Results:
VARIABLE,VARIABLE_NAME
EQUP,Undivided Profits
PPPLFOV1,Outstanding balance under the PPPLF with a remaining maturity of more than one year
NTGLFXAQR,Net Gains (Losses) on Sales of Other Assets (Excluding Securities)
NTRERESR,1-4 Family Residential
SCO3YLESR,Other Mortgage-Backed Securities Expected Average Life: Three Years Or Less
SZDRCIR,"Charge-offs, C&I Loans Securitized by Bank"
P9CI,"Commercial and Industrial Loans, Past Due 90+ Days"
LNLSNTV,Net Loans and Leases to Assets

[Successfully executed]
2025-07-01 04:57:05 - Thread-920 (execute) - INFO - [Try to execute]
-- Description: Fetch distinct variable identifiers and their descriptions to confirm those available in the quarterly estimates as related to assets exceeding $10 billion.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME", "FREQUENCY"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ATTRIBUTES"
WHERE "VARIABLE_NAME" ILIKE '%asset%' OR "VARIABLE_NAME" ILIKE '%insured%'
LIMIT 20;
[Try to execute]
2025-07-01 04:57:05 - Thread-920 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Fetch distinct variable identifiers and their descriptions to confirm those available in the quarterly estimates as related to assets exceeding $10 billion.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME", "FREQUENCY"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ATTRIBUTES"
WHERE "VARIABLE_NAME" ILIKE '%asset%' OR "VARIABLE_NAME" ILIKE '%insured%'
LIMIT 20;
Results:
VARIABLE,VARIABLE_NAME,FREQUENCY
NTGLFXAQR,Net Gains (Losses) on Sales of Other Assets (Excluding Securities),Quarterly
LNLSNTV,Net Loans and Leases to Assets,YTD
TIMNMNUM,"# of investment Management and Advisory Agency Accounts, Non-Managed Assets",YTD
ASSET5,Average Total Assets,YTD
TOFMA,"Other Fiduciary Accounts, Managed Assets",YTD
DEPINSR,Estimated Insured Deposits,YTD
TORNMA,"Other Retirement Accounts, Non-Managed Assets",YTD
NASCDEBT,Debt Securities and Other Assets in Nonaccrual

[Successfully executed]
2025-07-01 04:57:05 - Thread-920 (execute) - INFO - [Try to execute]
-- Description: Retrieve values from FINANCIAL_INSTITUTION_TIMESERIES to inspect the values for a potential '% Insured (Estimated)' variable based on previous queries.
SELECT DISTINCT "VARIABLE", "DATE", "VALUE", "UNIT"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE" = '<replace_with_identifier_for_percent_insured>'
AND "DATE" = '2022-12-31'
LIMIT 20;
[Try to execute]
2025-07-01 04:57:06 - Thread-920 (execute) - INFO - [Error occurred]
No data found for the specified query.

[Error occurred]
2025-07-01 04:57:23 - Thread-920 (execute) - INFO - [Corrected SQL]
To understand why the previous query yielded no data, we might have incorrectly assumed the variable identifier for "% Insured (Estimated)." Therefore, we need to verify if such a variable exists in the dataset. Rather than searching for data tied to a specific variable or date, our next logical step is to identify all the variables and their respective descriptions (`VARIABLE_NAME`). This will allow us to inspect the dataset for plausible fields related to "% Insured (Estimated)" and guide us toward determining the correct identifier for use in subsequent queries.

Here is the SQL:

```sql
-- Description: Retrieve distinct variable identifiers and their descriptions from FINANCIAL_INSTITUTION_ATTRIBUTES to explore possible candidates for '% Insured (Estimated)'.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME", "DEFINITION"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ATTRIBUTES"
LIMIT 20;
```
[Corrected SQL]
2025-07-01 04:57:23 - Thread-920 (execute) - INFO - [Results for corrected sql]
VARIABLE,VARIABLE_NAME,DEFINITION
EQUP,Undivided Profits,"Retained earnings from bank operations, net unrealized holding gains (losses) on available-for-sale securities, and cumulative foreign currency translation adjustments."
PPPLFOV1,Outstanding balance under the PPPLF with a remaining maturity of more than one year,"The outstanding amount as of the report date of borrowings by the reporting institution from a Federal Reserve Bank under the PPPLF with a remaining maturity of more than one y

[Results for corrected sql]
2025-07-01 04:57:45 - Thread-920 (execute) - INFO - [Corrected other sqls]
```sql
-- Description: Retrieve data from FINANCIAL_INSTITUTION_ENTITIES to identify active banks by checking their status, regardless of asset size or specific date.
SELECT DISTINCT "NAME", "FDIC_CERT", "ENTITY_TYPE", "IS_ACTIVE", "NAICS_CODE"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES"
LIMIT 20;
```

```sql
-- Description: Fetch institution-level asset values over time without date restrictions to explore patterns for filtering banks with potentially large assets.
SELECT DISTINCT "VARIABLE", "ID_RSSD", "VALUE", "DATE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
```

```sql
-- Description: Combine institution IDs with asset data and active status without specific date conditions to ensure broader results for investigation.
SELECT DISTINCT t1."NAME", t1."FDIC_CERT", t2."ID_RSSD", t2."VALUE" AS "ASSETS", t2."VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
```

```sql
-- Description: Fetch available data for the uninsured percentage calculation without relying on a specific variable identifier, expanding the scope for relevant data exploration.
SELECT DISTINCT t1."NAME", t1."FDIC_CERT", t2."VALUE" AS "ASSETS", t3."VALUE" AS "PERCENT_INSURED"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
ON CAST(t1."ID_RSSD" AS TEXT) = t3."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
```

```sql
-- Description: Rank active banks based on available data for uninsured percentage without a strict reliance on a specific variable for '% Insured (Estimated)' or a specific date.
SELECT t1."NAME", t1."FDIC_CERT", 
       ROW_NUMBER() OVER (ORDER BY t2."VALUE" DESC) AS "RANK"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 10;
```

```sql
-- Description: Retrieve the names of active banks with available data for uninsured percentages, ranked without a strict reliance on a specific variable or specific date.
SELECT t1."NAME", t3."VALUE" AS "PERCENT_INSURED"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
ON CAST(t1."ID_RSSD" AS TEXT) = t3."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 10;
```
[Corrected other sqls]
2025-07-01 04:57:45 - Thread-920 (execute) - INFO - [Successfully corrected]
Successfully executed. SQL:
-- Description: Retrieve values from FINANCIAL_INSTITUTION_TIMESERIES to inspect the values for a potential '% Insured (Estimated)' variable based on previous queries.
SELECT DISTINCT "VARIABLE", "DATE", "VALUE", "UNIT"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE" = '<replace_with_identifier_for_percent_insured>'
AND "DATE" = '2022-12-31'
LIMIT 20;
Results:
VARIABLE,VARIABLE_NAME,DEFINITION
EQUP,Undivided Profits,"Retained earnings from bank operations, net unrealized holding gains (losses) on available-for-sale securities, and cumulative foreign currency translation adjustments."
PPPLFOV1,Outstanding balance under the PPPLF with a remaining maturity of more than one year,"The outstanding amount as of the report date of borrowings by the reporting institution from a Federal Reserve Bank under the PPPLF with a remaining maturity of more than one y

[Successfully corrected]
2025-07-01 04:57:45 - Thread-920 (execute) - INFO - [Try to execute]
-- Description: Retrieve data from FINANCIAL_INSTITUTION_ENTITIES to identify active banks by checking their status, regardless of asset size or specific date.
SELECT DISTINCT "NAME", "FDIC_CERT", "ENTITY_TYPE", "IS_ACTIVE", "NAICS_CODE"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES"
LIMIT 20;
[Try to execute]
2025-07-01 04:57:45 - Thread-920 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Retrieve data from FINANCIAL_INSTITUTION_ENTITIES to identify active banks by checking their status, regardless of asset size or specific date.
SELECT DISTINCT "NAME", "FDIC_CERT", "ENTITY_TYPE", "IS_ACTIVE", "NAICS_CODE"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES"
LIMIT 20;
Results:
NAME,FDIC_CERT,ENTITY_TYPE,IS_ACTIVE,NAICS_CODE
"BankPacific, Ltd",30692,Non-member Bank,True,52211
Holladay Bank & Trust,21448,Non-member Bank,True,52211
The Peoples Bank of the Virgin Islands,20465,Non-member Bank,False,52211
Deposit Insurance National Bank of Louisville,59059,National Bank,False,52211
Bank of Hackleburg,1731,Non-member Bank,False,52211
Johnson County Bank,11484,State Member Bank,False,52211
Hart County Bank and Trust Company,10145,Non-member Bank,True,52211

[Successfully executed]
2025-07-01 04:57:45 - Thread-920 (execute) - INFO - [Try to execute]
-- Description: Fetch institution-level asset values over time without date restrictions to explore patterns for filtering banks with potentially large assets.
SELECT DISTINCT "VARIABLE", "ID_RSSD", "VALUE", "DATE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
[Try to execute]
2025-07-01 04:57:46 - Thread-920 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Fetch institution-level asset values over time without date restrictions to explore patterns for filtering banks with potentially large assets.
SELECT DISTINCT "VARIABLE", "ID_RSSD", "VALUE", "DATE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
Results:
VARIABLE,ID_RSSD,VALUE,DATE,VARIABLE_NAME
ASCEOTH,50461,0E-11,2001-09-30,"Maximum Amount of Credit Exposure, Bank Asset Sales All Other Loans &  All Leases"
AVASSETJ,50461,72411000.00000000000,2001-09-30,Adjusted Average Assets for Leverage Capital Purposes
ASTEMPM,50461,0.02884920000,2001-09-30,Assets Per Employee ($Millions)
AVASSETJR,50461,1.00399320000,2001-09-30,Adjusted Average Assets for Leverage Capital Purposes

[Successfully executed]
2025-07-01 04:57:46 - Thread-920 (execute) - INFO - [Try to execute]
-- Description: Combine institution IDs with asset data and active status without specific date conditions to ensure broader results for investigation.
SELECT DISTINCT t1."NAME", t1."FDIC_CERT", t2."ID_RSSD", t2."VALUE" AS "ASSETS", t2."VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
[Try to execute]
2025-07-01 04:57:55 - Thread-920 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Combine institution IDs with asset data and active status without specific date conditions to ensure broader results for investigation.
SELECT DISTINCT t1."NAME", t1."FDIC_CERT", t2."ID_RSSD", t2."VALUE" AS "ASSETS", t2."VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
Results:
NAME,FDIC_CERT,ID_RSSD,ASSETS,VARIABLE_NAME
The Merchants & Planters Bank,107,691042,,"Miscellaneous Assets, Managed Personal Trust & Investment Management Agency Accounts"
Texas Regional Bank,26906,380458,,"Memo: Investments of Fiduciary Accounts in Advised or Sponsored Mutual Funds, Managed Assets (Dec. Only)"
The First National Bank of Frederick,3985,288152,,"Other Retirement Accounts, Non-Managed Assets"
Peoples Bank and Trust Company,2331,243955,,Trading Account Assets Foreign Offices

[Successfully executed]
2025-07-01 04:57:55 - Thread-920 (execute) - INFO - [Try to execute]
-- Description: Fetch available data for the uninsured percentage calculation without relying on a specific variable identifier, expanding the scope for relevant data exploration.
SELECT DISTINCT t1."NAME", t1."FDIC_CERT", t2."VALUE" AS "ASSETS", t3."VALUE" AS "PERCENT_INSURED"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
ON CAST(t1."ID_RSSD" AS TEXT) = t3."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
[Try to execute]
2025-07-01 04:58:08 - Thread-920 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Fetch available data for the uninsured percentage calculation without relying on a specific variable identifier, expanding the scope for relevant data exploration.
SELECT DISTINCT t1."NAME", t1."FDIC_CERT", t2."VALUE" AS "ASSETS", t3."VALUE" AS "PERCENT_INSURED"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
ON CAST(t1."ID_RSSD" AS TEXT) = t3."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
Results:
NAME,FDIC_CERT,ASSETS,PERCENT_INSURED
Crescent Bank,33492,278225000.00000000000,0E-11
Crescent Bank,33492,0.02760680000,0E-11
Crescent Bank,33492,0.00278550000,0E-11
Crescent Bank,33492,8970000.00000000000,0E-11
Crescent Bank,33492,0.04080000000,0E-11
Crescent Bank,33492,0.01275150000,0E-11
Crescent Bank,33492,0.01266040000,0E-11
Crescent Bank,33492,0.01679670000,0E-11

[Successfully executed]
2025-07-01 04:58:08 - Thread-920 (execute) - INFO - [Try to execute]
-- Description: Rank active banks based on available data for uninsured percentage without a strict reliance on a specific variable for '% Insured (Estimated)' or a specific date.
SELECT t1."NAME", t1."FDIC_CERT", 
       ROW_NUMBER() OVER (ORDER BY t2."VALUE" DESC) AS "RANK"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 10;
[Try to execute]
2025-07-01 04:58:23 - Thread-920 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Rank active banks based on available data for uninsured percentage without a strict reliance on a specific variable for '% Insured (Estimated)' or a specific date.
SELECT t1."NAME", t1."FDIC_CERT", 
       ROW_NUMBER() OVER (ORDER BY t2."VALUE" DESC) AS "RANK"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 10;
Results:
NAME,FDIC_CERT,RANK
Home Federal Savings and Loan Association of Niles,28349,12403982
Broadstreet Bank S S B,28868,12403983
State Bank of Taunton,16906,12403984
Arcadian Bank,10561,12403985
First Southern Bank,31158,12403986
Bank of the Pacific,23041,12403987
"Colonial Savings, F.A.",31361,12403988
The First National Bank of Pandora,6671,12403989
The Malvern National Bank,14644,12403990
First National Bank Of Commerce,3896,12403991

[Successfully executed]
2025-07-01 04:58:23 - Thread-920 (execute) - INFO - [Try to execute]
-- Description: Retrieve the names of active banks with available data for uninsured percentages, ranked without a strict reliance on a specific variable or specific date.
SELECT t1."NAME", t3."VALUE" AS "PERCENT_INSURED"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
ON CAST(t1."ID_RSSD" AS TEXT) = t3."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 10;
[Try to execute]
2025-07-01 04:58:33 - Thread-920 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Description: Retrieve the names of active banks with available data for uninsured percentages, ranked without a strict reliance on a specific variable or specific date.
SELECT t1."NAME", t3."VALUE" AS "PERCENT_INSURED"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
ON CAST(t1."ID_RSSD" AS TEXT) = t3."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 10;
Results:
NAME,PERCENT_INSURED
Riverview Bank,
Riverview Bank,
Riverview Bank,
Riverview Bank,
Riverview Bank,
Riverview Bank,
Riverview Bank,
Riverview Bank,
Riverview Bank,
Riverview Bank,

[Successfully executed]
2025-07-01 04:58:33 - Thread-920 (execute) - INFO - itercount: 0
2025-07-01 04:58:33 - Thread-920 (execute) - INFO - [Self-refine]
Table full name: FINANCE__ECONOMICS.CYBERSYN.FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES
Column name: VARIABLE_NAME Type: TEXT Description: Human-readable description of the financial data variables tracked by the FDIC.
Column name: UNIT Type: TEXT Description: Unit in which the measure is recorded (e.g., USD YTD).
Column name: MEASURE Type: TEXT Description: Quantifiable attribute being recorded (e.g., Domestic Deposits).
Column name: VARIABLE Type: TEXT Description: Unique FDIC identifier for tracked financial data.
Column name: MEASUREMENT_TYPE Type: TEXT Description: Classification indicating the level at which the variable is tracked by the FDIC, either at the "Institution" or "Branch" level.
Column name: FREQUENCY Type: TEXT Description: How often the data is aggregated (e.g., Annual).
Sample rows:
[{'VARIABLE_NAME': 'Institutional Assets', 'UNIT': 'USD', 'VARIABLE': 'ASSET', 'MEASUREMENT_TYPE': 'Institution', 'FREQUENCY': 'Annual'}, {'VARIABLE_NAME': 'Institutional Domestic Deposits', 'UNIT': 'USD', 'VARIABLE': 'DEPDOM', 'MEASUREMENT_TYPE': 'Institution', 'FREQUENCY': 'Annual'}, {'VARIABLE_NAME': 'Institutional Deposits', 'UNIT': 'USD', 'VARIABLE': 'DEPSUM', 'MEASUREMENT_TYPE': 'Institution', 'FREQUENCY': 'Annual'}, {'VARIABLE_NAME': 'Branch Deposits', 'UNIT': 'USD', 'VARIABLE': 'DEPSUMBR', 'MEASUREMENT_TYPE': 'Branch', 'FREQUENCY': 'Annual'}, {'VARIABLE_NAME': 'Escrow Deposits', 'UNIT': 'USD', 'VARIABLE': 'ESCROW', 'MEASUREMENT_TYPE': 'Institution', 'FREQUENCY': 'Annual'}]
--------------------------------------------------
Table full name: FINANCE__ECONOMICS.CYBERSYN.FINANCIAL_INSTITUTION_ENTITIES
Column name: NAME Type: TEXT Description: Name of the bank
Column name: NAICS_CODE Type: TEXT Description: NAICS code of the primary activity conducted by an entity.
Column name: FDIC_CERT Type: NUMBER Description: A unique identifier for the financial institution assigned by the FDIC
Column name: START_DATE Type: TIMESTAMP_NTZ Description: First date for which the bank was open
Column name: ENTITY_TYPE Type: TEXT Description: The institution grouping for the bank (National Bank, Non-member Bank, etc.)
Column name: IS_ACTIVE Type: BOOLEAN Description: Status of the bank to determine active or closed
Column name: ID_RSSD Type: NUMBER Description: A unique identifier assigned by the Federal Reserve for the financial institution
Column name: CATEGORY Type: TEXT Description: Category for the entity
Column name: CHARTER_TYPE Type: TEXT Description: The particular charter assigned to the bank (Industrial Bank, Commercial Bank, etc.)
Sample rows:
[{'NAME': 'First Capital Bank', 'NAICS_CODE': '52211', 'FDIC_CERT': 34966, 'START_DATE': '1999-09-27 00:00:00', 'ENTITY_TYPE': 'State Member Bank', 'IS_ACTIVE': True, 'ID_RSSD': 2849463, 'CATEGORY': 'Bank', 'CHARTER_TYPE': 'Commercial Bank'}, {'NAME': 'The Bank of Princeton', 'NAICS_CODE': '52211', 'FDIC_CERT': 58513, 'START_DATE': '2007-04-23 00:00:00', 'ENTITY_TYPE': 'Non-member Bank', 'IS_ACTIVE': True, 'ID_RSSD': 3595271, 'CATEGORY': 'Bank', 'CHARTER_TYPE': 'Commercial Bank'}, {'NAME': 'Lone Star National Bank', 'NAICS_CODE': '52211', 'FDIC_CERT': 24347, 'START_DATE': '1983-01-24 00:00:00', 'ENTITY_TYPE': 'National Bank', 'IS_ACTIVE': True, 'ID_RSSD': 842460, 'CATEGORY': 'Bank', 'CHARTER_TYPE': 'Commercial Bank'}, {'NAME': "Citizens' Bank, Inc.", 'NAICS_CODE': '52211', 'FDIC_CERT': 23523, 'START_DATE': '1981-09-08 00:00:00', 'ENTITY_TYPE': 'Non-member Bank', 'IS_ACTIVE': True, 'ID_RSSD': 563336, 'CATEGORY': 'Bank', 'CHARTER_TYPE': 'Commercial Bank'}, {'NAME': 'Miners & Merchants Bank', 'NAICS_CODE': '52211', 'FDIC_CERT': 13018, 'START_DATE': '1902-06-10 00:00:00', 'ENTITY_TYPE': 'Non-member Bank', 'IS_ACTIVE': True, 'ID_RSSD': 913436, 'CATEGORY': 'Bank', 'CHARTER_TYPE': 'Commercial Bank'}]
--------------------------------------------------
Table full name: FINANCE__ECONOMICS.CYBERSYN.FINANCIAL_INSTITUTION_TIMESERIES
Column name: VARIABLE Type: TEXT Description: Unique identifier for a variable joinable to the timeseries table
Column name: ID_RSSD Type: TEXT Description: A unique identifier assigned by the Federal Reserve for the financial institution
Column name: VALUE Type: NUMBER Description: Numeric value for the given data point
Column name: DATE Type: DATE Description: Date associated with the value
Column name: VARIABLE_NAME Type: TEXT Description: Human-readable name for the variable
Column name: UNIT Type: TEXT Description: Unit of measure for the value, examples (e.g., percentage, USD)
Sample rows:
[{'VARIABLE': 'P3OTHLNR', 'ID_RSSD': '582971', 'VALUE': '0E-11', 'DATE': '1991-09-30', 'VARIABLE_NAME': 'Other Loans, Past Due 30 - 89 Days', 'UNIT': 'Percent'}, {'VARIABLE': 'DRLNLSQR', 'ID_RSSD': '1005655', 'VALUE': '0.00020890000', 'DATE': '2008-06-30', 'VARIABLE_NAME': 'Total Charge-Offs', 'UNIT': 'Percent'}, {'VARIABLE': 'CRCINUSQR', 'ID_RSSD': '568470', 'VALUE': '0E-11', 'DATE': '2015-06-30', 'VARIABLE_NAME': 'To Non-U.S. Addressees', 'UNIT': 'Percent'}, {'VARIABLE': 'EQCCOMPI', 'ID_RSSD': '321170', 'VALUE': None, 'DATE': '1990-03-31', 'VARIABLE_NAME': 'Other Comprehensive Income', 'UNIT': 'USD'}, {'VARIABLE': 'DEPIDOMR', 'ID_RSSD': '21658', 'VALUE': '0.78737600000', 'DATE': '2008-12-31', 'VARIABLE_NAME': 'Interest-Bearing Deposits in Domestic Offices', 'UNIT': 'Percent'}]
--------------------------------------------------
Table full name: FINANCE__ECONOMICS.CYBERSYN.FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES
Column name: VALUE Type: NUMBER Description: Value reported for the variable.
Column name: DATE Type: DATE Description: Date associated with the value.
Column name: FDIC_INSTITUTION_ID Type: TEXT Description: Unique FDIC ID of the institution that owns the branch. It is a unique number, sequentially added to the FDIC database for both banks and branches. This ID is updated with every merger or purchase of branches to reflect the most current owner.
Column name: UNIT Type: TEXT Description: Unit in which the measure is recorded (e.g., USD YTD).
Column name: VARIABLE Type: TEXT Description: Unique FDIC identifier for tracked financial data.
Column name: FDIC_BRANCH_ID Type: TEXT Description: FDIC's unique number for the bank or savings institution assigned by the FDIC in order to identify and track. The branch ID for the Headquarters branch is the same as the branch ID for the entire bank or savings institution.
Column name: VARIABLE_NAME Type: TEXT Description: Human-readable description of the financial data variables tracked by the FDIC.
Sample rows:
[{'VALUE': 119632, 'DATE': '2023-06-30', 'FDIC_INSTITUTION_ID': '2239', 'UNIT': 'USD', 'VARIABLE': 'DEPSUMBR', 'FDIC_BRANCH_ID': '286466', 'VARIABLE_NAME': 'Branch Deposits'}, {'VALUE': 59230, 'DATE': '2017-06-30', 'FDIC_INSTITUTION_ID': '6499', 'UNIT': 'USD', 'VARIABLE': 'DEPSUMBR', 'FDIC_BRANCH_ID': '6499', 'VARIABLE_NAME': 'Branch Deposits'}, {'VALUE': 35943, 'DATE': '2014-06-30', 'FDIC_INSTITUTION_ID': '417', 'UNIT': 'USD', 'VARIABLE': 'DEPSUMBR', 'FDIC_BRANCH_ID': '481396', 'VARIABLE_NAME': 'Branch Deposits'}, {'VALUE': 85928, 'DATE': '2016-06-30', 'FDIC_INSTITUTION_ID': '3123', 'UNIT': 'USD', 'VARIABLE': 'DEPSUMBR', 'FDIC_BRANCH_ID': '203999', 'VARIABLE_NAME': 'Branch Deposits'}, {'VALUE': 133714, 'DATE': '2007-06-30', 'FDIC_INSTITUTION_ID': '745', 'UNIT': 'USD', 'VARIABLE': 'ASSET', 'FDIC_BRANCH_ID': '745', 'VARIABLE_NAME': 'Institutional Assets'}]
--------------------------------------------------
Table full name: FINANCE__ECONOMICS.CYBERSYN.FINANCIAL_INSTITUTION_ATTRIBUTES
Column name: UNIT Type: TEXT Description: Unit of measure for the value, examples (e.g., percentage, USD)
Column name: DEFINITION Type: TEXT Description: Detailed description of the variable including calculation where applicable
Column name: VARIABLE Type: TEXT Description: Unique identifier for a variable joinable to the timeseries table
Column name: VARIABLE_NAME Type: TEXT Description: Human-readable name for the variable
Column name: FREQUENCY Type: TEXT Description: Measurement period (e.g., Annual, Quarterly)
Sample rows:
[{'UNIT': 'Percent', 'DEFINITION': 'Retained earnings from bank operations, net unrealized holding gains (losses) on available-for-sale securities, and cumulative foreign currency translation adjustments.', 'VARIABLE': 'EQUP', 'VARIABLE_NAME': 'Undivided Profits', 'FREQUENCY': 'Quarterly'}, {'UNIT': 'Percent', 'DEFINITION': 'Loan and lease financing receivables, net of unearned income, allowances, and reserves, as a percent of total assets.', 'VARIABLE': 'LNLSNTV', 'VARIABLE_NAME': 'Net Loans and Leases to Assets', 'FREQUENCY': 'YTD'}, {'UNIT': 'Percent', 'DEFINITION': 'Net amount of loans secured by junior liens on 1-4 family residential properties (which are held in domestic offices) that have been charged-off and debited to the allowance for loan and lease losses established by the institution. Prior to 2004, this item is not available for TFR Reporters . Calculated as NTRERSF2 / ASSET5', 'VARIABLE': 'NTRERSF2R', 'VARIABLE_NAME': 'Secured By Junior Liens', 'FREQUENCY': 'YTD'}, {'UNIT': 'USD', 'DEFINITION': 'That portion of financial standby letters of credit, foreign office guarantees, performance standby letters of credit, and foreign office guarantees (including cash collateral standby letters of credit) conveyed to others.', 'VARIABLE': 'LOCFPSBK', 'VARIABLE_NAME': 'Standby Letters of Credit Amount Conveyed To Others', 'FREQUENCY': 'YTD'}, {'UNIT': 'USD', 'DEFINITION': 'Loan Loss Allowance Included in Tier 2 Capital', 'VARIABLE': 'RB2LNRES', 'VARIABLE_NAME': 'Loan Loss Allowance Included in Tier 2 Capital', 'FREQUENCY': 'YTD'}]
--------------------------------------------------
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'FINANCE__ECONOMICS': {'CYBERSYN': ['FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES', 'FINANCIAL_INSTITUTION_ENTITIES', 'FINANCIAL_INSTITUTION_TIMESERIES', 'FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES', 'FINANCIAL_INSTITUTION_ATTRIBUTES']}}

Some few-shot examples after column exploration may be helpful:
Query:
-- Description: Fetch distinct variable identifiers along with their descriptions to identify the variable related to '% Insured (Estimated)' from the FINANCIAL_INSTITUTION_ATTRIBUTES table.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ATTRIBUTES"
LIMIT 20;
Answer:
VARIABLE,VARIABLE_NAME
EQUP,Undivided Profits
PPPLFOV1,Outstanding balance under the PPPLF with a remaining maturity of more than one year
NTGLFXAQR,Net Gains (Losses) on Sales of Other Assets (Excluding Securities)
NTRERESR,1-4 Family Residential
SCO3YLESR,Other Mortgage-Backed Securities Expected Average Life: Three Years Or Less
SZDRCIR,"Charge-offs, C&I Loans Securitized by Bank"
P9CI,"Commercial and Industrial Loans, Past Due 90+ Days"
LNLSNTV,Net Loans and Leases to Assets
Query:
-- Description: Fetch distinct variable identifiers and their descriptions to confirm those available in the quarterly estimates as related to assets exceeding $10 billion.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME", "FREQUENCY"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ATTRIBUTES"
WHERE "VARIABLE_NAME" ILIKE '%asset%' OR "VARIABLE_NAME" ILIKE '%insured%'
LIMIT 20;
Answer:
VARIABLE,VARIABLE_NAME,FREQUENCY
NTGLFXAQR,Net Gains (Losses) on Sales of Other Assets (Excluding Securities),Quarterly
LNLSNTV,Net Loans and Leases to Assets,YTD
TIMNMNUM,"# of investment Management and Advisory Agency Accounts, Non-Managed Assets",YTD
ASSET5,Average Total Assets,YTD
TOFMA,"Other Fiduciary Accounts, Managed Assets",YTD
DEPINSR,Estimated Insured Deposits,YTD
TORNMA,"Other Retirement Accounts, Non-Managed Assets",YTD
NASCDEBT,Debt Securities and Other Assets in Nonaccrual
Query:
-- Description: Retrieve data from FINANCIAL_INSTITUTION_ENTITIES to identify active banks by checking their status, regardless of asset size or specific date.
SELECT DISTINCT "NAME", "FDIC_CERT", "ENTITY_TYPE", "IS_ACTIVE", "NAICS_CODE"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES"
LIMIT 20;
Answer:
NAME,FDIC_CERT,ENTITY_TYPE,IS_ACTIVE,NAICS_CODE
"BankPacific, Ltd",30692,Non-member Bank,True,52211
Holladay Bank & Trust,21448,Non-member Bank,True,52211
The Peoples Bank of the Virgin Islands,20465,Non-member Bank,False,52211
Deposit Insurance National Bank of Louisville,59059,National Bank,False,52211
Bank of Hackleburg,1731,Non-member Bank,False,52211
Johnson County Bank,11484,State Member Bank,False,52211
Hart County Bank and Trust Company,10145,Non-member Bank,True,52211
Query:
-- Description: Fetch institution-level asset values over time without date restrictions to explore patterns for filtering banks with potentially large assets.
SELECT DISTINCT "VARIABLE", "ID_RSSD", "VALUE", "DATE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
Answer:
VARIABLE,ID_RSSD,VALUE,DATE,VARIABLE_NAME
ASCEOTH,50461,0E-11,2001-09-30,"Maximum Amount of Credit Exposure, Bank Asset Sales All Other Loans &  All Leases"
AVASSETJ,50461,72411000.00000000000,2001-09-30,Adjusted Average Assets for Leverage Capital Purposes
ASTEMPM,50461,0.02884920000,2001-09-30,Assets Per Employee ($Millions)
AVASSETJR,50461,1.00399320000,2001-09-30,Adjusted Average Assets for Leverage Capital Purposes
Query:
-- Description: Combine institution IDs with asset data and active status without specific date conditions to ensure broader results for investigation.
SELECT DISTINCT t1."NAME", t1."FDIC_CERT", t2."ID_RSSD", t2."VALUE" AS "ASSETS", t2."VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
Answer:
NAME,FDIC_CERT,ID_RSSD,ASSETS,VARIABLE_NAME
The Merchants & Planters Bank,107,691042,,"Miscellaneous Assets, Managed Personal Trust & Investment Management Agency Accounts"
Texas Regional Bank,26906,380458,,"Memo: Investments of Fiduciary Accounts in Advised or Sponsored Mutual Funds, Managed Assets (Dec. Only)"
The First National Bank of Frederick,3985,288152,,"Other Retirement Accounts, Non-Managed Assets"
Peoples Bank and Trust Company,2331,243955,,Trading Account Assets Foreign Offices
Query:
-- Description: Fetch available data for the uninsured percentage calculation without relying on a specific variable identifier, expanding the scope for relevant data exploration.
SELECT DISTINCT t1."NAME", t1."FDIC_CERT", t2."VALUE" AS "ASSETS", t3."VALUE" AS "PERCENT_INSURED"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
ON CAST(t1."ID_RSSD" AS TEXT) = t3."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
Answer:
NAME,FDIC_CERT,ASSETS,PERCENT_INSURED
Crescent Bank,33492,278225000.00000000000,0E-11
Crescent Bank,33492,0.02760680000,0E-11
Crescent Bank,33492,0.00278550000,0E-11
Crescent Bank,33492,8970000.00000000000,0E-11
Crescent Bank,33492,0.04080000000,0E-11
Crescent Bank,33492,0.01275150000,0E-11
Crescent Bank,33492,0.01266040000,0E-11
Crescent Bank,33492,0.01679670000,0E-11
Query:
-- Description: Rank active banks based on available data for uninsured percentage without a strict reliance on a specific variable for '% Insured (Estimated)' or a specific date.
SELECT t1."NAME", t1."FDIC_CERT", 
       ROW_NUMBER() OVER (ORDER BY t2."VALUE" DESC) AS "RANK"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 10;
Answer:
NAME,FDIC_CERT,RANK
Home Federal Savings and Loan Association of Niles,28349,12403982
Broadstreet Bank S S B,28868,12403983
State Bank of Taunton,16906,12403984
Arcadian Bank,10561,12403985
First Southern Bank,31158,12403986
Bank of the Pacific,23041,12403987
"Colonial Savings, F.A.",31361,12403988
The First National Bank of Pandora,6671,12403989
The Malvern National Bank,14644,12403990
First National Bank Of Commerce,3896,12403991
Query:
-- Description: Retrieve the names of active banks with available data for uninsured percentages, ranked without a strict reliance on a specific variable or specific date.
SELECT t1."NAME", t3."VALUE" AS "PERCENT_INSURED"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
ON CAST(t1."ID_RSSD" AS TEXT) = t3."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
AND t2."VARIABLE_NAME" ILIKE '%asset%'
LIMIT 10;
Answer:
NAME,PERCENT_INSURED
Riverview Bank,
Riverview Bank,
Riverview Bank,
Riverview Bank,
Riverview Bank,
Riverview Bank,
Riverview Bank,
Riverview Bank,
Riverview Bank,
Riverview Bank,
Task: As of December 31, 2022, list the top 10 active banks with assets exceeding $10 billion, ranked by the highest percentage of uninsured assets, where the percentage is calculated as one minus the value of the '% Insured (Estimated)' variable from quarterly estimates. Provide the names of these banks and their respective percentages of uninsured assets.
Another way to say it: As of December 31, 2022, list the top 10 active large banks, each with assets over $10 billion, that have the highest percentage of uninsured assets based on quarterly estimates. Provide the names of these banks and their respective percentages of uninsured assets.

Please think step by step and answer only one complete SQL in snowflake dialect in ```sql``` format.
SQL usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'FINANCE__ECONOMICS': {'CYBERSYN': ['FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES', 'FINANCIAL_INSTITUTION_ENTITIES', 'FINANCIAL_INSTITUTION_TIMESERIES', 'FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES', 'FINANCIAL_INSTITUTION_ATTRIBUTES']}}

When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When asked something without stating name or id, return both of them. e.g. Which products ...? The answer should include product_name and product_id.
When asked percentage decrease, you should return a positive value. e.g. How many percentage points in 2021 decrease compared to ...? The answer should be a positive value indicating the decresed number. Try to use ABS().
If asked two tables, you should reply with the last one instead of combining two tables. e.g. Identifying the top five states ... examine the state that ranks fourth overall and identify its top five counties. You should only answer top five counties.
Use ST_DISTANCE to calculate distance between two geographic points for more accurate answer.
If the task description does not specify the number of decimal places, retain all decimals to four places.

[Self-refine]
2025-07-01 04:58:38 - Thread-920 (execute) - INFO - [Try to run SQL in self-refine]
```sql
SELECT t1."NAME" AS "BANK_NAME",
       (1 - t3."VALUE") * 100 AS "PERCENT_UNINSURED"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
ON CAST(t1."ID_RSSD" AS TEXT) = t3."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
  AND t2."VARIABLE_NAME" ILIKE '%asset%'
  AND t2."VALUE" > 10000000000 -- Assets exceeding $10 billion
  AND t3."VARIABLE_NAME" ILIKE '%insured (estimated)%'
  AND t3."FREQUENCY" = 'Quarterly'
  AND t3."DATE" = '2022-12-31'
ORDER BY (1 - t3."VALUE") DESC NULLS LAST
LIMIT 10;
```
[Try to run SQL in self-refine]
2025-07-01 04:58:39 - Thread-920 (execute) - INFO - itercount: 1
2025-07-01 04:58:39 - Thread-920 (execute) - INFO - [Self-refine]
Input sql:
SELECT t1."NAME" AS "BANK_NAME",
       (1 - t3."VALUE") * 100 AS "PERCENT_UNINSURED"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
ON CAST(t1."ID_RSSD" AS TEXT) = t3."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
  AND t2."VARIABLE_NAME" ILIKE '%asset%'
  AND t2."VALUE" > 10000000000 -- Assets exceeding $10 billion
  AND t3."VARIABLE_NAME" ILIKE '%insured (estimated)%'
  AND t3."FREQUENCY" = 'Quarterly'
  AND t3."DATE" = '2022-12-31'
ORDER BY (1 - t3."VALUE") DESC NULLS LAST
LIMIT 10;
The error information is:
{'status': 'error', 'error_msg': "##ERROR##000904 (42000): SQL compilation error: error line 12 at position 6\ninvalid identifier 'T3.FREQUENCY'"}
Please correct it and output only 1 complete SQL query.
[Self-refine]
2025-07-01 04:58:45 - Thread-920 (execute) - INFO - [Try to run SQL in self-refine]
```sql
SELECT t1."NAME" AS "BANK_NAME",
       (1 - t3."VALUE") * 100 AS "PERCENT_UNINSURED"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t2
ON CAST(t1."ID_RSSD" AS TEXT) = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
ON CAST(t1."ID_RSSD" AS TEXT) = t3."ID_RSSD"
WHERE t1."IS_ACTIVE" = TRUE
  AND t2."VARIABLE_NAME" ILIKE '%asset%'
  AND t2."VALUE" > 10000000000 -- Assets exceeding $10 billion
  AND t3."VARIABLE_NAME" ILIKE '%insured (estimated)%'
  AND t3."DATE" = '2022-12-31'
ORDER BY (1 - t3."VALUE") DESC NULLS LAST
LIMIT 10;
```
[Try to run SQL in self-refine]
2025-07-01 04:58:48 - Thread-920 (execute) - INFO - Total iteration counts: 1
