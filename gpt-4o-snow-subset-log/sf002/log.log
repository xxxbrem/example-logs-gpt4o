2025-07-01 04:57:47 - Thread-913 (execute) - INFO - [Exploration]
```sql
-- Step 1: Identify the variable representing '% Insured (Estimated)' in the FDIC timeseries data.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%insured%'
LIMIT 20;
```

```sql
-- Step 2: Inspect the records for '% Insured (Estimated)' values and their corresponding dates to identify data format, especially for December 31, 2022.
SELECT *
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" = '% Insured (Estimated)'
  AND "DATE" = '2022-12-31'
LIMIT 20;
```

```sql
-- Step 3: Retrieve distinct financial institutions with their identifiers for potential filters (active and large banks).
SELECT DISTINCT "ID_RSSD", "NAME", "IS_ACTIVE", "ENTITY_TYPE"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES"
WHERE "IS_ACTIVE" = TRUE
LIMIT 20;
```

```sql
-- Step 4: Focus on banks with total assets exceeding $10 billion using the variable corresponding to "Institutional Assets."
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
```

```sql
-- Step 5: Query total assets as of December 31, 2022, for active banks to filter those exceeding $10 billion.
SELECT t1."ID_RSSD", t2."NAME", t1."VALUE" AS "TOTAL_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
WHERE t1."VARIABLE" = 'ASSET'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t1."VALUE" > 10000000000
LIMIT 20;
```

```sql
-- Step 6: Integrate "% Insured (Estimated)" and "Institutional Assets" for December 31, 2022, to calculate the percentage of uninsured assets.
SELECT t1."ID_RSSD", t2."NAME", 
       t3."VALUE" AS "TOTAL_ASSETS", 
       (1 - t1."VALUE") AS "PERCENT_UNINSURED_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
  ON t1."ID_RSSD" = t3."ID_RSSD"
WHERE t1."VARIABLE_NAME" = '% Insured (Estimated)'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t3."VARIABLE" = 'ASSET'
  AND t3."DATE" = '2022-12-31'
  AND t3."VALUE" > 10000000000
LIMIT 20;
```

```sql
-- Step 7: Rank banks by their percentage of uninsured assets and select the top 10.
SELECT t1."ID_RSSD", t2."NAME", 
       t3."VALUE" AS "TOTAL_ASSETS", 
       (1 - t1."VALUE") AS "PERCENT_UNINSURED_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
  ON t1."ID_RSSD" = t3."ID_RSSD"
WHERE t1."VARIABLE_NAME" = '% Insured (Estimated)'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t3."VARIABLE" = 'ASSET'
  AND t3."DATE" = '2022-12-31'
  AND t3."VALUE" > 10000000000
ORDER BY "PERCENT_UNINSURED_ASSETS" DESC
LIMIT 10;
```

```sql
-- Step 8: Expand the query to also include entity-specific details such as the institution type and charter type.
SELECT t1."ID_RSSD", t2."NAME", 
       t3."VALUE" AS "TOTAL_ASSETS", 
       (1 - t1."VALUE") AS "PERCENT_UNINSURED_ASSETS",
       t2."ENTITY_TYPE",
       t2."CHARTER_TYPE"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
  ON t1."ID_RSSD" = t3."ID_RSSD"
WHERE t1."VARIABLE_NAME" = '% Insured (Estimated)'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t3."VARIABLE" = 'ASSET'
  AND t3."DATE" = '2022-12-31'
  AND t3."VALUE" > 10000000000
ORDER BY "PERCENT_UNINSURED_ASSETS" DESC
LIMIT 10;
```

```sql
-- Step 9: Investigate FDIC Summary of Deposits Timeseries for validation of uninsured deposit-related metrics.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%insured%'
LIMIT 20;
```

```sql
-- Step 10: Combine data sources to validate uninsured percentage using FDIC Summary of Deposits Timeseries.
SELECT a."FDIC_INSTITUTION_ID", e."NAME", 
       b."VALUE" AS "TOTAL_ASSETS", 
       (1 - c."VALUE") AS "PERCENT_UNINSURED_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES" c
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES" b
  ON c."FDIC_INSTITUTION_ID" = b."FDIC_INSTITUTION_ID"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e
  ON a."FDIC_INSTITUTION_ID" = e."FDIC_CERT"
WHERE c."VARIABLE_NAME" = '% Insured (Estimated)'
  AND c."DATE" = '2022-12-31'
  AND e."IS_ACTIVE" = TRUE
  AND b."VARIABLE" = 'ASSET'
  AND b."DATE" = '2022-12-31'
  AND b."VALUE" > 10000000000
ORDER BY "PERCENT_UNINSURED_ASSETS" DESC
LIMIT 10;
``` 
[Exploration]
2025-07-01 04:57:47 - Thread-913 (execute) - INFO - [Try to execute]
-- Step 1: Identify the variable representing '% Insured (Estimated)' in the FDIC timeseries data.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%insured%'
LIMIT 20;
[Try to execute]
2025-07-01 04:57:53 - Thread-913 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Step 1: Identify the variable representing '% Insured (Estimated)' in the FDIC timeseries data.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%insured%'
LIMIT 20;
Results:
VARIABLE,VARIABLE_NAME
DEPUNA,Estimated uninsured deposits in domestic offices in insured branches in U.S. territories and possessions
DEPINS,Estimated Insured Deposits
DEPUNAR,Estimated uninsured deposits in domestic offices in insured branches in U.S. territories and possessions
DEPINSR,Estimated Insured Deposits
ESTINS,% Insured (Estimated)
BROINS,Fully Insured Brokered Deposits
ESTINSR,% Insured (Estimated) Ratio to Assets
BROINSR,Fully Insured Brokered Deposits
IDDEPINR,% Insured (

[Successfully executed]
2025-07-01 04:57:53 - Thread-913 (execute) - INFO - [Try to execute]
-- Step 2: Inspect the records for '% Insured (Estimated)' values and their corresponding dates to identify data format, especially for December 31, 2022.
SELECT *
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" = '% Insured (Estimated)'
  AND "DATE" = '2022-12-31'
LIMIT 20;
[Try to execute]
2025-07-01 04:57:55 - Thread-913 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Step 2: Inspect the records for '% Insured (Estimated)' values and their corresponding dates to identify data format, especially for December 31, 2022.
SELECT *
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" = '% Insured (Estimated)'
  AND "DATE" = '2022-12-31'
LIMIT 20;
Results:
ID_RSSD,VARIABLE,VARIABLE_NAME,VALUE,UNIT,DATE
522034,IDDEPINR,% Insured (Estimated),0.79601470000,Percent,2022-12-31
966272,ESTINS,% Insured (Estimated),0.91068520000,Percent,2022-12-31
966272,IDDEPINR,% Insured (Estimated),0.91068520000,Percent,2022-12-31
333034,ESTINS,% Insured (Estimated),0.81379190000,Percent,2022-12-31
333034,IDDEPINR,% Insured (Estimated),0.81379190000,Percent,2022-12-31

[Successfully executed]
2025-07-01 04:57:55 - Thread-913 (execute) - INFO - [Try to execute]
-- Step 3: Retrieve distinct financial institutions with their identifiers for potential filters (active and large banks).
SELECT DISTINCT "ID_RSSD", "NAME", "IS_ACTIVE", "ENTITY_TYPE"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES"
WHERE "IS_ACTIVE" = TRUE
LIMIT 20;
[Try to execute]
2025-07-01 04:57:56 - Thread-913 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Step 3: Retrieve distinct financial institutions with their identifiers for potential filters (active and large banks).
SELECT DISTINCT "ID_RSSD", "NAME", "IS_ACTIVE", "ENTITY_TYPE"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES"
WHERE "IS_ACTIVE" = TRUE
LIMIT 20;
Results:
ID_RSSD,NAME,IS_ACTIVE,ENTITY_TYPE
51356,Latimer State Bank,True,Non-member Bank
958231,Community Bank of Easton,True,Non-member Bank
194936,BankSouth,True,Non-member Bank
456344,Hart County Bank and Trust Company,True,Non-member Bank
753052,Montrose Savings Bank,True,Non-member Bank
441470,First Federal Savings & Loan Association of Ravenswood,True,Savings & Loan Association
651448,"JPMorgan Chase Bank, Dearborn",True,State Member Bank
5475452,Gulf Atlantic Bank,True,State Member Bank

[Successfully executed]
2025-07-01 04:57:56 - Thread-913 (execute) - INFO - [Try to execute]
-- Step 4: Focus on banks with total assets exceeding $10 billion using the variable corresponding to "Institutional Assets."
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
[Try to execute]
2025-07-01 04:57:58 - Thread-913 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Step 4: Focus on banks with total assets exceeding $10 billion using the variable corresponding to "Institutional Assets."
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
Results:
VARIABLE,VARIABLE_NAME
RWAJ,Total Risk Weighted Assets
TRFOR,Trading Account Assets Foreign Offices
SCABSR,Asset Backed Securities
ASSTLT,Long-Term Assets (5+ Years)
BKPREM,Bank Premises and Fixed Assets
P3SCDEBT,"Debt Securities and Other Assets, Past Due 30 - 89 Days"
OALIFSEP,Separate Account Life insurance Assets
ASCERES,"Maximum Amount of Credit Exposure, Bank Asset Sales 1-4 Family Residential Loans"
NASCDEBT,Debt Securities and Other Assets in Nonaccrual Status
ROAPTXQ,Pretax Re

[Successfully executed]
2025-07-01 04:57:58 - Thread-913 (execute) - INFO - [Try to execute]
-- Step 5: Query total assets as of December 31, 2022, for active banks to filter those exceeding $10 billion.
SELECT t1."ID_RSSD", t2."NAME", t1."VALUE" AS "TOTAL_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
WHERE t1."VARIABLE" = 'ASSET'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t1."VALUE" > 10000000000
LIMIT 20;
[Try to execute]
2025-07-01 04:58:00 - Thread-913 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Step 5: Query total assets as of December 31, 2022, for active banks to filter those exceeding $10 billion.
SELECT t1."ID_RSSD", t2."NAME", t1."VALUE" AS "TOTAL_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
WHERE t1."VARIABLE" = 'ASSET'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t1."VALUE" > 10000000000
LIMIT 20;
Results:
ID_RSSD,NAME,TOTAL_ASSETS
936855,"UMB Bank, National Association",38279055000.00000000000
3637685,First Foundation Bank,12980327000.00000000000
2797724,TowneBank,15845722000.00000000000
934329,"BNY Mellon, National Association",31424000000.00000000000
637451,PlainsCapital Bank,13520414000.00000000000
208244,Old National Bank,46490438000.00000000000
693224,Atlantic Union Bank,20342081000.00000000000
339858,"BOKF, National Association",47596192000.00000000000

[Successfully executed]
2025-07-01 04:58:00 - Thread-913 (execute) - INFO - [Try to execute]
-- Step 6: Integrate "% Insured (Estimated)" and "Institutional Assets" for December 31, 2022, to calculate the percentage of uninsured assets.
SELECT t1."ID_RSSD", t2."NAME", 
       t3."VALUE" AS "TOTAL_ASSETS", 
       (1 - t1."VALUE") AS "PERCENT_UNINSURED_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
  ON t1."ID_RSSD" = t3."ID_RSSD"
WHERE t1."VARIABLE_NAME" = '% Insured (Estimated)'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t3."VARIABLE" = 'ASSET'
  AND t3."DATE" = '2022-12-31'
  AND t3."VALUE" > 10000000000
LIMIT 20;
[Try to execute]
2025-07-01 04:58:04 - Thread-913 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Step 6: Integrate "% Insured (Estimated)" and "Institutional Assets" for December 31, 2022, to calculate the percentage of uninsured assets.
SELECT t1."ID_RSSD", t2."NAME", 
       t3."VALUE" AS "TOTAL_ASSETS", 
       (1 - t1."VALUE") AS "PERCENT_UNINSURED_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
  ON t1."ID_RSSD" = t3."ID_RSSD"
WHERE t1."VARIABLE_NAME" = '% Insured (Estimated)'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t3."VARIABLE" = 'ASSET'
  AND t3."DATE" = '2022-12-31'
  AND t3."VALUE" > 10000000000
LIMIT 20;
Results:
ID_RSSD,NAME,TOTAL_ASSETS,PERCENT_UNINSURED_ASSETS
3579589,Stellar Bank,10891835000.00000000000,0.63455710000
3579589,Stellar Bank,10891835000.00000000000,0.63455710000
2797724,TowneBank,15845722000.00000000000,0.51065110000
1225761,Wells Fargo National Bank West,17664869000.00000000000,0.09242870000
1225761,Wells Fargo National Bank West,17664869000.00000000000,0.09242870000
143662,Umpqua Bank,31844724000.00000000000,0.36939480000

[Successfully executed]
2025-07-01 04:58:04 - Thread-913 (execute) - INFO - [Try to execute]
-- Step 7: Rank banks by their percentage of uninsured assets and select the top 10.
SELECT t1."ID_RSSD", t2."NAME", 
       t3."VALUE" AS "TOTAL_ASSETS", 
       (1 - t1."VALUE") AS "PERCENT_UNINSURED_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
  ON t1."ID_RSSD" = t3."ID_RSSD"
WHERE t1."VARIABLE_NAME" = '% Insured (Estimated)'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t3."VARIABLE" = 'ASSET'
  AND t3."DATE" = '2022-12-31'
  AND t3."VALUE" > 10000000000
ORDER BY "PERCENT_UNINSURED_ASSETS" DESC
LIMIT 10;
[Try to execute]
2025-07-01 04:58:11 - Thread-913 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Step 7: Rank banks by their percentage of uninsured assets and select the top 10.
SELECT t1."ID_RSSD", t2."NAME", 
       t3."VALUE" AS "TOTAL_ASSETS", 
       (1 - t1."VALUE") AS "PERCENT_UNINSURED_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
  ON t1."ID_RSSD" = t3."ID_RSSD"
WHERE t1."VARIABLE_NAME" = '% Insured (Estimated)'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t3."VARIABLE" = 'ASSET'
  AND t3."DATE" = '2022-12-31'
  AND t3."VALUE" > 10000000000
ORDER BY "PERCENT_UNINSURED_ASSETS" DESC
LIMIT 10;
Results:
ID_RSSD,NAME,TOTAL_ASSETS,PERCENT_UNINSURED_ASSETS
214807,Deutsche Bank Trust Company Americas,39192000000.00000000000,0.96322850000
214807,Deutsche Bank Trust Company Americas,39192000000.00000000000,0.96322850000
35301,State Street Bank and Trust Company,298020000000.00000000000,0.95600040000
541101,The Bank of New York Mellon,324646000000.00000000000,0.95167190000
35301,State Street Bank and Trust Company,298020000000.00000000000,0.91991530000

[Successfully executed]
2025-07-01 04:58:11 - Thread-913 (execute) - INFO - [Try to execute]
-- Step 8: Expand the query to also include entity-specific details such as the institution type and charter type.
SELECT t1."ID_RSSD", t2."NAME", 
       t3."VALUE" AS "TOTAL_ASSETS", 
       (1 - t1."VALUE") AS "PERCENT_UNINSURED_ASSETS",
       t2."ENTITY_TYPE",
       t2."CHARTER_TYPE"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
  ON t1."ID_RSSD" = t3."ID_RSSD"
WHERE t1."VARIABLE_NAME" = '% Insured (Estimated)'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t3."VARIABLE" = 'ASSET'
  AND t3."DATE" = '2022-12-31'
  AND t3."VALUE" > 10000000000
ORDER BY "PERCENT_UNINSURED_ASSETS" DESC
LIMIT 10;
[Try to execute]
2025-07-01 04:58:21 - Thread-913 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Step 8: Expand the query to also include entity-specific details such as the institution type and charter type.
SELECT t1."ID_RSSD", t2."NAME", 
       t3."VALUE" AS "TOTAL_ASSETS", 
       (1 - t1."VALUE") AS "PERCENT_UNINSURED_ASSETS",
       t2."ENTITY_TYPE",
       t2."CHARTER_TYPE"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
  ON t1."ID_RSSD" = t3."ID_RSSD"
WHERE t1."VARIABLE_NAME" = '% Insured (Estimated)'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t3."VARIABLE" = 'ASSET'
  AND t3."DATE" = '2022-12-31'
  AND t3."VALUE" > 10000000000
ORDER BY "PERCENT_UNINSURED_ASSETS" DESC
LIMIT 10;
Results:
ID_RSSD,NAME,TOTAL_ASSETS,PERCENT_UNINSURED_ASSETS,ENTITY_TYPE,CHARTER_TYPE
214807,Deutsche Bank Trust Company Americas,39192000000.00000000000,0.96322850000,State Member Bank,Commercial Bank
214807,Deutsche Bank Trust Company Americas,39192000000.00000000000,0.96322850000,State Member Bank,Commercial Bank
35301,State Street Bank and Trust Company,298020000000.00000000000,0.95600040000,State Member Bank,Commercial Bank
541101,The Bank of New York Mellon,324646000000.00000000000,0.95167190000

[Successfully executed]
2025-07-01 04:58:21 - Thread-913 (execute) - INFO - [Try to execute]
-- Step 9: Investigate FDIC Summary of Deposits Timeseries for validation of uninsured deposit-related metrics.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%insured%'
LIMIT 20;
[Try to execute]
2025-07-01 04:58:23 - Thread-913 (execute) - INFO - [Successfully executed]
Successfully executed. SQL:
-- Step 9: Investigate FDIC Summary of Deposits Timeseries for validation of uninsured deposit-related metrics.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%insured%'
LIMIT 20;
Results:
VARIABLE,VARIABLE_NAME
INSBRDD,Demand Deposits in Insured Branches in Puerto Rico and US Territories & Possessions
INSBRTS,Time and Savings Deposits in Insured Branches in Puerto Rico and US Territories & Possessions

[Successfully executed]
2025-07-01 04:58:23 - Thread-913 (execute) - INFO - [Try to execute]
-- Step 10: Combine data sources to validate uninsured percentage using FDIC Summary of Deposits Timeseries.
SELECT a."FDIC_INSTITUTION_ID", e."NAME", 
       b."VALUE" AS "TOTAL_ASSETS", 
       (1 - c."VALUE") AS "PERCENT_UNINSURED_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES" c
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES" b
  ON c."FDIC_INSTITUTION_ID" = b."FDIC_INSTITUTION_ID"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e
  ON a."FDIC_INSTITUTION_ID" = e."FDIC_CERT"
WHERE c."VARIABLE_NAME" = '% Insured (Estimated)'
  AND c."DATE" = '2022-12-31'
  AND e."IS_ACTIVE" = TRUE
  AND b."VARIABLE" = 'ASSET'
  AND b."DATE" = '2022-12-31'
  AND b."VALUE" > 10000000000
ORDER BY "PERCENT_UNINSURED_ASSETS" DESC
LIMIT 10;
[Try to execute]
2025-07-01 04:58:23 - Thread-913 (execute) - INFO - [Error occurred]
{'status': 'error', 'error_msg': "##ERROR##000904 (42000): SQL compilation error: error line 1 at position 7\ninvalid identifier 'A.FDIC_INSTITUTION_ID'"}
[Error occurred]
2025-07-01 04:59:37 - Thread-913 (execute) - INFO - [Corrected SQL]
```sql
-- Description:
-- The error was caused by the alias "a" not being defined in the query. 
-- To resolve this issue, we correctly reference the alias "c" for the FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES table.
-- The query's purpose is to find, as of December 31, 2022, the top 10 active banks with total assets exceeding $10 billion, 
-- ranked by the percentage of uninsured assets. The uninsured percentage is calculated as (1 - '% Insured (Estimated)').
-- Steps:
-- 1. Use the alias "c" to fetch the '% Insured (Estimated)' values and calculate uninsured percentages.
-- 2. Link this table to another instance of FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES (alias "b") for fetching total assets ('ASSET').
-- 3. Join with FINANCIAL_INSTITUTION_ENTITIES to filter for active banks and retrieve their names.
-- 4. Filter out banks with total assets less than $10 billion.
-- 5. Rank banks by their percentage of uninsured assets in descending order and return the top 10.

SELECT c."FDIC_INSTITUTION_ID", e."NAME", 
       b."VALUE" AS "TOTAL_ASSETS", 
       (1 - c."VALUE") AS "PERCENT_UNINSURED_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES" c
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES" b
  ON c."FDIC_INSTITUTION_ID" = b."FDIC_INSTITUTION_ID"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e
  ON c."FDIC_INSTITUTION_ID" = e."FDIC_CERT"
WHERE c."VARIABLE_NAME" = '% Insured (Estimated)' -- Filter for the insured percentage variable
  AND c."DATE" = '2022-12-31' -- Use data valid as of December 31, 2022
  AND e."IS_ACTIVE" = TRUE -- Only consider active financial entities
  AND b."VARIABLE" = 'ASSET' -- Filter for total assets variable
  AND b."DATE" = '2022-12-31' -- Match the same date for total assets
  AND b."VALUE" > 10000000000 -- Include only banks with total assets exceeding $10 billion
ORDER BY "PERCENT_UNINSURED_ASSETS" DESC -- Rank by descending uninsured percentage
LIMIT 10; -- Return the top 10 results
```
[Corrected SQL]
2025-07-01 04:59:37 - Thread-913 (execute) - INFO - [Results for corrected sql]
No data found for the specified query.

[Results for corrected sql]
2025-07-01 05:00:28 - Thread-913 (execute) - INFO - [Corrected SQL]
```sql
-- Description:
-- The issue of no data being found in the previous query suggests that the conditions might be too restrictive.
-- The task requires finding uninsured percentages for active banks using FDIC data, but simplified criteria are needed to ensure results.
-- Steps to resolve:
-- 1. Retain the filter for "% Insured (Estimated)" in `VARIABLE_NAME` as it is critical for calculating uninsured percentages.
-- 2. Keep the filter for the date as "2022-12-31" for both the insured percentage and assets.
-- 3. Focus on only active banks by checking `e."IS_ACTIVE" = TRUE`.
-- 4. Remove filtering on large assets (e.g., $10 billion) to allow banks of all sizes to be analyzed.
-- 5. Ensure proper joins and retrieve both the insured percentage and total assets.
-- 6. Order the results by the percentage of uninsured assets in descending order, focusing on the top 10.
-- The simplified query provides broader inputs while focusing on the task goal.

SELECT c."FDIC_INSTITUTION_ID", e."NAME", 
       b."VALUE" AS "TOTAL_ASSETS", 
       (1 - c."VALUE") AS "PERCENT_UNINSURED_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES" c
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES" b
  ON c."FDIC_INSTITUTION_ID" = b."FDIC_INSTITUTION_ID"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e
  ON c."FDIC_INSTITUTION_ID" = e."FDIC_CERT"
WHERE c."VARIABLE_NAME" = '% Insured (Estimated)' -- Focus on insured percentage
  AND c."DATE" = '2022-12-31' -- Data for December 31, 2022
  AND e."IS_ACTIVE" = TRUE -- Include only active banks
  AND b."VARIABLE" = 'ASSET' -- Focus on total assets variable
  AND b."DATE" = '2022-12-31' -- Same date for asset values
ORDER BY "PERCENT_UNINSURED_ASSETS" DESC -- Sort banks by highest uninsured percentage
LIMIT 10; -- Retrieve the top 10 results
```
[Corrected SQL]
2025-07-01 05:00:30 - Thread-913 (execute) - INFO - [Results for corrected sql]
No data found for the specified query.

[Results for corrected sql]
2025-07-01 05:01:24 - Thread-913 (execute) - INFO - [Corrected SQL]
```sql
-- Description:
-- The previous query returned no data due to overly stringent conditions, specifically the total asset filter (`b."VALUE" > 10000000000`), which excluded smaller banks. Additionally, an undefined alias "a" was used in the join, which caused a logical error.
-- To ensure valid results:
-- 1. Remove the total asset size condition (`b."VALUE" > 10000000000`) to include banks of all sizes, allowing us to retrieve broader results.
-- 2. Use the alias "c" correctly for referencing FDIC_INSTITUTION_ID instead of the undefined "a".
-- 3. Retain the filter for "% Insured (Estimated)" as this is vital to calculating uninsured percentages, a key metric in the task.
-- 4. Keep the date condition `c."DATE" = '2022-12-31'` to focus on the specified end-year period.
-- 5. Apply the active status filter (`e."IS_ACTIVE" = TRUE`) to focus only on active banks.
-- 6. Order by "PERCENT_UNINSURED_ASSETS" in descending order and limit to the top 10 results, as the task requires highlighting banks with the highest uninsured asset percentages.

SELECT c."FDIC_INSTITUTION_ID", e."NAME", 
       b."VALUE" AS "TOTAL_ASSETS", 
       (1 - c."VALUE") AS "PERCENT_UNINSURED_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES" c
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES" b
  ON c."FDIC_INSTITUTION_ID" = b."FDIC_INSTITUTION_ID" -- Join to match FDIC institution records
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" e
  ON c."FDIC_INSTITUTION_ID" = e."FDIC_CERT" -- Match to financial institution entity
WHERE c."VARIABLE_NAME" = '% Insured (Estimated)' -- Filter for the percentage of insured deposits
  AND c."DATE" = '2022-12-31' -- Use data as of December 31, 2022
  AND e."IS_ACTIVE" = TRUE -- Include only active financial institutions
  AND b."VARIABLE" = 'ASSET' -- Filter for total assets data
  AND b."DATE" = '2022-12-31' -- Match assets data to the same date
ORDER BY "PERCENT_UNINSURED_ASSETS" DESC -- Sort by highest uninsured percentages
LIMIT 10; -- Restrict output to the top 10 results
```
[Corrected SQL]
2025-07-01 05:01:25 - Thread-913 (execute) - INFO - [Results for corrected sql]
No data found for the specified query.

[Results for corrected sql]
2025-07-01 05:01:25 - Thread-913 (execute) - INFO - itercount: 0
2025-07-01 05:01:25 - Thread-913 (execute) - INFO - [Self-refine]
Table full name: FINANCE__ECONOMICS.CYBERSYN.FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES
Column name: VARIABLE_NAME Type: TEXT Description: Human-readable description of the financial data variables tracked by the FDIC.
Column name: UNIT Type: TEXT Description: Unit in which the measure is recorded (e.g., USD YTD).
Column name: MEASURE Type: TEXT Description: Quantifiable attribute being recorded (e.g., Domestic Deposits).
Column name: VARIABLE Type: TEXT Description: Unique FDIC identifier for tracked financial data.
Column name: MEASUREMENT_TYPE Type: TEXT Description: Classification indicating the level at which the variable is tracked by the FDIC, either at the "Institution" or "Branch" level.
Column name: FREQUENCY Type: TEXT Description: How often the data is aggregated (e.g., Annual).
Sample rows:
[{'VARIABLE_NAME': 'Institutional Assets', 'UNIT': 'USD', 'VARIABLE': 'ASSET', 'MEASUREMENT_TYPE': 'Institution', 'FREQUENCY': 'Annual'}, {'VARIABLE_NAME': 'Institutional Domestic Deposits', 'UNIT': 'USD', 'VARIABLE': 'DEPDOM', 'MEASUREMENT_TYPE': 'Institution', 'FREQUENCY': 'Annual'}, {'VARIABLE_NAME': 'Institutional Deposits', 'UNIT': 'USD', 'VARIABLE': 'DEPSUM', 'MEASUREMENT_TYPE': 'Institution', 'FREQUENCY': 'Annual'}, {'VARIABLE_NAME': 'Branch Deposits', 'UNIT': 'USD', 'VARIABLE': 'DEPSUMBR', 'MEASUREMENT_TYPE': 'Branch', 'FREQUENCY': 'Annual'}, {'VARIABLE_NAME': 'Escrow Deposits', 'UNIT': 'USD', 'VARIABLE': 'ESCROW', 'MEASUREMENT_TYPE': 'Institution', 'FREQUENCY': 'Annual'}]
--------------------------------------------------
Table full name: FINANCE__ECONOMICS.CYBERSYN.FINANCIAL_INSTITUTION_ENTITIES
Column name: NAME Type: TEXT Description: Name of the bank
Column name: NAICS_CODE Type: TEXT Description: NAICS code of the primary activity conducted by an entity.
Column name: FDIC_CERT Type: NUMBER Description: A unique identifier for the financial institution assigned by the FDIC
Column name: START_DATE Type: TIMESTAMP_NTZ Description: First date for which the bank was open
Column name: ENTITY_TYPE Type: TEXT Description: The institution grouping for the bank (National Bank, Non-member Bank, etc.)
Column name: IS_ACTIVE Type: BOOLEAN Description: Status of the bank to determine active or closed
Column name: ID_RSSD Type: NUMBER Description: A unique identifier assigned by the Federal Reserve for the financial institution
Column name: CATEGORY Type: TEXT Description: Category for the entity
Column name: CHARTER_TYPE Type: TEXT Description: The particular charter assigned to the bank (Industrial Bank, Commercial Bank, etc.)
Sample rows:
[{'NAME': 'First Capital Bank', 'NAICS_CODE': '52211', 'FDIC_CERT': 34966, 'START_DATE': '1999-09-27 00:00:00', 'ENTITY_TYPE': 'State Member Bank', 'IS_ACTIVE': True, 'ID_RSSD': 2849463, 'CATEGORY': 'Bank', 'CHARTER_TYPE': 'Commercial Bank'}, {'NAME': 'The Bank of Princeton', 'NAICS_CODE': '52211', 'FDIC_CERT': 58513, 'START_DATE': '2007-04-23 00:00:00', 'ENTITY_TYPE': 'Non-member Bank', 'IS_ACTIVE': True, 'ID_RSSD': 3595271, 'CATEGORY': 'Bank', 'CHARTER_TYPE': 'Commercial Bank'}, {'NAME': 'Lone Star National Bank', 'NAICS_CODE': '52211', 'FDIC_CERT': 24347, 'START_DATE': '1983-01-24 00:00:00', 'ENTITY_TYPE': 'National Bank', 'IS_ACTIVE': True, 'ID_RSSD': 842460, 'CATEGORY': 'Bank', 'CHARTER_TYPE': 'Commercial Bank'}, {'NAME': "Citizens' Bank, Inc.", 'NAICS_CODE': '52211', 'FDIC_CERT': 23523, 'START_DATE': '1981-09-08 00:00:00', 'ENTITY_TYPE': 'Non-member Bank', 'IS_ACTIVE': True, 'ID_RSSD': 563336, 'CATEGORY': 'Bank', 'CHARTER_TYPE': 'Commercial Bank'}, {'NAME': 'Miners & Merchants Bank', 'NAICS_CODE': '52211', 'FDIC_CERT': 13018, 'START_DATE': '1902-06-10 00:00:00', 'ENTITY_TYPE': 'Non-member Bank', 'IS_ACTIVE': True, 'ID_RSSD': 913436, 'CATEGORY': 'Bank', 'CHARTER_TYPE': 'Commercial Bank'}]
--------------------------------------------------
Table full name: FINANCE__ECONOMICS.CYBERSYN.FINANCIAL_INSTITUTION_TIMESERIES
Column name: VARIABLE Type: TEXT Description: Unique identifier for a variable joinable to the timeseries table
Column name: ID_RSSD Type: TEXT Description: A unique identifier assigned by the Federal Reserve for the financial institution
Column name: VALUE Type: NUMBER Description: Numeric value for the given data point
Column name: DATE Type: DATE Description: Date associated with the value
Column name: VARIABLE_NAME Type: TEXT Description: Human-readable name for the variable
Column name: UNIT Type: TEXT Description: Unit of measure for the value, examples (e.g., percentage, USD)
Sample rows:
[{'VARIABLE': 'P3OTHLNR', 'ID_RSSD': '582971', 'VALUE': '0E-11', 'DATE': '1991-09-30', 'VARIABLE_NAME': 'Other Loans, Past Due 30 - 89 Days', 'UNIT': 'Percent'}, {'VARIABLE': 'DRLNLSQR', 'ID_RSSD': '1005655', 'VALUE': '0.00020890000', 'DATE': '2008-06-30', 'VARIABLE_NAME': 'Total Charge-Offs', 'UNIT': 'Percent'}, {'VARIABLE': 'CRCINUSQR', 'ID_RSSD': '568470', 'VALUE': '0E-11', 'DATE': '2015-06-30', 'VARIABLE_NAME': 'To Non-U.S. Addressees', 'UNIT': 'Percent'}, {'VARIABLE': 'EQCCOMPI', 'ID_RSSD': '321170', 'VALUE': None, 'DATE': '1990-03-31', 'VARIABLE_NAME': 'Other Comprehensive Income', 'UNIT': 'USD'}, {'VARIABLE': 'DEPIDOMR', 'ID_RSSD': '21658', 'VALUE': '0.78737600000', 'DATE': '2008-12-31', 'VARIABLE_NAME': 'Interest-Bearing Deposits in Domestic Offices', 'UNIT': 'Percent'}]
--------------------------------------------------
Table full name: FINANCE__ECONOMICS.CYBERSYN.FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES
Column name: VALUE Type: NUMBER Description: Value reported for the variable.
Column name: DATE Type: DATE Description: Date associated with the value.
Column name: FDIC_INSTITUTION_ID Type: TEXT Description: Unique FDIC ID of the institution that owns the branch. It is a unique number, sequentially added to the FDIC database for both banks and branches. This ID is updated with every merger or purchase of branches to reflect the most current owner.
Column name: UNIT Type: TEXT Description: Unit in which the measure is recorded (e.g., USD YTD).
Column name: VARIABLE Type: TEXT Description: Unique FDIC identifier for tracked financial data.
Column name: FDIC_BRANCH_ID Type: TEXT Description: FDIC's unique number for the bank or savings institution assigned by the FDIC in order to identify and track. The branch ID for the Headquarters branch is the same as the branch ID for the entire bank or savings institution.
Column name: VARIABLE_NAME Type: TEXT Description: Human-readable description of the financial data variables tracked by the FDIC.
Sample rows:
[{'VALUE': 119632, 'DATE': '2023-06-30', 'FDIC_INSTITUTION_ID': '2239', 'UNIT': 'USD', 'VARIABLE': 'DEPSUMBR', 'FDIC_BRANCH_ID': '286466', 'VARIABLE_NAME': 'Branch Deposits'}, {'VALUE': 59230, 'DATE': '2017-06-30', 'FDIC_INSTITUTION_ID': '6499', 'UNIT': 'USD', 'VARIABLE': 'DEPSUMBR', 'FDIC_BRANCH_ID': '6499', 'VARIABLE_NAME': 'Branch Deposits'}, {'VALUE': 35943, 'DATE': '2014-06-30', 'FDIC_INSTITUTION_ID': '417', 'UNIT': 'USD', 'VARIABLE': 'DEPSUMBR', 'FDIC_BRANCH_ID': '481396', 'VARIABLE_NAME': 'Branch Deposits'}, {'VALUE': 85928, 'DATE': '2016-06-30', 'FDIC_INSTITUTION_ID': '3123', 'UNIT': 'USD', 'VARIABLE': 'DEPSUMBR', 'FDIC_BRANCH_ID': '203999', 'VARIABLE_NAME': 'Branch Deposits'}, {'VALUE': 133714, 'DATE': '2007-06-30', 'FDIC_INSTITUTION_ID': '745', 'UNIT': 'USD', 'VARIABLE': 'ASSET', 'FDIC_BRANCH_ID': '745', 'VARIABLE_NAME': 'Institutional Assets'}]
--------------------------------------------------
Table full name: FINANCE__ECONOMICS.CYBERSYN.FINANCIAL_INSTITUTION_ATTRIBUTES
Column name: UNIT Type: TEXT Description: Unit of measure for the value, examples (e.g., percentage, USD)
Column name: DEFINITION Type: TEXT Description: Detailed description of the variable including calculation where applicable
Column name: VARIABLE Type: TEXT Description: Unique identifier for a variable joinable to the timeseries table
Column name: VARIABLE_NAME Type: TEXT Description: Human-readable name for the variable
Column name: FREQUENCY Type: TEXT Description: Measurement period (e.g., Annual, Quarterly)
Sample rows:
[{'UNIT': 'Percent', 'DEFINITION': 'Retained earnings from bank operations, net unrealized holding gains (losses) on available-for-sale securities, and cumulative foreign currency translation adjustments.', 'VARIABLE': 'EQUP', 'VARIABLE_NAME': 'Undivided Profits', 'FREQUENCY': 'Quarterly'}, {'UNIT': 'Percent', 'DEFINITION': 'Loan and lease financing receivables, net of unearned income, allowances, and reserves, as a percent of total assets.', 'VARIABLE': 'LNLSNTV', 'VARIABLE_NAME': 'Net Loans and Leases to Assets', 'FREQUENCY': 'YTD'}, {'UNIT': 'Percent', 'DEFINITION': 'Net amount of loans secured by junior liens on 1-4 family residential properties (which are held in domestic offices) that have been charged-off and debited to the allowance for loan and lease losses established by the institution. Prior to 2004, this item is not available for TFR Reporters . Calculated as NTRERSF2 / ASSET5', 'VARIABLE': 'NTRERSF2R', 'VARIABLE_NAME': 'Secured By Junior Liens', 'FREQUENCY': 'YTD'}, {'UNIT': 'USD', 'DEFINITION': 'That portion of financial standby letters of credit, foreign office guarantees, performance standby letters of credit, and foreign office guarantees (including cash collateral standby letters of credit) conveyed to others.', 'VARIABLE': 'LOCFPSBK', 'VARIABLE_NAME': 'Standby Letters of Credit Amount Conveyed To Others', 'FREQUENCY': 'YTD'}, {'UNIT': 'USD', 'DEFINITION': 'Loan Loss Allowance Included in Tier 2 Capital', 'VARIABLE': 'RB2LNRES', 'VARIABLE_NAME': 'Loan Loss Allowance Included in Tier 2 Capital', 'FREQUENCY': 'YTD'}]
--------------------------------------------------
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'FINANCE__ECONOMICS': {'CYBERSYN': ['FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES', 'FINANCIAL_INSTITUTION_ENTITIES', 'FINANCIAL_INSTITUTION_TIMESERIES', 'FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES', 'FINANCIAL_INSTITUTION_ATTRIBUTES']}}

Some few-shot examples after column exploration may be helpful:
Query:
-- Step 1: Identify the variable representing '% Insured (Estimated)' in the FDIC timeseries data.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%insured%'
LIMIT 20;
Answer:
VARIABLE,VARIABLE_NAME
DEPUNA,Estimated uninsured deposits in domestic offices in insured branches in U.S. territories and possessions
DEPINS,Estimated Insured Deposits
DEPUNAR,Estimated uninsured deposits in domestic offices in insured branches in U.S. territories and possessions
DEPINSR,Estimated Insured Deposits
ESTINS,% Insured (Estimated)
BROINS,Fully Insured Brokered Deposits
ESTINSR,% Insured (Estimated) Ratio to Assets
BROINSR,Fully Insured Brokered Deposits
IDDEPINR,% Insured (
Query:
-- Step 2: Inspect the records for '% Insured (Estimated)' values and their corresponding dates to identify data format, especially for December 31, 2022.
SELECT *
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" = '% Insured (Estimated)'
  AND "DATE" = '2022-12-31'
LIMIT 20;
Answer:
ID_RSSD,VARIABLE,VARIABLE_NAME,VALUE,UNIT,DATE
522034,IDDEPINR,% Insured (Estimated),0.79601470000,Percent,2022-12-31
966272,ESTINS,% Insured (Estimated),0.91068520000,Percent,2022-12-31
966272,IDDEPINR,% Insured (Estimated),0.91068520000,Percent,2022-12-31
333034,ESTINS,% Insured (Estimated),0.81379190000,Percent,2022-12-31
333034,IDDEPINR,% Insured (Estimated),0.81379190000,Percent,2022-12-31
Query:
-- Step 3: Retrieve distinct financial institutions with their identifiers for potential filters (active and large banks).
SELECT DISTINCT "ID_RSSD", "NAME", "IS_ACTIVE", "ENTITY_TYPE"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES"
WHERE "IS_ACTIVE" = TRUE
LIMIT 20;
Answer:
ID_RSSD,NAME,IS_ACTIVE,ENTITY_TYPE
51356,Latimer State Bank,True,Non-member Bank
958231,Community Bank of Easton,True,Non-member Bank
194936,BankSouth,True,Non-member Bank
456344,Hart County Bank and Trust Company,True,Non-member Bank
753052,Montrose Savings Bank,True,Non-member Bank
441470,First Federal Savings & Loan Association of Ravenswood,True,Savings & Loan Association
651448,"JPMorgan Chase Bank, Dearborn",True,State Member Bank
5475452,Gulf Atlantic Bank,True,State Member Bank
Query:
-- Step 4: Focus on banks with total assets exceeding $10 billion using the variable corresponding to "Institutional Assets."
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%asset%'
LIMIT 20;
Answer:
VARIABLE,VARIABLE_NAME
RWAJ,Total Risk Weighted Assets
TRFOR,Trading Account Assets Foreign Offices
SCABSR,Asset Backed Securities
ASSTLT,Long-Term Assets (5+ Years)
BKPREM,Bank Premises and Fixed Assets
P3SCDEBT,"Debt Securities and Other Assets, Past Due 30 - 89 Days"
OALIFSEP,Separate Account Life insurance Assets
ASCERES,"Maximum Amount of Credit Exposure, Bank Asset Sales 1-4 Family Residential Loans"
NASCDEBT,Debt Securities and Other Assets in Nonaccrual Status
ROAPTXQ,Pretax Re
Query:
-- Step 5: Query total assets as of December 31, 2022, for active banks to filter those exceeding $10 billion.
SELECT t1."ID_RSSD", t2."NAME", t1."VALUE" AS "TOTAL_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
WHERE t1."VARIABLE" = 'ASSET'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t1."VALUE" > 10000000000
LIMIT 20;
Answer:
ID_RSSD,NAME,TOTAL_ASSETS
936855,"UMB Bank, National Association",38279055000.00000000000
3637685,First Foundation Bank,12980327000.00000000000
2797724,TowneBank,15845722000.00000000000
934329,"BNY Mellon, National Association",31424000000.00000000000
637451,PlainsCapital Bank,13520414000.00000000000
208244,Old National Bank,46490438000.00000000000
693224,Atlantic Union Bank,20342081000.00000000000
339858,"BOKF, National Association",47596192000.00000000000
Query:
-- Step 6: Integrate "% Insured (Estimated)" and "Institutional Assets" for December 31, 2022, to calculate the percentage of uninsured assets.
SELECT t1."ID_RSSD", t2."NAME", 
       t3."VALUE" AS "TOTAL_ASSETS", 
       (1 - t1."VALUE") AS "PERCENT_UNINSURED_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
  ON t1."ID_RSSD" = t3."ID_RSSD"
WHERE t1."VARIABLE_NAME" = '% Insured (Estimated)'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t3."VARIABLE" = 'ASSET'
  AND t3."DATE" = '2022-12-31'
  AND t3."VALUE" > 10000000000
LIMIT 20;
Answer:
ID_RSSD,NAME,TOTAL_ASSETS,PERCENT_UNINSURED_ASSETS
3579589,Stellar Bank,10891835000.00000000000,0.63455710000
3579589,Stellar Bank,10891835000.00000000000,0.63455710000
2797724,TowneBank,15845722000.00000000000,0.51065110000
1225761,Wells Fargo National Bank West,17664869000.00000000000,0.09242870000
1225761,Wells Fargo National Bank West,17664869000.00000000000,0.09242870000
143662,Umpqua Bank,31844724000.00000000000,0.36939480000
Query:
-- Step 7: Rank banks by their percentage of uninsured assets and select the top 10.
SELECT t1."ID_RSSD", t2."NAME", 
       t3."VALUE" AS "TOTAL_ASSETS", 
       (1 - t1."VALUE") AS "PERCENT_UNINSURED_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
  ON t1."ID_RSSD" = t3."ID_RSSD"
WHERE t1."VARIABLE_NAME" = '% Insured (Estimated)'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t3."VARIABLE" = 'ASSET'
  AND t3."DATE" = '2022-12-31'
  AND t3."VALUE" > 10000000000
ORDER BY "PERCENT_UNINSURED_ASSETS" DESC
LIMIT 10;
Answer:
ID_RSSD,NAME,TOTAL_ASSETS,PERCENT_UNINSURED_ASSETS
214807,Deutsche Bank Trust Company Americas,39192000000.00000000000,0.96322850000
214807,Deutsche Bank Trust Company Americas,39192000000.00000000000,0.96322850000
35301,State Street Bank and Trust Company,298020000000.00000000000,0.95600040000
541101,The Bank of New York Mellon,324646000000.00000000000,0.95167190000
35301,State Street Bank and Trust Company,298020000000.00000000000,0.91991530000
Query:
-- Step 8: Expand the query to also include entity-specific details such as the institution type and charter type.
SELECT t1."ID_RSSD", t2."NAME", 
       t3."VALUE" AS "TOTAL_ASSETS", 
       (1 - t1."VALUE") AS "PERCENT_UNINSURED_ASSETS",
       t2."ENTITY_TYPE",
       t2."CHARTER_TYPE"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
  ON t1."ID_RSSD" = t3."ID_RSSD"
WHERE t1."VARIABLE_NAME" = '% Insured (Estimated)'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t3."VARIABLE" = 'ASSET'
  AND t3."DATE" = '2022-12-31'
  AND t3."VALUE" > 10000000000
ORDER BY "PERCENT_UNINSURED_ASSETS" DESC
LIMIT 10;
Answer:
ID_RSSD,NAME,TOTAL_ASSETS,PERCENT_UNINSURED_ASSETS,ENTITY_TYPE,CHARTER_TYPE
214807,Deutsche Bank Trust Company Americas,39192000000.00000000000,0.96322850000,State Member Bank,Commercial Bank
214807,Deutsche Bank Trust Company Americas,39192000000.00000000000,0.96322850000,State Member Bank,Commercial Bank
35301,State Street Bank and Trust Company,298020000000.00000000000,0.95600040000,State Member Bank,Commercial Bank
541101,The Bank of New York Mellon,324646000000.00000000000,0.95167190000
Query:
-- Step 9: Investigate FDIC Summary of Deposits Timeseries for validation of uninsured deposit-related metrics.
SELECT DISTINCT "VARIABLE", "VARIABLE_NAME"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES"
WHERE "VARIABLE_NAME" ILIKE '%insured%'
LIMIT 20;
Answer:
VARIABLE,VARIABLE_NAME
INSBRDD,Demand Deposits in Insured Branches in Puerto Rico and US Territories & Possessions
INSBRTS,Time and Savings Deposits in Insured Branches in Puerto Rico and US Territories & Possessions
Task: As of December 31, 2022, list the top 10 active banks with assets exceeding $10 billion, ranked by the highest percentage of uninsured assets, where the percentage is calculated as one minus the value of the '% Insured (Estimated)' variable from quarterly estimates. Provide the names of these banks and their respective percentages of uninsured assets.
Another way to say it: As of December 31, 2022, list the top 10 active large banks, each with assets over $10 billion, that have the highest percentage of uninsured assets based on quarterly estimates. Provide the names of these banks and their respective percentages of uninsured assets.

Please think step by step and answer only one complete SQL in snowflake dialect in ```sql``` format.
SQL usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'FINANCE__ECONOMICS': {'CYBERSYN': ['FDIC_SUMMARY_OF_DEPOSITS_ATTRIBUTES', 'FINANCIAL_INSTITUTION_ENTITIES', 'FINANCIAL_INSTITUTION_TIMESERIES', 'FDIC_SUMMARY_OF_DEPOSITS_TIMESERIES', 'FINANCIAL_INSTITUTION_ATTRIBUTES']}}

When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When asked something without stating name or id, return both of them. e.g. Which products ...? The answer should include product_name and product_id.
When asked percentage decrease, you should return a positive value. e.g. How many percentage points in 2021 decrease compared to ...? The answer should be a positive value indicating the decresed number. Try to use ABS().
If asked two tables, you should reply with the last one instead of combining two tables. e.g. Identifying the top five states ... examine the state that ranks fourth overall and identify its top five counties. You should only answer top five counties.
Use ST_DISTANCE to calculate distance between two geographic points for more accurate answer.
If the task description does not specify the number of decimal places, retain all decimals to four places.

[Self-refine]
2025-07-01 05:01:38 - Thread-913 (execute) - INFO - [Try to run SQL in self-refine]
```sql
SELECT t1."ID_RSSD", 
       t2."NAME", 
       t3."VALUE" AS "TOTAL_ASSETS", 
       ROUND((1 - t1."VALUE"), 4) AS "PERCENT_UNINSURED_ASSETS"
FROM "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t1
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_ENTITIES" t2
  ON t1."ID_RSSD" = t2."ID_RSSD"
JOIN "FINANCE__ECONOMICS"."CYBERSYN"."FINANCIAL_INSTITUTION_TIMESERIES" t3
  ON t1."ID_RSSD" = t3."ID_RSSD"
WHERE t1."VARIABLE_NAME" = '% Insured (Estimated)'
  AND t1."DATE" = '2022-12-31'
  AND t2."IS_ACTIVE" = TRUE
  AND t3."VARIABLE" = 'ASSET'
  AND t3."DATE" = '2022-12-31'
  AND t3."VALUE" > 10000000000
ORDER BY "PERCENT_UNINSURED_ASSETS" DESC NULLS LAST
LIMIT 10;
```
[Try to run SQL in self-refine]
2025-07-01 05:01:41 - Thread-913 (execute) - INFO - Total iteration counts: 0
